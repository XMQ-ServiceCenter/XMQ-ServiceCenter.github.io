<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+Simplified+Chinese:300,300italic,400,400italic,700,700italic%7CMicrosoft+YaHei:300,300italic,400,400italic,700,700italic%7CNoto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"xmq-servicecenter.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="奇怪的小网站">
<meta property="og:type" content="website">
<meta property="og:title" content="XMQ-维修中心">
<meta property="og:url" content="https://xmq-servicecenter.github.io/public/index.html/index.html">
<meta property="og:site_name" content="XMQ-维修中心">
<meta property="og:description" content="奇怪的小网站">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="XMQ">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://xmq-servicecenter.github.io/public/index.html/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"public/index.html/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>XMQ-维修中心</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">XMQ-维修中心</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-考前预习"><a href="/%E8%80%83%E5%89%8D%E9%A2%84%E4%B9%A0/" rel="section"><i class="fa fa-th fa-fw"></i>考前预习</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">XMQ</p>
  <div class="site-description" itemprop="description">奇怪的小网站</div>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/FluidMechanics-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/FluidMechanics-1/" class="post-title-link" itemprop="url">流体力学</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-09 22:04:55" itemprop="dateModified" datetime="2024-08-09T22:04:55+08:00">2024-08-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr />
<h1 id="基本概念">基本概念</h1>
<h2 id="两种观点">两种观点</h2>
<p>有两种观点可用于描述流体的运动：“随波逐流”的拉格朗日观点与“冷眼旁观”的欧拉观点。</p>
<p><strong>拉格朗日观点</strong>跟踪流体中的每一个粒子，它给每一个粒子贴上标签，然后研究标签为
<span class="math inline">\(\alpha\)</span> 的粒子在 <span
class="math inline">\(t\)</span> 时刻的位置 <span
class="math inline">\(\boldsymbol r_\alpha(t)\)</span> 与速度 <span
class="math inline">\(\boldsymbol v_\alpha(t):=\mathrm{d}\boldsymbol
r_\alpha(t)/\mathrm{d}t\)</span> 等物理量。</p>
<p><strong>欧拉观点</strong>则跟踪时空中的每一个点，研究在 <span
class="math inline">\(t\)</span> 时刻经过空间坐标为 <span
class="math inline">\((x,y,z)\)</span>
的点的粒子的速度。也就是说，欧拉观点着眼于对<strong>速度场</strong>的分析。在很多教科书中，速度场常记为
<span class="math inline">\(\boldsymbol
v(x,y,z,t)\)</span>，如果需要将它的分量写出，那么 <span
class="math inline">\(\boldsymbol v(x,y,z,t)\)</span> 在 <span
class="math inline">\(x,y,z\)</span> 三个方向上的分量分别记为 <span
class="math inline">\(u(x,y,z,t)\)</span>, <span
class="math inline">\(v(x,y,z,t)\)</span>, <span
class="math inline">\(w(x,y,z,t)\)</span>。由于追踪每一个粒子的做法过于困难，所以我们一般都采用欧拉观点。</p>
<p>如果我们采用拉格朗日观点，将一个标签为 <span
class="math inline">\(\alpha\)</span> 的粒子在空间中的运动轨迹 <span
class="math inline">\(\boldsymbol r_\alpha(t)\)</span>
画成一条曲线，这条曲线就称为粒子 <span
class="math inline">\(\alpha\)</span>
的<strong>迹线</strong>。如果我们采用欧拉观点，在 <span
class="math inline">\(t\)</span>
时刻画出一条曲线使其切线处处平行于切点处的速度场，就说这是 <span
class="math inline">\(t\)</span>
时刻的一条<strong>流线</strong>。注意流线是可以随时间变化的，因为速度场是可随时间变化的；而讨论迹线是否会随时间变化是没有意义的，因为迹线本身就是随时间运动的结果。</p>
<h2 id="两种导数单个质点">两种导数（单个质点）</h2>
<p>现在，我们假定每一个质点都携带了某个物理量 <span
class="math inline">\(\phi\)</span>。</p>
<p>在欧拉观点下，<span class="math inline">\(\phi(x,y,z,t)\)</span>
就等同于在 <span class="math inline">\(t\)</span> 时刻位于 <span
class="math inline">\((x,y,z)\)</span> 那一点的质点 <span
class="math inline">\(\alpha\)</span> 所携带的物理量 <span
class="math inline">\(\phi_\alpha(t)\)</span>。到了 <span
class="math inline">\(t+\mathrm{d}t\)</span> 时刻，质点 <span
class="math inline">\(\alpha\)</span> 离开 <span
class="math inline">\((x,y,z)\)</span>，一个新的质点 <span
class="math inline">\(\beta\)</span> 重新占据了 <span
class="math inline">\((x,y,z)\)</span>，此时的 <span
class="math inline">\(\phi(x,y,z,t+\mathrm dt)\)</span> 就是后来的 <span
class="math inline">\(\beta\)</span> 所携带的物理量 <span
class="math inline">\(\phi_\beta(t+\mathrm dt)\)</span>。</p>
<p>不难想象，此时的质点 <span class="math inline">\(\alpha\)</span> 位于
<span class="math inline">\((x+u\mathrm dt,y+v\mathrm dt,z+w\mathrm
dt)\)</span> 处，其中 <span class="math inline">\(u,v,w\)</span>
为速度场在 <span class="math inline">\((x,y,z)\)</span>
处的速度分量。因此 <span class="math display">\[\phi_\alpha(t+\mathrm
dt)=\phi(x+u\mathrm dt,y+v\mathrm dt,z+w\mathrm dt,t+\mathrm
dt).\]</span> 通过简单的计算可以发现：</p>
<p><span class="math display">\[\begin{equation}\begin{aligned}
\dfrac{\mathrm d}{\mathrm
dt}\phi_\alpha(t)=&amp;\;\left(u\dfrac{\partial}{\partial
x}+v\dfrac{\partial}{\partial y}+w\dfrac{\partial}{\partial
z}+\dfrac{\partial}{\partial t}\right)\phi(x,y,z,t)\\
=&amp;\;\left(\boldsymbol v\cdot\nabla+\dfrac{\partial}{\partial
t}\right)\phi(x,y,z,t).
\end{aligned}\end{equation}\label{dt-vs-partial_t-1}\]</span></p>
<p>左侧的 <span class="math inline">\(\mathrm d/\mathrm dt\)</span>
常称为<strong>物质导数</strong>或随体导数，它刻画了特定质点本身所携带的物理量随时间的变化，因而可视为是拉格朗日观点中的时间导数。物质导数有时也记为
<span class="math inline">\(\mathrm D/\mathrm Dt\)</span>。</p>
<p>右侧的 <span class="math inline">\(\partial/\partial t\)</span>
称为<strong>局部导数</strong>，它刻画了空间中固定的某一个点感受到的物理量随时间的变化，因而可视为是欧拉观点中的时间导数。</p>
<p><span class="math inline">\(\boldsymbol v\cdot\nabla\)</span>
称为对流导数或平流导数，它反映了构成流体的质点的运动带来的物理量的变化。</p>
<h2 id="两种导数一团质点">两种导数（一团质点）</h2>
<p>以上我们考虑了单个质点所携带的物理量随时间的变化，现在我们讨论一团在空间中占据了有限大小体积的质点所携带的物理量随时间的变化。相对于单个质点的情形，一团质点因为有了体积这个东西而显得更为复杂。</p>
<p>假设 <span class="math inline">\(t\)</span>
时刻，这团质点在空间中占据的体积为 <span
class="math inline">\(\Omega_t\)</span>，那么 <span
class="math inline">\(t\)</span> 时刻，它们携带的物理量就是 <span
class="math display">\[\Phi(t):=\int_{\Omega_t}\phi(\boldsymbol\xi_t,t)\mathrm
d^3\boldsymbol\xi_t.\]</span> <span
class="math inline">\(\phi(\boldsymbol\xi_t,t)\mathrm
d^3\boldsymbol\xi_t\)</span> 为在 <span class="math inline">\(t\)</span>
时刻空间坐标为 <span class="math inline">\(\boldsymbol\xi_t\)</span>
的质点的所贡献的物理量。在 <span class="math inline">\(t+\mathrm
dt\)</span> 时刻，原本位于 <span
class="math inline">\(\boldsymbol\xi_t\)</span> 的质点运动到了 <span
class="math inline">\(\boldsymbol\xi_{t+\mathrm
dt}=\boldsymbol\xi_t+\boldsymbol v(\boldsymbol\xi_t,t)\mathrm
dt\)</span> 处，然后： <span class="math display">\[\Phi(t+\mathrm
dt)=\int_{\Omega_{t+\mathrm dt}}\phi(\boldsymbol\xi_{t+\mathrm
dt},t+\mathrm dt)\mathrm d^3\boldsymbol\xi_{t+\mathrm dt}.\]</span>
此时的质点在空间中占据的体积为 <span
class="math inline">\(\Omega_{t+\mathrm dt}\)</span>，而非原来的 <span
class="math inline">\(\Omega_t\)</span>。</p>
<p><span class="math inline">\(\Phi(t)\)</span> 与 <span
class="math inline">\(\Phi(t+\mathrm dt)\)</span> 的积分区间不同使得
<span class="math inline">\(\Phi(t+\mathrm dt)-\Phi(t)\)</span>
难以直接计算。但我们可以做积分变换，将 <span
class="math inline">\(\boldsymbol\xi_{t+\mathrm dt}\)</span> 用原来的
<span class="math inline">\(\boldsymbol\xi_t\)</span>
写出，让两者的积分区间同为 <span
class="math inline">\(\Omega_t\)</span>。这一过程涉及到雅可比行列式
<span class="math inline">\(|\partial\boldsymbol\xi_{t+\mathrm
dt}/\partial\boldsymbol\xi_{t}|\)</span> 的计算。</p>
<p>利用公式 <span
class="math inline">\(\det(1+A\varepsilon)=1+\mathrm{tr}(A)\varepsilon+O(\varepsilon^2)\)</span>
不难算出体积元或者说测度满足 <span class="math display">\[\mathrm
d^3\boldsymbol\xi_{t+\mathrm dt}=\left[1+\nabla\cdot\boldsymbol
v(\boldsymbol\xi_t,t)\mathrm dt\right]\mathrm
d^3\boldsymbol\xi_t.\]</span>
这意味着，体积的变化也能影响物理量随时间的导数，同时流体中的体积元随时间的相对变化率由
<span class="math inline">\(\nabla\cdot\boldsymbol v\)</span> 给出。</p>
<p>然后我们就可以算出： <span class="math display">\[\Phi(t+\mathrm
dt)=\int_{\Omega_t}\phi(\boldsymbol\xi_{t+\mathrm dt},t+\mathrm
dt)\left[1+\nabla\cdot\boldsymbol v(\boldsymbol\xi_t,t)\mathrm
dt\right]\mathrm d^3\boldsymbol\xi_t.\]</span>
再通过简单的数学计算就可以得到： <span
class="math display">\[\begin{align}\begin{split}
\dfrac{\mathrm d}{\mathrm
dt}\int_{\Omega_t}\phi(\boldsymbol\xi_t,t)\mathrm
d^3\boldsymbol\xi_t&amp;=\int_{\Omega_t}\left[\dfrac{\mathrm
d\phi(\boldsymbol\xi_t,t)}{\mathrm
dt}+\phi(\boldsymbol\xi_t,t)\nabla\cdot\boldsymbol
v(\boldsymbol\xi_t,t)\right]\mathrm d^3\boldsymbol\xi_t,\\
&amp;=\int_{\Omega_t}\left[\dfrac{\partial\phi(\boldsymbol\xi_t,t)}{\partial
t}+\nabla\cdot[\phi(\boldsymbol\xi_t,t)\boldsymbol
v(\boldsymbol\xi_t,t)]\right]\mathrm d^3\boldsymbol\xi_t\\
&amp;\neq\int_{\Omega_t}\left[\dfrac{\mathrm
d\phi(\boldsymbol\xi_t,t)}{\mathrm dt}\right]\mathrm
d^3\boldsymbol\xi_t.
\end{split}\label{dt-vs-partial_t-2}\end{align}\]</span></p>
<h2 id="运动的分解">运动的分解</h2>
<p>在流体所处的空间中任取一点 <span
class="math inline">\(\boldsymbol{r}_0\)</span>，那么 <span
class="math inline">\(\boldsymbol{r}_0\)</span> 附近的速度场可以写为：
<span class="math display">\[\begin{align*}
\begin{bmatrix}u(\boldsymbol r_0+\mathrm d\boldsymbol r)\\v(\boldsymbol
r_0+\mathrm d\boldsymbol r)\\w(\boldsymbol r_0+\mathrm d\boldsymbol
r)\end{bmatrix}&amp;=\begin{bmatrix}u(\boldsymbol r_0)\\v(\boldsymbol
r_0)\\w(\boldsymbol r_0)\end{bmatrix}
+\begin{bmatrix}
\dfrac{\partial u}{\partial x}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial u}{\partial y}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial u}{\partial z}\Big|_{\boldsymbol r_0}\\[1em]
\dfrac{\partial v}{\partial x}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial v}{\partial y}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial v}{\partial z}\Big|_{\boldsymbol r_0}\\[1em]
\dfrac{\partial w}{\partial x}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial w}{\partial y}\Big|_{\boldsymbol
r_0}&amp;\dfrac{\partial w}{\partial z}\Big|_{\boldsymbol r_0}\\
\end{bmatrix}
\begin{bmatrix}\mathrm d x\\ \mathrm d y\\ \mathrm d z\end{bmatrix}
\end{align*}\]</span> 我们注意到等号右边的 <span
class="math inline">\(3\times3\)</span> 矩阵可被写为： <span
class="math display">\[\begin{align*}
\begin{bmatrix}
\dfrac{\partial u}{\partial x}&amp;\dfrac{\partial u}{\partial
y}&amp;\dfrac{\partial u}{\partial z}\\[1em]
\dfrac{\partial v}{\partial x}&amp;\dfrac{\partial v}{\partial
y}&amp;\dfrac{\partial v}{\partial z}\\[1em]
\dfrac{\partial w}{\partial x}&amp;\dfrac{\partial w}{\partial
y}&amp;\dfrac{\partial w}{\partial z}
\end{bmatrix}=&amp;\begin{bmatrix}
0&amp;\dfrac12\left(\dfrac{\partial u}{\partial y}-\dfrac{\partial
v}{\partial x}\right)&amp;\dfrac12\left(\dfrac{\partial u}{\partial
z}-\dfrac{\partial w}{\partial x}\right)\\[1em]
-\dfrac12\left(\dfrac{\partial u}{\partial y}-\dfrac{\partial
v}{\partial x}\right)&amp;0&amp;\dfrac12\left(\dfrac{\partial
v}{\partial z}-\dfrac{\partial w}{\partial y}\right)\\[1em]
-\dfrac12\left(\dfrac{\partial u}{\partial z}-\dfrac{\partial
w}{\partial x}\right)&amp;-\dfrac12\left(\dfrac{\partial v}{\partial
z}-\dfrac{\partial w}{\partial y}\right)&amp;0
\end{bmatrix}\\
&amp;+\begin{bmatrix}
\dfrac{\partial u}{\partial x}&amp;\dfrac12\left(\dfrac{\partial
u}{\partial y}+\dfrac{\partial v}{\partial
x}\right)&amp;\dfrac12\left(\dfrac{\partial u}{\partial
z}+\dfrac{\partial w}{\partial x}\right)\\[1em]
\dfrac12\left(\dfrac{\partial u}{\partial y}+\dfrac{\partial v}{\partial
x}\right)&amp;\dfrac{\partial v}{\partial
y}&amp;\dfrac12\left(\dfrac{\partial v}{\partial z}+\dfrac{\partial
w}{\partial y}\right)\\[1em]
\dfrac12\left(\dfrac{\partial u}{\partial z}+\dfrac{\partial w}{\partial
x}\right)&amp;\dfrac12\left(\dfrac{\partial v}{\partial
z}+\dfrac{\partial w}{\partial y}\right)&amp;\dfrac{\partial w}{\partial
z}
\end{bmatrix}
\end{align*}\]</span> 我们将等号右侧的第二个矩阵记为 <span
class="math inline">\(\overleftrightarrow{\boldsymbol\varepsilon}\)</span>，而第一个矩阵的矩阵元暂时记为
<span
class="math inline">\(\overleftrightarrow{\boldsymbol\Omega}\)</span>。</p>
<p>对于 <span
class="math inline">\(\overleftrightarrow{\boldsymbol\Omega}\)</span>，不难发现其矩阵元为
<span
class="math inline">\(\Omega_{ij}=-(\partial_iv_j-\partial_jv_i)/2\)</span>。利用公式
<span
class="math display">\[\sum_k\epsilon_{ijk}\epsilon_{lmk}=\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}\]</span>
可以算出： <span class="math display">\[\begin{align*}
\sum_j\Omega_{ij}\mathrm
dr_j=&amp;-\dfrac12\sum_j(\partial_iv_j-\partial_jv_i)\mathrm
dr_j=-\dfrac12\sum_{jml}(\partial_lv_m)(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl})\mathrm
dr_j\\
=&amp;-\dfrac12\sum_{jkml}(\partial_lv_m)\epsilon_{lmk}\epsilon_{ijk}\mathrm
dr_j=\dfrac12\sum_{jkml}\epsilon_{ikj}(\epsilon_{klm}\partial_lv_m)\mathrm
dr_j\\
=&amp;\;\left[\dfrac12(\nabla\times\boldsymbol v)\times\mathrm
d\boldsymbol r\right]_i.
\end{align*}\]</span> 这实际上是一个绕 <span
class="math inline">\(\boldsymbol r_0\)</span> 的转动。因此，<span
class="math inline">\(\boldsymbol v(\boldsymbol r_0+\mathrm d\boldsymbol
r)\)</span> 还可写为： <span class="math display">\[\boldsymbol
v(\boldsymbol r_0+\mathrm d\boldsymbol r)=\boldsymbol v(\boldsymbol
r_0)+\dfrac12(\nabla\times\boldsymbol v)\times\mathrm d\boldsymbol
r+\overleftrightarrow{\boldsymbol\varepsilon}\cdot\mathrm d\boldsymbol
r.\]</span> 转动的效果如下图 (a) 所示，这是 <span
class="math inline">\(\partial u/\partial y=-\partial v/\partial
x&lt;0\)</span> 而其他偏导全为 <span class="math inline">\(0\)</span>
时的结果。</p>
<center>
<img src="/picture/FluidMechanics-v_decomposition.png" width="75%">
</center>
<p>对于 <span
class="math inline">\(\overleftrightarrow{\boldsymbol\varepsilon}\)</span>，我们发现这是一个对称张量，它代表了流体的变形。
<span
class="math inline">\(\overleftrightarrow{\boldsymbol\varepsilon}\)</span>
的对角项反映了流体的线变形，也即是拉伸或收缩。上图 (b) 反映的就是 <span
class="math inline">\(\partial u/\partial x&gt;0\)</span> 而其他偏导全为
<span class="math inline">\(0\)</span> 的结果。 <span
class="math inline">\(\overleftrightarrow{\boldsymbol\varepsilon}\)</span>
的非对角项反映了流体的切向变形或角变形。上图 (c) 反映的就是 <span
class="math inline">\(\partial u/\partial y=\partial v/\partial
x&gt;0\)</span> 而其他偏导全为 <span class="math inline">\(0\)</span>
的结果。</p>
<p>从上面的图中也可以看出，<span
class="math inline">\(\nabla\cdot\boldsymbol{v}\)</span>
反映了流体体积的变化，而 <span
class="math inline">\(\nabla\times\boldsymbol{v}\)</span>
反映了流体是否有旋转。</p>
<hr />
<h1 id="基本方程">基本方程</h1>
<h2 id="质量守恒方程">质量守恒方程</h2>
<p>一般的流体力学中，质量总是守恒的。假设流体的密度分布为 <span
class="math inline">\(\rho(x,y,z,t)\)</span>，那么一团质点的总质量是：
<span class="math display">\[m(t)=\int\rho(x,y,z,t)\mathrm dx\mathrm
dy\mathrm dz.\]</span> 从 (<span
class="math inline">\(\ref{dt-vs-partial_t-2}\)</span>)
式可以看出，<span class="math inline">\(\mathrm dm(t)/\mathrm
dt=0\)</span> 意味着： <span
class="math display">\[\begin{align}\dfrac{\mathrm d\rho}{\mathrm
dt}+\rho\nabla\cdot\boldsymbol{v}=\dfrac{\partial\rho}{\partial
t}+\nabla\cdot(\rho \boldsymbol
v)=0.\label{mass-equation}\end{align}\]</span>
这就是流体力学的质量守恒方程。</p>
<p>质量守恒方程的一个重要的应用场景就是将 <span
class="math inline">\(\mathrm d/\mathrm dt\)</span> 移到积分号内。利用
(<span class="math inline">\(\ref{dt-vs-partial_t-2}\)</span>)
式我们知道： <span class="math display">\[\begin{align*}\begin{split}
\dfrac{\mathrm d}{\mathrm dt}\int\rho\phi\mathrm dx\mathrm dy\mathrm
dz&amp;=\int\left[\dfrac{\mathrm d(\rho\phi)}{\mathrm
dt}+\rho\phi\nabla\cdot\boldsymbol v\right]\mathrm dx\mathrm dy\mathrm
dz.
\end{split}\end{align*}\]</span> 而质量守恒方程 (<span
class="math inline">\(\ref{mass-equation}\)</span>) 又告诉我们 <span
class="math inline">\(\phi\mathrm d\rho/\mathrm
dt+\rho\phi\nabla\cdot\boldsymbol{v}=0\)</span>，因此： <span
class="math display">\[\begin{align}\begin{split}
\dfrac{\mathrm d}{\mathrm dt}\int\rho\phi\mathrm dx\mathrm dy\mathrm
dz&amp;=\int\rho\dfrac{\mathrm d\phi}{\mathrm dt}\mathrm dx\mathrm
dy\mathrm dz.
\end{split}\label{d_dt-and-mass-equation}\end{align}\]</span></p>
<h2 id="动量守恒方程">动量守恒方程</h2>
<h3 id="牛顿第二定律">牛顿第二定律</h3>
<p>流体中的一团质点可能受到两种力：质量力与表面力。质量力的代表是重力、各类惯性力等等，他们作用于每一个流体微团上，其大小总是正比于流体的质量或体积；表面力的代表是流体的压力以及黏滞阻力等等，它们总是作用于流体微团之间的界面上。</p>
<p>假设一团流体占据的空间体积为 <span
class="math inline">\(\Omega\)</span>，其边界为 <span
class="math inline">\(\partial\Omega\)</span>，<span
class="math inline">\(\boldsymbol f_b\)</span>
为单位质量的流体受到的质量力（或者这个力单独存在时引起的加速度），<span
class="math inline">\(\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
为 <span class="math inline">\(\partial\Omega\)</span> 上的面积元 <span
class="math inline">\(\mathrm d^2\boldsymbol{S}\)</span>
受到的表面力，那么这团流体的动量守恒方程，即牛顿第二定律方程为： <span
class="math display">\[\begin{align*}\dfrac{\mathrm d}{\mathrm
dt}\int_\Omega\rho\boldsymbol{v}\mathrm dx\mathrm dy\mathrm
dz=&amp;\;\int_\Omega\rho\boldsymbol f_b\mathrm dx\mathrm dy\mathrm
dz+\int_{\partial\Omega}\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\\
=&amp;\;\int_\Omega\rho\boldsymbol f_b\mathrm dx\mathrm dy\mathrm
dz+\int_{\Omega}(\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}})\mathrm
dx\mathrm dy\mathrm dz,\end{align*}\]</span> 也即： <span
class="math display">\[\begin{align}\dfrac{\mathrm d}{\mathrm d
t}(\rho\boldsymbol v)+\rho (\nabla\cdot\boldsymbol v)\boldsymbol
v=\rho\boldsymbol
f_b+\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}}.\label{momentum-equation-1}\end{align}\]</span>
(<span class="math inline">\(\ref{d_dt-and-mass-equation}\)</span>)
式告诉我们，(<span
class="math inline">\(\ref{momentum-equation-1}\)</span>) 式还可写为：
<span class="math display">\[\begin{align}\rho\dfrac{\mathrm
d\boldsymbol v}{\mathrm d t}=\rho\boldsymbol
f_b+\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}}.\label{momentum-equation-2}\end{align}\]</span></p>
<h3 id="张量-overleftrightarrowboldsymbolvargamma-的含义">张量 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
的含义</h3>
<p>我们可以定义矢量 <span
class="math display">\[\boldsymbol{\varGamma}_i:=\boldsymbol{e}_i\cdot\overleftrightarrow{\boldsymbol{\varGamma}},\]</span>
其分量为 <span
class="math inline">\((\boldsymbol{\varGamma}_i)_j=\sum_k\delta_{ik}(\overleftrightarrow{\boldsymbol{\varGamma}})_{kj}=(\overleftrightarrow{\boldsymbol{\varGamma}})_{ij}\)</span>
，因此我们可以将 <span
class="math inline">\((\boldsymbol{\varGamma}_i)_j\)</span> 和 <span
class="math inline">\((\overleftrightarrow{\boldsymbol{\varGamma}})_{ij}\)</span>
一起记为 <span class="math inline">\(\varGamma_{ij}\)</span> 。</p>
<p>取 <span class="math inline">\(\mathrm
d^2\boldsymbol{S}\parallel\boldsymbol{e}_i\)</span> 即可看出：<span
class="math inline">\(\boldsymbol{\varGamma}_i\)</span>
实际上刻画了一个垂直于 <span
class="math inline">\(\boldsymbol{e}_i\)</span>
的表面上单位面积的受力。因此 <span
class="math inline">\(\varGamma_{ij}\)</span> 实际上就是垂直于 <span
class="math inline">\(\boldsymbol{e}_i\)</span> 的表面感受到的 <span
class="math inline">\(j\)</span> 方向的力。</p>
<p>利用 <span
class="math inline">\(\boldsymbol{\varGamma}_i\)</span>，(<span
class="math inline">\(\ref{momentum-equation-2}\)</span>) 式还可写为：
<span class="math display">\[\begin{align}\rho\dfrac{\mathrm
d\boldsymbol v}{\mathrm d t}=\rho\boldsymbol
f_b+\dfrac{\partial\boldsymbol{\varGamma}_x}{\partial
x}+\dfrac{\partial\boldsymbol{\varGamma}_y}{\partial
y}+\dfrac{\partial\boldsymbol{\varGamma}_z}{\partial
z}.\label{momentum-equation-3}\end{align}\]</span></p>
<h3 id="广义牛顿黏性假设">广义牛顿黏性假设</h3>
<p>质量力 <span class="math inline">\(\boldsymbol f_b\)</span>
相对而言比较简单，例如对于重力来说，<span
class="math inline">\(\boldsymbol f_b=\boldsymbol
g\)</span>，即重力加速度。</p>
<p>表面力中的压力也比较简单：面积元 <span class="math inline">\(\mathrm
d^2\boldsymbol{S}\)</span> 受到的压力的方向总是与 <span
class="math inline">\(\mathrm d^2\boldsymbol{S}\)</span>
相反，单位面积上的大小为 <span
class="math inline">\(p\)</span>，因此压强对 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
的贡献为 <span
class="math inline">\(-p\overleftrightarrow{\boldsymbol{I}}\)</span>，<span
class="math inline">\(\overleftrightarrow{\boldsymbol{I}}\)</span> 为
<span class="math inline">\(3\)</span> 阶单位张量。</p>
<p>最复杂的是黏滞阻力。广义牛顿黏性假设认为，压强项与黏性对 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
的贡献总和为： <span
class="math display">\[\begin{align}\overleftrightarrow{\boldsymbol{\varGamma}}=\mu\left[2\overleftrightarrow{\boldsymbol{\varepsilon}}-\dfrac23(\nabla\cdot\boldsymbol{v})\overleftrightarrow{\boldsymbol{I}}\right]-p\overleftrightarrow{\boldsymbol{I}}\label{generalized-Newton}\end{align}\]</span>
当只有 <span class="math inline">\(\partial u/\partial y\neq0\)</span>
时，<span class="math inline">\(\varGamma_{yx}\)</span>，即垂直于 <span
class="math inline">\(y\)</span> 轴的表面在单位面积上受到的 <span
class="math inline">\(x\)</span> 方向的黏滞阻力为： <span
class="math display">\[\varGamma_{yx}:=\mu\left(\dfrac{\partial
v}{\partial x}+\dfrac{\partial u}{\partial y}\right)=\mu\dfrac{\partial
u}{\partial y}.\]</span>
这就是牛顿黏性定律，它反映了流速快（慢）的流体对流速慢（快）的流体的牵拉（阻滞）作用。</p>
<h3 id="navier-stokes-方程">Navier-Stokes 方程</h3>
<p>将广义牛顿黏性假设 (<span
class="math inline">\(\ref{generalized-Newton}\)</span>)
式代入牛顿第二定律 (<span
class="math inline">\(\ref{momentum-equation-2}\)</span>) 式，并假定
<span class="math inline">\(\mu\)</span>
是与时间和位置无关的常数，就得到了： <span
class="math display">\[\begin{align*}\rho\dfrac{\mathrm d\boldsymbol
v}{\mathrm d t}=\rho\boldsymbol
f_b+\mu\left[2\nabla\cdot\overleftrightarrow{\boldsymbol{\varepsilon}}-\dfrac23\nabla(\nabla\cdot\boldsymbol{v})\right]-\nabla
p.\end{align*}\]</span> 这一方程还可做进一步的化简：利用 <span
class="math display">\[\begin{align*}
(2\nabla\cdot\overleftrightarrow{\boldsymbol{\varepsilon}})_i=&amp;\;\sum_k\partial_k(\partial_kv_i+\partial_iv_k)=[\nabla^2\boldsymbol{v}+\nabla(\nabla\cdot\boldsymbol{v})]_i,
\end{align*}\]</span> 可以将以上方程写为： <span
class="math display">\[\begin{align}\rho\dfrac{\mathrm d\boldsymbol
v}{\mathrm d t}=\rho\boldsymbol
f_b+\mu\left[\nabla^2\boldsymbol{v}+\dfrac13\nabla(\nabla\cdot\boldsymbol{v})\right]-\nabla
p.\label{Navier-Stokes}\end{align}\]</span> 这就是 Navier-Stokes
方程。</p>
<h2 id="角动量守恒">角动量守恒</h2>
<p>最后我们来讨论角动量。角动量守恒的条件实际上保证了 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
一定是对称张量。</p>
<p>我们将牛顿第二定律的方程略作修改即可得到角动量守恒方程： <span
class="math display">\[\begin{align*}\dfrac{\mathrm d}{\mathrm
dt}\int_\Omega\boldsymbol{r}\times\rho\boldsymbol{v}\mathrm dx\mathrm
dy\mathrm dz=&amp;\;\int_\Omega\boldsymbol{r}\times\rho\boldsymbol
f_b\mathrm dx\mathrm dy\mathrm
dz+\int_{\partial\Omega}\boldsymbol{r}\times(\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}).\end{align*}\]</span></p>
<p>注意到表面力的一项可化简为： <span
class="math display">\[\begin{align*}\begin{split}\int_{\partial\Omega}[\boldsymbol{r}\times(\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}})]_i=&amp;\;\sum_{jkm}\int_{\partial\Omega}\epsilon_{ijk}r_jn_m\varGamma_{mk}\mathrm
d^2S=-\sum_{jkm}\int_{\partial\Omega}n_md^2S\epsilon_{ikj}\varGamma_{mk}r_j\\
=&amp;-\sum_{jkm}\int_{\Omega}\mathrm dx\mathrm dy\mathrm
dz[\partial_m(\epsilon_{ikj}\varGamma_{mk}r_j)]\\
=&amp;-\sum_{jkm}\int_{\Omega}\mathrm dx\mathrm dy\mathrm
dz[(\partial_m\varGamma_{mk})\epsilon_{ikj}r_j+\epsilon_{ikj}\varGamma_{mk}\delta_{mj}]\\
=&amp;-\int_{\Omega}\mathrm dx\mathrm dy\mathrm
dz[(\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}})\times\boldsymbol{r}]_i-\sum_{jk}\int_{\Omega}\mathrm
dx\mathrm dy\mathrm dz\,\epsilon_{ikj}\varGamma_{jk}\\
=&amp;\;\int_{\Omega}\mathrm dx\mathrm dy\mathrm
dz[\boldsymbol{r}\times(\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}})]_i+\sum_{jk}\int_{\Omega}\mathrm
dx\mathrm dy\mathrm dz\,\epsilon_{ijk}\varGamma_{jk}.
\end{split}\end{align*}\]</span> 再结合 (<span
class="math inline">\(\ref{d_dt-and-mass-equation}\)</span>) 式将 <span
class="math inline">\(\mathrm d/\mathrm dt\)</span> 放入积分号内，就有：
<span
class="math display">\[\begin{align*}\int_\Omega\boldsymbol{r}\times\rho\dfrac{\mathrm
d\boldsymbol{v}}{\mathrm dt}\mathrm dx\mathrm dy\mathrm
dz=&amp;\;\int_\Omega\boldsymbol{r}\times\rho\boldsymbol f_b\mathrm
dx\mathrm dy\mathrm
dz+\int_{\Omega}\boldsymbol{r}\times(\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}})\mathrm
dx\mathrm dy\mathrm dz\\
&amp;\;+\sum_{ijk}\boldsymbol{e}_i\int_{\Omega}\mathrm dx\mathrm
dy\mathrm dz\,\epsilon_{ijk}\varGamma_{jk}.\end{align*}\]</span>
牛顿第二定律即 (<span
class="math inline">\(\ref{momentum-equation-2}\)</span>)告诉我们：<span
class="math inline">\(\rho\mathrm d\boldsymbol v/\mathrm
dt=\rho\boldsymbol
f_b+\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>，所以第一行的三项可以忽略，进而我们发现：
<span
class="math display">\[\sum_{jk}\epsilon_{ijk}\varGamma_{jk}=0,\]</span>
这意味着 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
必须是对称张量。</p>
<h2 id="能量守恒方程">能量守恒方程</h2>
<h3 id="能量守恒定律">能量守恒定律</h3>
<p>热力学第一定律告诉我们：流体内能只可能通过传热和做功这两种方式发生改变。在流体中，做功的力就是前述的质量力与表面力，而传热也有表面传热、辐射传热等方式，还有化学反应产热等等。</p>
<p>我们仍然假设一团流体占据的空间体积为 <span
class="math inline">\(\Omega\)</span>，其边界为 <span
class="math inline">\(\partial\Omega\)</span>，<span
class="math inline">\(\boldsymbol f_b\)</span>
为单位质量的流体受到的质量力，<span class="math inline">\(\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
为 <span class="math inline">\(\partial\Omega\)</span> 上的面积元 <span
class="math inline">\(\mathrm d^2\boldsymbol{S}\)</span>
受到的表面力。</p>
<p>我们还假设流体中单位质量的内能为 <span class="math inline">\(\tilde
u\)</span>，注意 <span class="math inline">\(\tilde u\)</span>
不含流体的宏观流动速度 <span
class="math inline">\(\boldsymbol{v}\)</span> 总体动能；<span
class="math inline">\(-\boldsymbol j_q\cdot\mathrm
d^2\boldsymbol{S}\)</span> 为单位时间内穿过面积元 <span
class="math inline">\(\mathrm d^2\boldsymbol{S}\)</span>
进入流体内的热量，因为 <span class="math inline">\(\boldsymbol
j_q\)</span> 从温度高的地方指向温度低的地方，<span
class="math inline">\(\boldsymbol j_q\)</span> 与 <span
class="math inline">\(\mathrm d^2\boldsymbol{S}\)</span>
指向相同意味着热量的流出，指向相反才意味着流入；<span
class="math inline">\(\dot q\)</span>
为单位质量的流体在单位时间内通过热辐射等其他方式获得的热量。</p>
<p>那么，不难想象，流体的能量守恒定律为： <span
class="math display">\[\begin{align*}\dfrac{\mathrm d}{\mathrm
dt}\int_\Omega\rho\left(\tilde u+\dfrac12\boldsymbol{v}^2\right)\mathrm
dx\mathrm dy\mathrm dz=&amp;\;\int_\Omega\rho\boldsymbol f_b\cdot
\boldsymbol{v}\mathrm dx\mathrm dy\mathrm
dz+\int_{\partial\Omega}\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v}\\
&amp;-\int_{\partial\Omega}\mathrm d^2\boldsymbol{S}\cdot\boldsymbol
j_q+\int_\Omega\rho\dot q\mathrm dx\mathrm dy\mathrm dz\\
=&amp;\;\int_\Omega\rho\boldsymbol f_b\cdot \boldsymbol{v}\mathrm
dx\mathrm dy\mathrm
dz+\int_{\Omega}\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})\mathrm dx\mathrm dy\mathrm dz\\
&amp;-\int_{\Omega}\nabla\cdot\boldsymbol{j}_q\mathrm dx\mathrm
dy\mathrm dz+\int_\Omega\rho\dot q\mathrm dx\mathrm dy\mathrm
dz,\end{align*}\]</span> 利用连续性方程的结论 (<span
class="math inline">\(\ref{d_dt-and-mass-equation}\)</span>)
式，我们发现： <span class="math display">\[\begin{align}
\rho\dfrac{\mathrm d}{\mathrm dt}\left(\tilde
u+\dfrac12\boldsymbol{v}^2\right)=\rho\boldsymbol f_b\cdot
\boldsymbol{v}+\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})-\nabla\cdot\boldsymbol{j}_q+\rho\dot q.
\label{energy-equation}\end{align}\]</span></p>
<p><span
class="math inline">\(\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})\)</span> 项可做进一步的化简：如果 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
是对称张量，那么： <span
class="math display">\[\begin{align*}\begin{split}
\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})=&amp;\;\sum_{ij}\partial_i(\varGamma_{ij}v_j)=\sum_{ij}\left[(\partial_i\varGamma_{ij})v_j+\varGamma_{ij}\partial_iv_j\right]\\
=&amp;\;\sum_{ij}\left[(\partial_i\varGamma_{ij})v_j+\varGamma_{ij}\dfrac12\left(\partial_iv_j+\partial_jv_i\right)\right]\\
=&amp;\;(\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}})\cdot\boldsymbol{v}+\overleftrightarrow{\boldsymbol{\varGamma}}:\overleftrightarrow{\boldsymbol{\varepsilon}}.
\end{split}\end{align*}\]</span></p>
<h3 id="傅里叶热传导定律">傅里叶热传导定律</h3>
<p>傅里叶热传导定律告诉我们： <span
class="math display">\[\boldsymbol{j}_q=-\overleftrightarrow{\boldsymbol{\lambda}}\cdot\nabla
T.\]</span> 其中 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\lambda}}\)</span>
为热导率张量，负号是因为热量总是倾向于从温度高的地方流向温度低的地方。</p>
<p>在很多情况下有 <span
class="math inline">\(\overleftrightarrow{\boldsymbol{\lambda}}=\lambda\overleftrightarrow{\boldsymbol{I}}\)</span>，此时
<span class="math inline">\(\boldsymbol{j}_q=-\lambda\nabla
T\)</span>，能量守恒方程就变成了： <span
class="math display">\[\begin{align*}
\rho\dfrac{\mathrm d}{\mathrm dt}\left(\tilde
u+\dfrac12\boldsymbol{v}^2\right)=\rho\boldsymbol f_b\cdot
\boldsymbol{v}+\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})+\nabla\cdot(\lambda\nabla T)+\rho\dot q.
\end{align*}\]</span></p>
<h2 id="总结">总结</h2>
<p>总结一下：流体的质量守恒、动量守恒、能量守恒方程分别为：</p>
<ul>
<li><p>质量守恒：<span class="math inline">\(\dfrac{\mathrm
d\rho}{\mathrm
dt}+\rho\nabla\cdot\boldsymbol{v}=\dfrac{\partial\rho}{\partial
t}+\nabla\cdot(\rho \boldsymbol v)=0.\)</span></p></li>
<li><p>动量守恒：<span class="math inline">\(\rho\dfrac{\mathrm
d\boldsymbol v}{\mathrm d t}=\rho\boldsymbol
f_b+\nabla\cdot\overleftrightarrow{\boldsymbol{\varGamma}}.\)</span></p></li>
<li><p>能量守恒：<span class="math inline">\(\rho\dfrac{\mathrm
d}{\mathrm dt}\left(\tilde
u+\dfrac12\boldsymbol{v}^2\right)=\rho\boldsymbol f_b\cdot
\boldsymbol{v}+\nabla\cdot(\overleftrightarrow{\boldsymbol{\varGamma}}\cdot
\boldsymbol{v})-\nabla\cdot\boldsymbol{j}_q+\rho\dot
q.\)</span></p></li>
</ul>
<p>其中：</p>
<ul>
<li><p><span class="math inline">\(\boldsymbol f_b\)</span>
为单位质量的流体受到的质量力。</p></li>
<li><p><span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
为表面力，流体上的面积元 <span class="math inline">\(\mathrm
d^2\boldsymbol{S}\)</span> 受到的表面力为 <span
class="math inline">\(\mathrm
d^2\boldsymbol{S}\cdot\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>，角动量守恒的条件保证了
<span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}\)</span>
为对称张量。</p></li>
<li><p>流体中单位质量的内能为 <span class="math inline">\(\tilde
u\)</span>，注意它不能包含宏观流动的动能。</p></li>
<li><p><span class="math inline">\(\boldsymbol j_q\)</span>
为热流，单位时间内穿过流体上的面积元 <span class="math inline">\(\mathrm
d^2\boldsymbol{S}\)</span> 进入流体的热量为 <span
class="math inline">\(-\mathrm d^2\boldsymbol{S}\cdot\boldsymbol
j_q\)</span> 。</p></li>
<li><p><span class="math inline">\(\dot q\)</span>
为单位质量的流体在单位时间内通过热辐射等其他方式获得的热量。</p></li>
</ul>
<p>此外还有与流体具体材质相关的两个关系式：</p>
<ul>
<li><p>广义牛顿黏性假设：<span
class="math inline">\(\overleftrightarrow{\boldsymbol{\varGamma}}=\mu\left[2\overleftrightarrow{\boldsymbol{\varepsilon}}-\dfrac23(\nabla\cdot\boldsymbol{v})\overleftrightarrow{\boldsymbol{I}}\right]-p\overleftrightarrow{\boldsymbol{I}}\)</span>。</p></li>
<li><p>傅里叶热传导定律：<span
class="math inline">\(\boldsymbol{j}_q=-\overleftrightarrow{\boldsymbol{\lambda}}\cdot\nabla
T\)</span>。 <span class="math inline">\(\\[1.5em]\)</span></p></li>
</ul>
<p>在广义牛顿黏性假设下，动量守恒方程可变为 Navier-Stokes 方程： <span
class="math display">\[\rho\dfrac{\mathrm d\boldsymbol v}{\mathrm d
t}=\rho\boldsymbol
f_b+\mu\left[\nabla^2\boldsymbol{v}+\dfrac13\nabla(\nabla\cdot\boldsymbol{v})\right]-\nabla
p.\]</span></p>
<hr />
<h2 id="基本方程的特殊情形">基本方程的特殊情形</h2>
<h3 id="不可压缩流体">不可压缩流体</h3>
<p>我们已经知道，<span
class="math inline">\(\nabla\cdot\boldsymbol{v}\)</span>
是流体体积随时间的相对变化率，所以，<strong>不可压缩流体</strong>必然满足
<span class="math display">\[\nabla\cdot\boldsymbol{v}=0.\]</span>
此时的质量守恒方程就变为： <span class="math display">\[\dfrac{\mathrm
d\rho}{\mathrm dt}=0,\]</span>
即流体的密度恒定不变，这是一个很自然的结果。</p>
<p>与此同时，Navier-Stokes 方程变为： <span
class="math display">\[\rho\dfrac{\mathrm d\boldsymbol v}{\mathrm d
t}=\rho\boldsymbol f_b+\mu\nabla^2\boldsymbol{v}-\nabla p.\]</span></p>
<h3 id="无粘性流体的欧拉运动方程">无粘性流体的欧拉运动方程</h3>
<p>流体没有黏性时，不管其是否可压缩，其动量守恒方程都能简化为如下欧拉方程：
<span class="math display">\[\rho\dfrac{\mathrm d\boldsymbol v}{\mathrm
d t}=\rho\boldsymbol f_b-\nabla p.\]</span></p>
<h3 id="静力平衡方程">静力平衡方程</h3>
<p>当流体不发生运动，即 <span
class="math inline">\(\boldsymbol{v}\)</span> 恒为 <span
class="math inline">\(0\)</span> 时，Navier-Stocks 方程简化为： <span
class="math display">\[\rho\boldsymbol f_b-\nabla p=0.\]</span>
这就是我们在初中学习的 <span class="math inline">\(p=\rho
gh\)</span>。</p>
<h3 id="伯努利方程">伯努利方程</h3>
<p>考虑一个不可压缩（即 <span class="math inline">\(\rho\)</span>
为常数）、无黏性（即 <span
class="math inline">\(\mu=0\)</span>）、内能恒定不变（即 <span
class="math inline">\(\mathrm d\tilde u/\mathrm
dt=0\)</span>）没有热量传递（即 <span
class="math inline">\(\boldsymbol{j}_q=\dot
q=0\)</span>）、处于一个保守力场中（即 <span
class="math inline">\(\boldsymbol
f_b=-\nabla\Phi\)</span>）、且做定常流动（即 <span
class="math inline">\(\partial\boldsymbol{v}/\partial t=\partial
p/\partial t=0\)</span>）的流体。此时的欧拉方程变为： <span
class="math display">\[\rho\dfrac{\mathrm d\boldsymbol v}{\mathrm d
t}=-\rho\nabla\Phi-\nabla p.\]</span> 两边同时点乘 <span
class="math inline">\(\boldsymbol{v}\)</span>，得到： <span
class="math display">\[\dfrac{\mathrm d}{\mathrm d
t}\left(\dfrac12\rho\boldsymbol v^2\right)=-\rho\boldsymbol
v\cdot\nabla\Phi-\boldsymbol v\cdot\nabla p.\]</span> 利用 <span
class="math inline">\(\partial\Phi/\partial t=0\)</span> 以及 <span
class="math inline">\(\partial p/\partial t=0\)</span> 可以发现 <span
class="math inline">\(\boldsymbol v\cdot\nabla\Phi=\mathrm d\Phi/\mathrm
dt\)</span> 以及 <span class="math inline">\(\boldsymbol v\cdot\nabla
p=\mathrm dp/\mathrm dt\)</span>。这样一来以上方程就变为： <span
class="math display">\[\dfrac{\mathrm d}{\mathrm d
t}\left(\dfrac12\rho\boldsymbol v^2+\rho\Phi+p\right)=0.\]</span>
这就是伯努利方程。</p>
<hr />
<h1 id="参考书籍">参考书籍</h1>
<ul>
<li>《我所理解的流体力学》王洪伟.<span
class="math inline">\(\quad\)</span>北京：国防工业出版社，2014.</li>
<li>《计算流体力学基础及其应用》J. D. Anderson 著；吴颂平，刘赵淼
译.<span
class="math inline">\(\quad\)</span>北京：机械工业出版社，2007.</li>
<li>《流体力学》余志豪，苗曼倩，蒋全荣，杨平章.<span
class="math inline">\(\quad\)</span>北京：气象出版社，2004.</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/Clifford/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/Clifford/" class="post-title-link" itemprop="url">Spin 群与 Clifford 代数</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-09 14:39:03" itemprop="dateModified" datetime="2024-08-09T14:39:03+08:00">2024-08-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr />
<h1 id="mathrmsopq-群与-mathrmspinpq-群"><span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群与 <span
class="math inline">\(\mathrm{Spin}(p,q)\)</span> 群</h1>
<h2 id="mathrmsopq-群"><span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群</h2>
<p>正交群 <span class="math inline">\(\mathrm{O}(N\)</span>) 就是 <span
class="math inline">\(\mathbb R^N\)</span>
中的正交变换构成的群。作为它的推广，我们考虑 <span
class="math inline">\(\mathbb R^{p+q}\)</span>，并且在其中指定度规</p>
<blockquote class="colorquote definition" ><p><span
class="math display">\[\begin{align}\eta:=\mathrm{diag}\{\underbrace{+1,+1,\cdots,+1}_{p},\underbrace{-1,-1,\cdots,-1}_{q}\}.\label{metric}\end{align}\]</span></p>
</blockquote>
<p><span class="math inline">\(\mathrm{O}(p,q)\)</span>
群就定义为全体保持 <span class="math inline">\(\eta\)</span>
给出的二次型不变的线性变换构成的群，<span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群就是 <span
class="math inline">\(\mathrm{O}(p,q)\)</span> 群中行列式为 <span
class="math inline">\(1\)</span> 的元素构成的群：</p>
<blockquote class="colorquote definition" ><p><span class="math display">\[\begin{align*}
\begin{split}
\mathrm{O}(p,q):=&amp;\;\{A\in M_{p+q}(\mathbb R):\;\;A^{\mathrm T}\eta
A=\eta\},\\
\mathrm{SO}(p,q):=&amp;\;\{A\in M_{p+q}(\mathbb R):\;\;A^{\mathrm T}\eta
A=\eta,\;\det(A)=1\}.
\end{split}
\end{align*}\]</span></p>
</blockquote>
<p>不难想象，<span
class="math inline">\(\mathrm{O}(p,q)\simeq\mathrm{O}(q,p)\)</span>，以及
<span
class="math inline">\(\mathrm{SO}(p,q)\simeq\mathrm{SO}(q,p)\)</span>。当
<span class="math inline">\(q=0\)</span> 或 <span
class="math inline">\(q=0\)</span> 时，<span
class="math inline">\(\mathrm{O}(p,q)\)</span>
就回到了我们熟悉的正交群：<span
class="math inline">\(\mathrm{O}(p,0)=\mathrm{O}(0,p)=\mathrm{O}(p)\)</span>
以及 <span
class="math inline">\(\mathrm{SO}(p,0)=\mathrm{SO}(0,p)=\mathrm{SO}(p)\)</span>。这个宇宙的洛伦兹群就是
<span class="math inline">\(\mathrm{O}(1,3)\)</span>。</p>
<p>我们一般都将 <span class="math inline">\(\mathrm{O}(p,q)\)</span> 与
<span class="math inline">\(\mathrm{SO}(p,q)\)</span> 视为 <span
class="math inline">\(\mathbb R^{p+q}\)</span> 而非 <span
class="math inline">\(\mathbb C^{p+q}\)</span> 上的变换群，这是因为
<span class="math inline">\(\mathrm{O}(p,q;\mathbb
C)=\mathrm{O}(p+q,\mathbb C)\)</span>：给某些坐标分量乘以 <span
class="math inline">\(\mathrm{i}\)</span> 就能将 <span
class="math inline">\(\eta\)</span> 变为 <span
class="math inline">\(\mathrm{diag}\{+1,\cdots,+1\}\)</span>，这也意味着
<span class="math inline">\(\mathrm{O}(p,q)\)</span> 的李代数与 <span
class="math inline">\(\mathrm{o}(p+q)\)</span> 一样也是 <span
class="math inline">\(\mathrm{o}(p+q,\mathbb C)\)</span> 的实形。</p>
<h2 id="mathrmsopq-群的连通性"><span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群的连通性</h2>
<p>很显然，<span class="math inline">\(\mathrm{O}(p,q)\)</span>
群并不是连通的。乍一看，就如同 <span class="math inline">\(\mathrm
O(n)\)</span> 群一样，它可能有两个连通分量，一个是 <span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群，另一个分量则由 <span
class="math inline">\(\mathrm{O}(p,q)\)</span> 群中行列式为 <span
class="math inline">\(-1\)</span> 的矩阵构成。但 <span
class="math inline">\(\mathrm{SO}(p,q)\)</span>
也不是连通的，它也有两个连通分量，因此 <span
class="math inline">\(\mathrm{O}(p,q)\)</span> 实际上有 4
个连通分量。实际上，如果将 <span
class="math inline">\(\mathrm{O}(p,q)\)</span> 群中的矩阵写为 <span
class="math display">\[\begin{align*}
A=\begin{bmatrix}P_{p\times p}&amp;R_{p\times q}\\L_{q\times
p}&amp;Q_{q\times q}\end{bmatrix}\in \mathrm{O}(p,q).
\end{align*}\]</span> 的形式，那么我们可以证明 <span
class="math inline">\(\det(P)\)</span> 必然不为 <span
class="math inline">\(0\)</span>，并且 <span
class="math inline">\(\det(P)&gt;0\)</span> 的矩阵也能形成一个群，记为
<span class="math inline">\(\mathrm{O}_+(p,q)\)</span>。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>首先，我们将 O<span class="math inline">\((p,q)\)</span>
群中的矩阵写为： <span class="math display">\[\begin{align*}
A=\begin{bmatrix}P_{p\times p}&amp;R_{p\times q}\\L_{q\times
p}&amp;Q_{q\times q}\end{bmatrix}.
\end{align*}\]</span> 利用<a
target="_blank" rel="noopener" href="https://mathoverflow.net/questions/87877/jacobis-equality-between-complementary-minors-of-inverse-matrices">逆矩阵子式的
Jacobi 公式</a>以及 <span class="math inline">\(A^{-1}=\eta A^{\mathrm
T}\eta\)</span> 不难发现，<span class="math inline">\(\det P=\det Q/\det
A\)</span>。</p>
<p>接下来我们证明 <span class="math inline">\(\det P\neq
0\)</span>。利用 <span class="math inline">\(A^{\mathrm T}\eta
A=\eta\)</span> 可以发现： <span class="math display">\[\begin{align*}
\begin{split}
\begin{bmatrix}1&amp;0\\0&amp;-1\end{bmatrix}=&amp;\;\begin{bmatrix}P^{\mathrm
T}&amp;L^{\mathrm T}\\R^{\mathrm T}&amp;Q^{\mathrm
T}\end{bmatrix}\begin{bmatrix}1&amp;0\\0&amp;-1\end{bmatrix}\begin{bmatrix}P&amp;R\\L&amp;Q\end{bmatrix}=\begin{bmatrix}P^{\mathrm
T}&amp;-L^{\mathrm T}\\R^{\mathrm T}&amp;-Q^{\mathrm
T}\end{bmatrix}\begin{bmatrix}P&amp;R\\L&amp;Q\end{bmatrix}\\
=&amp;\;\begin{bmatrix}P^{\mathrm T}P-L^{\mathrm T}L&amp;P^{\mathrm
T}R-L^{\mathrm T}Q\\R^{\mathrm T}P-Q^{\mathrm T}L&amp;R^{\mathrm
T}R-Q^{\mathrm T}Q\end{bmatrix}.
\end{split}
\end{align*}\]</span> 利用 <span class="math inline">\(A\eta A^{\mathrm
T}=\eta\)</span> 可以发现： <span class="math display">\[\begin{align*}
\begin{split}
\begin{bmatrix}1&amp;0\\0&amp;-1\end{bmatrix}=&amp;\;\begin{bmatrix}P&amp;R\\L&amp;Q\end{bmatrix}\begin{bmatrix}1&amp;0\\0&amp;-1\end{bmatrix}\begin{bmatrix}P^{\mathrm
T}&amp;L^{\mathrm T}\\R^{\mathrm T}&amp;Q^{\mathrm
T}\end{bmatrix}=\begin{bmatrix}P&amp;R\\L&amp;Q\end{bmatrix}\begin{bmatrix}P^{\mathrm
T}&amp;L^{\mathrm T}\\-R^{\mathrm T}&amp;-Q^{\mathrm T}\end{bmatrix}\\
=&amp;\;\begin{bmatrix}PP^{\mathrm T}-RR^{\mathrm T}&amp;PL^{\mathrm
T}-RQ^{\mathrm T}\\LP^{\mathrm T}-QR^{\mathrm T}&amp;LL^{\mathrm
T}-QQ^{\mathrm T}\end{bmatrix}.
\end{split}
\end{align*}\]</span> 这意味着： <span
class="math display">\[\begin{align*}
P^{\mathrm T}P&amp;=1+L^{\mathrm T}L,\\
PP^{\mathrm T}&amp;=1+RR^{\mathrm T},\\
QQ^{\mathrm T}&amp;=LL^{\mathrm T}+1,\\
Q^{\mathrm T}Q&amp;=1+R^{\mathrm T}R.
\end{align*}\]</span> 显然，<span
class="math inline">\(\det(1+L^{\mathrm T}L)&gt;0\)</span>、<span
class="math inline">\(\det(1+RR^{\mathrm T})&gt;0\)</span>，于是 <span
class="math inline">\(\det(P)\neq 0\)</span>，同理 <span
class="math inline">\(\det(Q)\neq 0\)</span>。</p>
<p>现在我们考虑 <span class="math inline">\(A_1A_2\)</span>，不难算出：
<span class="math display">\[\begin{align*}
A_1A_2=\begin{bmatrix}P_1P_2+R_1L_2&amp;\cdots\\
\cdots&amp;\cdots\end{bmatrix}.
\end{align*}\]</span> 要证明 O<span
class="math inline">\(_+(p,q)\)</span> 群是 O<span
class="math inline">\((p,q)\)</span> 群的子群，就只需要证明 <span
class="math inline">\(\det(P_{1,2})&gt;0\)</span> 时有 <span
class="math inline">\(\det(P_1P_2+R_1L_2)&gt;0\)</span>。首先可以发现：
<span class="math display">\[\begin{align*}
\det(P_1P_2+R_1L_2)=(\det P_1)(\det P_2)\det(1+P_1^{-1}R_1L_2P_2^{-1}).
\end{align*}\]</span> 我们只需要证明 <span
class="math inline">\(\det(1+P_1^{-1}R_1L_2P_2^{-1})&gt;0\)</span>
即可。我们定义 <span
class="math inline">\(K=P_1^{-1}R_1L_2P_2^{-1}\)</span>，然后利用刚刚算出来的
<span class="math inline">\(PL^{\mathrm T}=RQ^{\mathrm T}\)</span> 与
<span class="math inline">\(P^{\mathrm T}R=L^{\mathrm T}Q\)</span>
做一些化简： <span class="math display">\[\begin{align*}
K=P_1^{-1}R_1L_2P_2^{-1}=L_1^{\mathrm T}(Q_1^{-1})^{\mathrm
T}L_2P_2^{-1}.
\end{align*}\]</span> 然后考虑 <span class="math inline">\(K^{\mathrm
T}K\)</span>： <span class="math display">\[\begin{align*}
\begin{split}
K^{\mathrm T}K=&amp;\;(P_2^{\mathrm T})^{-1}L_2^{\mathrm
T}Q_1^{-1}L_1L_1^{\mathrm T}(Q_1^{-1})^{\mathrm
T}L_2P_2^{-1}=(P_2^{\mathrm T})^{-1}L_2^{\mathrm
T}Q_1^{-1}(Q_1Q^{\mathrm T}_1-1)(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}\\
=&amp;\;(P_2^{\mathrm T})^{-1}L_2^{\mathrm
T}[1-Q_1^{-1}(Q_1^{-1})^{\mathrm T}]L_2P_2^{-1}\\
=&amp;\;(P_2^{\mathrm T})^{-1}L_2^{\mathrm
T}L_2P_2^{-1}-[(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}]^{\mathrm
T}[(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}]\\
=&amp;\;(P_2^{\mathrm T})^{-1}(P_2^{\mathrm
T}P_2-1)P_2^{-1}-[(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}]^{\mathrm
T}[(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}]\\
=&amp;\;1-(P_2^{-1})^{\mathrm T}P_2^{-1}-[(Q_1^{-1})^{\mathrm
T}L_2P_2^{-1}]^{\mathrm T}[(Q_1^{-1})^{\mathrm T}L_2P_2^{-1}].
\end{split}
\end{align*}\]</span> 这意味着 <span class="math inline">\(K^{\mathrm
T}K-1\)</span> 是负定的，也就是说 <span class="math inline">\(K^{\mathrm
T}K\)</span> 的 <span class="math inline">\(2\)</span>-范数小于 <span
class="math inline">\(1\)</span>，也就是最大特征值的绝对值不会超过 <span
class="math inline">\(1\)</span>，因此 <span
class="math inline">\(\det(1+K)\geqslant0\)</span>。之前已经证明过左上角的矩阵的行列式不可能为
<span class="math inline">\(0\)</span>，所以 <span
class="math inline">\(\det(1+K)&gt;0\)</span>，这样一来就完成了证明。</p>

    </div>
</div>
<p>这样一来，<span class="math inline">\(\det(P)&lt;0\)</span> 的矩阵与
<span class="math inline">\(\mathrm{O}_+(p,q)\)</span>
群的群元就不会属于同一个连通分支，导致 <span
class="math inline">\(\mathrm{O}(p,q)\)</span> 有 4 个连通分量。<span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 中满足 <span
class="math inline">\(\det(P)&gt;0\)</span> 的群元可以形成 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span>
群，在现实世界中，<span class="math inline">\(\mathrm{SO}(1,3)\)</span>
就是恰当洛伦兹群，而 <span
class="math inline">\(\mathrm{SO}_+(1,3)\)</span>
就是恰当正时洛伦兹群。</p>
<p>从直观上来说，<span class="math inline">\(\mathrm{O}(p,q)\)</span>
群中的所有元素都可通过一系列反射变换得到。假设 <span
class="math inline">\(v\)</span> 是 <span class="math inline">\(\mathbb
R^{p+q}\)</span> 中的向量，且 <span class="math inline">\(\eta(v,v)\neq
0\)</span>，那么以 <span class="math inline">\(v\)</span>
为法向量的平面的镜面反射 <span class="math inline">\(\rho_v\)</span>
作用于另一个向量 <span class="math inline">\(u\)</span>
的结果可定义为：</p>
<blockquote class="colorquote definition" ><p><span
class="math display">\[\begin{align}\rho_v(u)=u-2\dfrac{\eta(u,v)}{\eta(v,v)}v.\label{reflection}\end{align}\]</span></p>
</blockquote>
<p><span class="math inline">\(\mathrm{O}(p,q)\)</span>
中的所有元素一定可以写为若干个这样的 <span
class="math inline">\(\rho_v\)</span> 的乘积：<span
class="math inline">\(A=\rho_{v_1}\rho_{v_2}\cdots\rho_{v_k}\)</span>。<span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群中的元素一定是偶数个
<span class="math inline">\(\rho_{v_i}\)</span> 的乘积，而 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 群则对应于有偶数个
<span class="math inline">\(v_i\)</span> 满足 <span
class="math inline">\(\eta(v_i,v_i)&gt;0\)</span>、偶数个 <span
class="math inline">\(v_i\)</span> 满足 <span
class="math inline">\(\eta(v_i,v_i)&lt;0\)</span> 的情形。</p>
<p>就如同 <span class="math inline">\(\mathrm{SO}(3)\)</span> 一样，
<span class="math inline">\(\mathrm{SO}_+(p,q)\)</span>
也不是单连通的。数学上可以证明，<span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 的基本群为：</p>
<blockquote class="colorquote theorem" ><p><span
class="math display">\[\pi_1[\mathrm{SO}_{+}(p,q)]=\pi_1[\mathrm{SO}(p)]\times\pi_1[\mathrm{SO}(q)],\]</span></p>
</blockquote>
<p>以及：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\pi_1[\mathrm{SO}(1)]=\{e\},\quad
\pi_1[\mathrm{SO}(2)]=\mathbb Z,\quad
\pi_1[\mathrm{SO}(n\geqslant3)]=\mathbb Z_2.\]</span></p>
</blockquote>
<p>因此只要 <span class="math inline">\(p\)</span> 与 <span
class="math inline">\(q\)</span> 中有一个大于 <span
class="math inline">\(1\)</span>，<span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span>
就不是单连通的。物理上各类场的变换群总应该是单连通的，但 <span
class="math inline">\(\pi_1[\mathrm{SO}(3)]\)</span> 与 <span
class="math inline">\(\pi_1[\mathrm{SO}_+(1,3)]\)</span> 都等于 <span
class="math inline">\(\mathbb Z_2\)</span>，因此，物理上的变换群应该是
<span class="math inline">\(\mathrm{SO}(3)\)</span> 与 <span
class="math inline">\(\mathrm{SO}_+(1,3)\)</span>
的某种单连通的覆盖群。</p>
<h2 id="mathrmspinpq-群"><span
class="math inline">\(\mathrm{Spin}(p,q)\)</span> 群</h2>
<p>旋量群 <span class="math inline">\(\mathrm{Spin}(p,q)\)</span> 与
<span class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 就定义为 <span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 与 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 的双重覆盖群。</p>
<p>它们在一些情形下——如最重要的 <span
class="math inline">\(\mathrm{Spin}(p,0)\)</span> 或 <span
class="math inline">\(\mathrm{Spin}_+(1,3)\)</span>——是单连通的，所以人们也会关注
<span class="math inline">\(\mathrm{Spin}(p,q)\)</span>
的表示，这些表示就是 <span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 的旋量表示。</p>
<h2 id="mathrmsopq-群的李代数"><span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 群的李代数</h2>
<p>在明确了 <span class="math inline">\(\mathrm{SO}(p,q)\)</span>
群的整体性质之后，我们来计算它们的李代数。</p>
<p>考虑 <span class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 中的群元
<span class="math inline">\(A=\mathrm{e}^{-\mathrm{i} \varepsilon
X}\)</span>，<span class="math inline">\(\varepsilon\)</span>
为一个小量。<span class="math inline">\(A^{\mathrm T}\eta
A=\eta\)</span> 的条件给出： <blockquote class="colorquote definition" ><p><span class="math display">\[\begin{align*}
\mathrm{so}(p,q):=&amp;\;\{-\mathrm{i} X\in M_{p+q}(\mathbb
R):\;\;X^{\mathrm T}\eta+\eta X=0\}.
\end{align*}\]</span></p>
</blockquote> 假设 <span
class="math display">\[\begin{align*}
X=\begin{bmatrix}P_{p\times p}&amp;R_{p\times q}\\L_{q\times
p}&amp;Q_{q\times q}\end{bmatrix}\in \mathrm{so}(p,q),\quad X^{\mathrm
T}=\begin{bmatrix}P^{\mathrm T}&amp;L^{\mathrm T}\\R^{\mathrm
T}&amp;Q^{\mathrm T}\end{bmatrix}.
\end{align*}\]</span> 那么不难发现 <span
class="math inline">\(P+P^{\mathrm T}=0\)</span>、<span
class="math inline">\(Q+Q^{\mathrm T}=0\)</span> 以及 <span
class="math inline">\(R=L^{\mathrm T}\)</span>。从这些条件也可以看出
<span class="math inline">\(\mathrm{tr}(X)=0\)</span>，以及 <span
class="math inline">\(\dim
\mathrm{so}(p,q)=(p+q)(p+q-1)/2\)</span>。</p>
<p><span class="math inline">\(\mathrm{so}(p,q)\)</span> 常用的一组基为
<span class="math inline">\(\{L_{\mu\nu}\}\)</span>： <blockquote class="colorquote definition" ><p><span class="math display">\[\begin{align*}
{(L_{\mu\nu})^i}_j:=\mathrm{i}(\delta^i_\mu\eta_{\nu
j}-\delta^i_\nu\eta_{\mu j}).
\end{align*}\]</span></p>
</blockquote>
不难验证这一系列矩阵满足上述条件。然后其对易关系为： <blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
[L_{\mu\nu},L_{\rho\sigma}]=\mathrm{i}(\eta_{\nu\rho}L_{\mu\sigma}-\eta_{\rho\mu}L_{\nu\sigma}+\eta_{\sigma\nu}L_{\rho\mu}-\eta_{\sigma\mu}L_{\rho\nu}).
\end{align*}\]</span></p>
</blockquote></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>考虑 <span class="math display">\[\begin{align*}
{(L_{\mu\nu})^i}_j=\mathrm{i}(\delta^i_\mu\eta_{\nu
j}-\delta^i_\nu\eta_{\mu j})=-{(L_{\nu\mu})^i}_j.
\end{align*}\]</span> 那么： <span class="math display">\[\begin{align*}
\begin{split}
{(L_{\mu\nu}L_{\rho\sigma})^i}_j=&amp;\;\sum_k{(L_{\mu\nu})^i}_k{(L_{\rho\sigma})^k}_j=-\sum_k(\delta^i_\mu\eta_{\nu
k}-\delta^i_\nu\eta_{\mu k})(\delta^k_\rho\eta_{\sigma
j}-\delta^k_\sigma\eta_{\rho j})\\
=&amp;-\sum_k(\delta^i_\mu\eta_{\nu k}\delta^k_\rho\eta_{\sigma
j}-\delta^i_\nu\eta_{\mu k}\delta^k_\rho\eta_{\sigma
j}-\delta^i_\mu\eta_{\nu k}\delta^k_\sigma\eta_{\rho
j}+\delta^i_\nu\eta_{\mu k}\delta^k_\sigma\eta_{\rho j})\\
=&amp;-(\delta^i_\mu\eta_{\nu\rho}\eta_{\sigma
j}-\delta^i_\nu\eta_{\mu\rho}\eta_{\sigma
j}-\delta^i_\mu\eta_{\nu\sigma}\eta_{\rho
j}+\delta^i_\nu\eta_{\mu\sigma}\eta_{\rho j}).
\end{split}
\end{align*}\]</span> 同理： <span class="math display">\[\begin{align*}
\begin{split}
{(L_{\rho\sigma}L_{\mu\nu})^i}_j=&amp;-(\delta^i_\rho\eta_{\sigma\mu}\eta_{\nu
j}-\delta^i_\sigma\eta_{\rho\mu}\eta_{\nu
j}-\delta^i_\rho\eta_{\sigma\nu}\eta_{\mu
j}+\delta^i_\sigma\eta_{\rho\nu}\eta_{\mu j})\\
=&amp;-(\delta^i_\sigma\eta_{\rho\nu}\eta_{\mu
j}-\delta^i_\sigma\eta_{\rho\mu}\eta_{\nu
j}-\delta^i_\rho\eta_{\sigma\nu}\eta_{\mu
j}+\delta^i_\rho\eta_{\sigma\mu}\eta_{\nu j}).
\end{split}
\end{align*}\]</span> 所以： <span class="math display">\[\begin{align*}
\begin{split}
{(L_{\mu\nu}L_{\rho\sigma}-L_{\rho\sigma}L_{\mu\nu})^i}_j=&amp;\;(\delta^i_\sigma\eta_{\rho\nu}\eta_{\mu
j}-\delta^i_\sigma\eta_{\rho\mu}\eta_{\nu
j}-\delta^i_\rho\eta_{\sigma\nu}\eta_{\mu
j}+\delta^i_\rho\eta_{\sigma\mu}\eta_{\nu j})\\
&amp;-(\delta^i_\mu\eta_{\nu\rho}\eta_{\sigma
j}-\delta^i_\nu\eta_{\mu\rho}\eta_{\sigma
j}-\delta^i_\mu\eta_{\nu\sigma}\eta_{\rho
j}+\delta^i_\nu\eta_{\mu\sigma}\eta_{\rho j})\\
=&amp;\;\eta_{\rho\nu}(\delta^i_\sigma\eta_{\mu
j}-\delta^i_\mu\eta_{\sigma j})-\eta_{\rho\mu}(\delta^i_\sigma\eta_{\nu
j}-\delta^i_\nu\eta_{\sigma j})\\
&amp;-\eta_{\sigma\nu}(\delta^i_\rho\eta_{\mu j}-\delta^i_\mu\eta_{\rho
j})+\eta_{\sigma\mu}(\delta^i_\rho\eta_{\nu j}-\delta^i_\nu\eta_{\rho
j}).
\end{split}
\end{align*}\]</span> 因此： <span class="math display">\[\begin{align*}
\begin{split}
[L_{\mu\nu},L_{\rho\sigma}]=&amp;-\mathrm{i}(\eta_{\rho\nu}L_{\sigma\mu}-\eta_{\rho\mu}L_{\sigma\nu}-\eta_{\sigma\nu}L_{\rho\mu}+\eta_{\sigma\mu}L_{\rho\nu})\\
=&amp;\;\mathrm{i}(\eta_{\nu\rho}L_{\mu\sigma}-\eta_{\rho\mu}L_{\nu\sigma}+\eta_{\sigma\nu}L_{\rho\mu}-\eta_{\sigma\mu}L_{\rho\nu}).
\end{split}
\end{align*}\]</span></p>

    </div>
</div>
<hr />
<h1 id="mathrmspinpq-群与实-clifford-代数"><span
class="math inline">\(\mathrm{Spin}(p,q)\)</span> 群与实 Clifford
代数</h1>
<h2 id="实-clifford-代数">实 Clifford 代数</h2>
<p>在 <span class="math inline">\(p\)</span> 与 <span
class="math inline">\(q\)</span> 较小时，旋量群 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 可以比较简单地通过
<span class="math inline">\(\mathrm{SU}(N)\)</span>、<span
class="math inline">\(\mathrm{Sp}(N)\)</span>
等群经过简单的运算得到，最著名的例子就是三维转动群的 <span
class="math inline">\(\mathrm{Spin}(3,0)=\mathrm{Spin}_+(3,0)\simeq\mathrm{SU}(2)\)</span>，以及洛伦兹群的
<span
class="math inline">\(\mathrm{Spin}_+(1,3)\simeq\mathrm{SL}(2,\mathbb
C)\)</span>。但 <span class="math inline">\(p\)</span> 与 <span
class="math inline">\(q\)</span> 较大时，<span
class="math inline">\(\mathrm{Spin}(p,q)\)</span>
需要想办法单独构造。此时就需要用到 Clifford 代数。</p>
<p>首先，我们考虑 <span class="math inline">\(\mathbb K=\mathbb
R\)</span> 上的线性空间 <span
class="math inline">\(V\)</span>，并给它找一组基 <span
class="math inline">\(\{e_\mu\}\)</span>， 然后给 <span
class="math inline">\(V\)</span> 指定一个二次型 <span
class="math inline">\(\eta\)</span>，使得在刚刚那组基下，二次型的度规张量的分量为
<span class="math inline">\(\eta_{\mu\nu}:=
\eta(e_\mu,e_\nu)\)</span>。粗略地来说，如果在 <span
class="math inline">\(V\)</span>——严格说来应该是 <span
class="math inline">\(\mathbb K\oplus V\oplus(V\otimes V)\oplus(V\otimes
V\otimes V)\oplus\cdots\)</span>——中指定某种类似于“并矢”的运算 (Clifford
积)，并且假定这一并矢运算满足： <blockquote class="colorquote definition" ><p><span class="math display">\[\begin{align*}
e_\mu e_\nu+e_\nu e_\mu = 2\eta_{\mu\nu}.
\end{align*}\]</span></p>
</blockquote> 那么我们就能得到 <span
class="math inline">\(V\)</span> 上的实 Clifford 代数 <span
class="math inline">\(\mathrm{Cl}(V,\eta)\)</span>。不难验证，对于 <span
class="math inline">\(V\)</span> 中任意两个向量都有： <span
class="math display">\[\begin{align}
uv+vu=2\eta(u,v),\quad vv=\eta(v,v).
\label{Clifford}\end{align}\]</span> 很显然，<span
class="math inline">\(\mathrm{Cl}(V,\eta)\)</span>
也是一个实线性空间，它的一组基是： <span
class="math display">\[\begin{align*}
\{1,e_\mu,e_\mu e_\nu,e_\mu e_\nu e_\rho,\cdots\},\quad
\mu&lt;\nu&lt;\rho&lt;\cdots.
\end{align*}\]</span></p>
<h2 id="mathrmspinpq-群的构造"><span
class="math inline">\(\mathrm{Spin}(p,q)\)</span> 群的构造</h2>
<p>现在我们考虑 <span class="math inline">\(\mathbb R\)</span>
上的线性空间 <span class="math inline">\(V=\mathbb R^{p+q}\)</span>
并选标准基使得度规张量为 (<span
class="math inline">\(\ref{metric}\)</span>) 式的形式，此时的 Clifford
代数记为 <span class="math inline">\(\mathrm{Cl}(p,q)\)</span>。在引入
Clifford 代数之后，反射 (<span
class="math inline">\(\ref{reflection}\)</span>) 式可由 Clifford
积来表示： <span class="math display">\[\begin{align*}
\rho_v(u)=-\dfrac{vuv}{\eta(v,v)}.
\end{align*}\]</span> 要验证这一点，只需要利用 (<span
class="math inline">\(\ref{Clifford}\)</span>) 式将 <span
class="math inline">\(uv\)</span> 交换并将 <span
class="math inline">\(vv\)</span> 转化为 <span
class="math inline">\(\eta(v,v)\)</span> 即可。</p>
<p>然后我们可以定义如下几个旋量群： <blockquote class="colorquote definition" ><p><span class="math display">\[\begin{align*}
\begin{split}
\mathrm{Pin}(p,q) &amp;= \{R=v_1v_2\cdots v_n\in\mathrm{Cl}(p,q):\;\;
v_i\in\mathbb R^{p+q},\; v_iv_i=\pm1,\; n\text{ 为任意整数}\},\\
\mathrm{Spin}(p,q) &amp;= \{R=v_1v_2\cdots v_n\in\mathrm{Cl}(p,q):\;\;
v_i\in\mathbb R^{p+q},\; v_iv_i=\pm1,\; n\text{ 为偶数}\},\\
\mathrm{Spin}_+(p,q) &amp;= \{R=v_1v_2\cdots v_n\in\mathrm{Cl}(p,q):\;\;
v_i\in\mathbb R^{p+q},\;
\text{且满足}\;v_iv_i=\pm1\;\text{的}\;v_i\;\text{都是偶数个}\}.
\end{split}
\end{align*}\]</span></p>
</blockquote> 由于 <span
class="math inline">\(v\)</span> 与 <span
class="math inline">\(-v\)</span> 总是给出同一个 <span
class="math inline">\(\rho_v\)</span>，所以 <span
class="math inline">\(\mathrm{Spin}(p,q)\)</span> 与 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 分别是 <span
class="math inline">\(\mathrm{SO}(p,q)\)</span> 与 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span>
的双重覆盖群。基于这一原因，<span
class="math inline">\(\mathrm{O}(p,q)\)</span> 的双重覆盖群被记为 <span
class="math inline">\(\mathrm{Pin}(p,q)\)</span>。此外，<span
class="math inline">\(\mathrm{Spin}_+(n,0)=\mathrm{Spin}(n,0)\)</span>，并且可被记为
<span class="math inline">\(\mathrm{Spin}(n)\)</span>。</p>
<p>数学上可以证明，只要 <span class="math inline">\(p\)</span> 或 <span
class="math inline">\(q\)</span> 中有一个大于 <span
class="math inline">\(1\)</span>，那么 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span>
就是连通的。并且，只要 <span
class="math inline">\(n\geqslant3\)</span>，<span
class="math inline">\(\mathrm{Spin}(n)\)</span> 与 <span
class="math inline">\(\mathrm{Spin}(n,1)\)</span> 都是单连通的——考虑到
<span class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 是 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 的双重覆盖 以及 <span
class="math inline">\(n\geqslant3\)</span> 时 <span
class="math inline">\(\pi_1[\mathrm{SO}_+(n,0)]=\pi_1[\mathrm{SO}_+(n,1)]=\mathbb
Z_2\)</span>，这一点也不难理解。特别地，3 维转动群 <span
class="math inline">\(\mathrm{SO}(3)\)</span> 的双重覆盖群 <span
class="math inline">\(\mathrm{Spin}(3)\)</span> 与恰当正时洛伦兹群 <span
class="math inline">\(\mathrm{SO}_+(1,3)\)</span> 的双重覆盖 <span
class="math inline">\(\mathrm{Spin}_+(1,3)\)</span> 都是单连通的。</p>
<p>然后，我们来考虑 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 的李代数。我们定义
<span class="math inline">\(L_{\mu\nu}:= \mathrm{i} e_\mu
e_\nu/2\)</span>，就能发现它也符合 <span
class="math inline">\(\mathrm{SO}_+(p,q)\)</span> 的李代数：
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\begin{split}
[L_{\mu\nu},L_{\rho\sigma}]=\mathrm{i}(\eta_{\nu\rho}L_{\mu\sigma}-\eta_{\rho\mu}L_{\nu\sigma}+\eta_{\sigma\nu}L_{\rho\mu}-\eta_{\sigma\mu}L_{\rho\nu}).
\end{split}
\end{align*}\]</span></p>
</blockquote></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>由于： <span class="math display">\[\begin{align*}
e_\mu e_\nu + e_\nu e_\mu = 2\eta_{\mu\nu},
\end{align*}\]</span> 然后我们计算 <span class="math inline">\([e_\mu
e_\nu, e_\rho e_\sigma]\)</span>。首先，我们发现： <span
class="math display">\[\begin{align*}
\begin{split}
e_\mu e_\nu e_\alpha =&amp;\;e_\mu (2\eta_{\nu\alpha}-e_\alpha
e_\nu)=2\eta_{\nu\alpha}e_\mu-e_\mu e_\alpha e_\nu\\
=&amp;\;2\eta_{\nu\alpha}e_\mu -(2\eta_{\mu\alpha}-e_\alpha
e_\mu)  e_\nu =2\eta_{\nu\alpha}e_\mu -2\eta_{\mu\alpha}e_\nu +e_\alpha
e_\mu  e_\nu.
\end{split}
\end{align*}\]</span> 因此： <span class="math display">\[\begin{align*}
\begin{split}
e_\mu e_\nu e_\rho e_\sigma=&amp;\;(e_\mu e_\nu e_\rho
)e_\sigma=(2\eta_{\nu\rho}e_\mu -2\eta_{\mu\rho}e_\nu +e_\rho
e_\mu  e_\nu )e_\sigma\\
=&amp;\;2\eta_{\nu\rho}e_\mu e_\sigma-2\eta_{\mu\rho}e_\nu
e_\sigma+e_\rho (e_\mu  e_\nu e_\sigma)\\
=&amp;\;2\eta_{\nu\rho}e_\mu e_\sigma-2\eta_{\mu\rho}e_\nu
e_\sigma+e_\rho(2\eta_{\nu\sigma}e_\mu -2\eta_{\mu\sigma}e_\nu +e_\sigma
e_\mu  e_\nu)\\
=&amp;\;2\eta_{\nu\rho}e_\mu e_\sigma-2\eta_{\mu\rho}e_\nu
e_\sigma+2\eta_{\nu\sigma}e_\rho e_\mu -2\eta_{\mu\sigma}e_\rho e_\nu
+e_\rho e_\sigma e_\mu  e_\nu.
\end{split}
\end{align*}\]</span> 于是我们发现： <span
class="math display">\[\begin{align*}
\begin{split}
[e_\mu e_\nu,e_\rho e_\sigma]=&amp;\;2\eta_{\nu\rho}e_\mu
e_\sigma-2\eta_{\mu\rho}e_\nu e_\sigma+2\eta_{\nu\sigma}e_\rho e_\mu
-2\eta_{\mu\sigma}e_\rho e_\nu.
\end{split}
\end{align*}\]</span> 两边同时乘以 <span
class="math inline">\((\mathrm{i}/2)^2=-1/4\)</span>，并定义 <span
class="math inline">\(L_{\mu\nu}:= \mathrm{i} e_\mu
e_\nu/2\)</span>，我们发现： <span class="math display">\[\begin{align*}
\begin{split}
[L_{\mu\nu},L_{\rho\sigma}]=&amp;-\dfrac12(\eta_{\nu\rho}e_\mu
e_\sigma-\eta_{\mu\rho}e_\nu e_\sigma+\eta_{\nu\sigma}e_\rho e_\mu
-\eta_{\mu\sigma}e_\rho e_\nu)\\
=&amp;\;\mathrm{i}\dfrac{\mathrm{i}}{2}(\eta_{\nu\rho}e_\mu
e_\sigma-\eta_{\mu\rho}e_\nu e_\sigma+\eta_{\nu\sigma}e_\rho e_\mu
-\eta_{\mu\sigma}e_\rho e_\nu)\\
=&amp;\;\mathrm{i}(\eta_{\nu\rho}L_{\mu\sigma}-\eta_{\mu\rho}L_{\nu\sigma}+\eta_{\nu\sigma}L_{\rho\mu}
-\eta_{\mu\sigma}L_{\rho\nu}).
\end{split}
\end{align*}\]</span> 这就是 <span
class="math inline">\(\mathrm{so}(p,q)\)</span> 的对易关系。</p>

    </div>
</div>
<p>实际上，<span
class="math inline">\(\mathrm{e}^{\theta_{\mu\nu}L_{\mu\nu}}\)</span>
可以生成 <span class="math inline">\(\mu\nu\)</span>
平面内的旋转，因此所有 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 中的群元都能通过
<span
class="math inline">\(\mathrm{e}^{\theta_{\mu\nu}L_{\mu\nu}}\)</span>
表示出来： <span class="math display">\[\begin{align*}
\begin{split}
\mathrm{e}^{-\mathrm{i} \theta
L_{\mu\nu}}e_\mu\mathrm{e}^{\mathrm{i}\theta
L_{\mu\nu}}=&amp;\;e_\mu\cosh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right)+e_\nu\dfrac{-\eta_{\mu\mu}}{\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}}\sinh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right),\\
\mathrm{e}^{-\mathrm{i} \theta
L_{\mu\nu}}e_\nu\mathrm{e}^{\mathrm{i}\theta
L_{\mu\nu}}=&amp;\;e_\nu\cosh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right)+e_\nu\dfrac{\eta_{\nu\nu}}{\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}}\sinh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right).
\end{split}
\end{align*}\]</span> 对于 <span
class="math inline">\(\eta_{\mu\mu}\eta_{\nu\nu}=1\)</span> 的情形，利用
<span
class="math inline">\(\cosh\left(\sqrt{-1}\theta\right)=\cos(\theta)\)</span>
以及 <span
class="math inline">\(\sinh\left(\sqrt{-1}\theta\right)/\sqrt{-1}=\sin(\theta)\)</span>
就能看出这是一个旋转，对于 <span
class="math inline">\(\eta_{\mu\mu}\eta_{\nu\nu}=-1\)</span>
的情形，这就与洛伦兹群中的 boost 类似。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>之前刚刚计算过： <span class="math display">\[\begin{align*}
\begin{split}
e_\mu e_\nu e_\alpha =&amp;\;e_\mu (2\eta_{\nu\alpha}-e_\alpha
e_\nu)=2\eta_{\nu\alpha}e_\mu-e_\mu e_\alpha e_\nu\\
=&amp;\;2\eta_{\nu\alpha}e_\mu -(2\eta_{\mu\alpha}-e_\alpha
e_\mu)  e_\nu =2\eta_{\nu\alpha}e_\mu -2\eta_{\mu\alpha}e_\nu +e_\alpha
e_\mu  e_\nu.
\end{split}
\end{align*}\]</span> 所以： <span class="math display">\[\begin{align*}
\begin{split}
[e_\mu e_\nu/2,e_\alpha ]=\eta_{\nu\alpha}e_\mu -\eta_{\mu\alpha}e_\nu,
\end{split}
\end{align*}\]</span> 我们可以算出： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{e}^{-\mathrm{i} \theta
L_{\mu\nu}}e_\mu\mathrm{e}^{\mathrm{i}\theta
L_{\mu\nu}}=&amp;\;\mathrm{e}^{\theta e_\mu
e_\nu/2}e_\mu\mathrm{e}^{-\theta e_\mu
e_\nu/2}=e_\mu+\theta\left[\dfrac{e_\mu
e_\nu}{2},e_\mu\right]+\dfrac{\theta^2}{2!}\left[\dfrac{e_\mu
e_\nu}{2},\left[\dfrac{e_\mu e_\nu}{2},e_\mu\right]\right]+\cdots\\
=&amp;\;e_\mu+\theta(-\eta_{\mu\mu}e_\nu)+\dfrac{\theta^2}{2!}\left[\dfrac{e_\mu
e_\nu}{2},(-\eta_{\mu\mu}e_\nu)\right]+\dfrac{\theta^3}{3!}\left[\dfrac{e_\mu
e_\nu}{2},\left[\dfrac{e_\mu
e_\nu}{2},(-\eta_{\mu\mu}e_\nu)\right]\right]+\cdots\\
=&amp;\;e_\mu+\theta(-\eta_{\mu\mu}e_\nu)+\dfrac{\theta^2}{2!}(-\eta_{\mu\mu}\eta_{\nu\nu}e_\mu)+\dfrac{\theta^3}{3!}\left[\dfrac{e_\mu
e_\nu}{2},(-\eta_{\mu\mu}\eta_{\nu\nu}e_\mu)\right]+\cdots\\
=&amp;\;e_\mu+\theta(-\eta_{\mu\mu}e_\nu)+\dfrac{\theta^2}{2!}(-\eta_{\mu\mu}\eta_{\nu\nu}e_\mu)+\dfrac{\theta^3}{3!}(-\eta_{\mu\mu})^2\eta_{\nu\nu}e_\nu+\cdots\\
=&amp;\;e_\mu\cosh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right)+e_\nu\dfrac{-\eta_{\mu\mu}}{\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}}\sinh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right).
\end{split}
\end{align*}\]</span> 以及： <span class="math display">\[\begin{align*}
\begin{split}
\mathrm{e}^{-\mathrm{i} \theta
L_{\mu\nu}}e_\nu\mathrm{e}^{\mathrm{i}\theta
L_{\mu\nu}}=&amp;\;\mathrm{e}^{\theta e_\mu
e_\nu/2}e_\nu\mathrm{e}^{-\theta e_\mu
e_\nu/2}=e_\nu+\theta\left[\dfrac{e_\mu
e_\nu}{2},e_\nu\right]+\dfrac{\theta^2}{2!}\left[\dfrac{e_\mu
e_\nu}{2},\left[\dfrac{e_\mu e_\nu}{2},e_\nu\right]\right]+\cdots\\
=&amp;\;e_\nu+\theta(\eta_{\nu\nu}e_\mu)+\dfrac{\theta^2}{2!}\left[\dfrac{e_\mu
e_\nu}{2},(\eta_{\nu\nu}e_\mu)\right]+\dfrac{\theta^3}{3!}\left[\dfrac{e_\mu
e_\nu}{2},\left[\dfrac{e_\mu
e_\nu}{2},(\eta_{\nu\nu}e_\mu)\right]\right]+\cdots\\
=&amp;\;e_\nu+\theta(\eta_{\nu\nu}e_\mu)+\dfrac{\theta^2}{2!}(-\eta_{\mu\mu}\eta_{\nu\nu}e_\nu)+\dfrac{\theta^3}{3!}\left[\dfrac{e_\mu
e_\nu}{2},(-\eta_{\mu\mu}\eta_{\nu\nu}e_\nu)\right]+\cdots\\
=&amp;\;e_\nu+\theta(\eta_{\nu\nu}e_\mu)+\dfrac{\theta^2}{2!}(-\eta_{\mu\mu}\eta_{\nu\nu}e_\nu)+\dfrac{\theta^3}{3!}(-\eta_{\mu\mu})\eta_{\nu\nu}^2e_\mu+\cdots\\
=&amp;\;e_\nu\cosh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right)+e_\nu\dfrac{\eta_{\nu\nu}}{\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}}\sinh\left(\sqrt{-\eta_{\mu\mu}\eta_{\nu\nu}}\theta\right).
\end{split}
\end{align*}\]</span></p>

    </div>
</div>
<h2 id="clifford-代数的偶数子空间">Clifford 代数的偶数子空间</h2>
<p>到此为止，寻找 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span>
群的表示的问题就变成了寻找 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示的问题。</p>
<p>但是需要指出的是，<span
class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的不可约表示给出的 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span>
群的表示并不一定也是不可约的，因为 <span
class="math inline">\(\mathrm{Spin}_+(p,q)\)</span> 群中的群元只是偶数个
<span class="math inline">\(v_i\in\mathbb R^{p+q}\)</span> 的 Clifford
积。实际上，如果将 <span class="math inline">\(\mathrm{Cl}(p,q)\)</span>
中由偶数个 <span class="math inline">\(e_\mu\)</span> 的 Clifford
积构成的子空间记为 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>，那么就有：
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align}\label{Clifford even}
\mathrm{Cl}_{\text{even}}(p,q) \simeq \mathrm{Cl}(q,p-1) ,\quad
\mathrm{Cl}_{\text{even}}(p,q) \simeq \mathrm{Cl}(p,q-1).
\end{align}\]</span></p>
</blockquote></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>第一个式子：假如 <span class="math inline">\(e_{1\sim
p}^2=-e_{(p+1)\sim (p+q)}^2=1\)</span>，那么 <span
class="math display">\[e&#39;_{i}:= e_1e_{p+i}\;(i=1\sim q),\quad
e&#39;_{q+k}:= e_1e_{k}\;(k=2\sim p)\]</span> 将会构成 <span
class="math inline">\(\mathrm{Cl}(q,p-1)\)</span> 的基。</p>
<p>第二个式子：假如 <span class="math inline">\(e_{1\sim
p}^2=-e_{(p+1)\sim (p+q)}^2=1\)</span>，那么 <span
class="math display">\[e&#39;&#39;_{i}:= e_{p+1}e_{i}\;(i=1\sim p),\quad
e&#39;&#39;_{p+k}:= e_{p+1}e_{p+k}\;(k=2\sim q)\]</span> 将会构成 <span
class="math inline">\(\mathrm{Cl}(p,q-1)\)</span> 的基。</p>

    </div>
</div>
<hr />
<h1 id="gamma-矩阵与实-clifford-代数的表示"><span
class="math inline">\(\gamma\)</span> 矩阵与实 Clifford 代数的表示</h1>
<h2 id="表示的维数">表示的维数</h2>
<p>只要我们能够找到一系列 <span
class="math inline">\(\gamma_\mu\)</span> 矩阵使其满足 <span
class="math display">\[\begin{align*}
\gamma_\mu\gamma_\nu+\gamma_\nu\gamma_\mu=2\eta_{\mu\nu},\quad
\eta=\mathrm{diag}\{\underbrace{+1,+1,\cdots,+1}_{p},\underbrace{-1,-1,\cdots,-1}_{q}\}
\end{align*}\]</span> 并将 <span
class="math inline">\(\gamma_\mu\)</span> 视为 <span
class="math inline">\(e_\mu\)</span> 的表示矩阵，我们就能得到 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示。我们只考虑 <span
class="math inline">\(d:p+q\geqslant 2\)</span> 的情形。</p>
<p>不难想象： <span class="math display">\[\begin{align*}
\Gamma_{p,q}:= \{\pm1,\pm e_\mu,\pm e_\mu e_\nu,\pm e_\mu e_\nu
e_\rho,\cdots, \pm e_1 e_2\cdots e_{p+q}\},\quad
\mu&lt;\nu&lt;\rho&lt;\cdots
\end{align*}\]</span> 构成一个群，其群乘法就是 Clifford 积，群的阶数为
<span class="math inline">\(2^{d+1}\)</span>，<span
class="math inline">\(d=p+q\)</span>。找到这个群的表示就能得到 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示。</p>
<p>可以证明 <span class="math inline">\(\Gamma_{p,q}\)</span> 的高于
<span class="math inline">\(1\)</span> 维的不可约表示只可能是 <span
class="math inline">\(2^{\lfloor d/2\rfloor}\)</span> 维的：<span
class="math inline">\(d\)</span> 为偶数时仅有 <span
class="math inline">\(1\)</span> 种 <span
class="math inline">\(2^{\lfloor d/2\rfloor}\)</span> 维表示，<span
class="math inline">\(d\)</span> 为奇数时则有 2 种。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>(step-1)<span class="math inline">\(\quad\)</span>我们定义 <span
class="math inline">\(e_{d+1}\)</span>： <span
class="math display">\[\begin{align*}
e_{d+1}:= e_1 e_2\cdots e_{p+q}=e_1 e_2\cdots e_{d}.
\end{align*}\]</span></p>
<hr />
<p>(step-2)<span class="math inline">\(\quad\)</span>我们先确定 <span
class="math inline">\(\Gamma_{p,q}\)</span> 的共轭类。</p>
<p>从 <span class="math inline">\(\Gamma_{p,q}\)</span> 中任取一个不为
<span class="math inline">\(\pm1\)</span> 的群元 <span
class="math inline">\(a\)</span>，假设其是由 <span
class="math inline">\(n_a\)</span> 个 <span
class="math inline">\(e_\mu\)</span> 构成的。然后再任取一个 <span
class="math inline">\(b\)</span>，假设 <span
class="math inline">\(b\)</span> 由 <span
class="math inline">\(n_b\)</span> 个 <span
class="math inline">\(e_\mu\)</span> 构成，并且其中有 <span
class="math inline">\(s\)</span> 个与 <span
class="math inline">\(a\)</span> 重复，那么根据 <span
class="math inline">\(e_\mu e_\nu+e_\nu e_\mu=2\eta_{\mu\nu}\)</span>
不难算出： <span
class="math display">\[bab^{-1}=(-1)^{(n_b-s)n_a+s(n_a-1)}abb^{-1}=(-1)^{n_an_b-s}a.\]</span>
这里的 <span class="math inline">\((n_b-s)n_a\)</span> 来源于将 <span
class="math inline">\(b\)</span> 中不与 <span
class="math inline">\(a\)</span> 重复的 <span
class="math inline">\((n_b-s)\)</span> 个 <span
class="math inline">\(e_\mu\)</span> 移动到 <span
class="math inline">\(a\)</span> 的后面，<span
class="math inline">\(s(n_a-1)\)</span> 来源于将 <span
class="math inline">\(b\)</span> 中与 <span
class="math inline">\(a\)</span> 重复的 <span
class="math inline">\(s\)</span> 个 <span
class="math inline">\(e_\mu\)</span> 移动到 <span
class="math inline">\(a\)</span> 的后面。这一结果意味着 <span
class="math inline">\(a\)</span> 要么自成一类，要么与 <span
class="math inline">\(-a\)</span> 共成一类。</p>
<p><span class="math inline">\(n_a=d\)</span> 即 <span
class="math inline">\(a=e_{d+1}\)</span> 时，<span
class="math inline">\(n_b=s\)</span>，<span
class="math inline">\((-1)^{(d-1)s}=1\)</span>。因此 <span
class="math inline">\(d\)</span> 为奇数时 <span
class="math inline">\(e_{d+1}\)</span> 与 <span
class="math inline">\(-e_{d+1}\)</span>
各成一类，与所有群元都对易。<span class="math inline">\(d\)</span>
为偶数时，<span class="math inline">\((-1)^{(d-1)s}\)</span> 取决于
<span class="math inline">\(s\)</span> 即 <span
class="math inline">\(n_b\)</span> 的奇偶性，因此 <span
class="math inline">\(d\)</span> 为偶数时 <span
class="math inline">\(\{\pm e_{d+1}\}\)</span> 构成一个共轭类。</p>
<p>现在考虑 <span class="math inline">\(0&lt;n_a&lt;d\)</span>
的情况，此时我们总是可以找到一个不参与构成 <span
class="math inline">\(a\)</span> 的 <span
class="math inline">\(e_\alpha\)</span> 与一个参与构成 <span
class="math inline">\(a\)</span> 的 <span
class="math inline">\(e_\beta\)</span>。<span
class="math inline">\(n_a\)</span> 为奇数时，取 <span
class="math inline">\(b=e_\alpha\)</span> 就有 <span
class="math inline">\(b a b^{-1}=-a\)</span>，因此 <span
class="math inline">\(\{\pm a\}\)</span> 构成一个共轭类。<span
class="math inline">\(n_a\)</span> 为偶数时，取 <span
class="math inline">\(b=e_\beta\)</span> 就有 <span
class="math inline">\(b a b^{-1}=-a\)</span>，因此 <span
class="math inline">\(\{\pm a\}\)</span> 构成一个共轭类。所以只要 <span
class="math inline">\(0&lt;n_a&lt;d\)</span>，<span
class="math inline">\(\{\pm a\}\)</span> 就构成一个共轭类。</p>
<hr />
<p>(step-3)<span class="math inline">\(\quad\)</span>然后我们先考虑
<span class="math inline">\(\Gamma_{p,q}\)</span> 的一维表示。</p>
<p>最简单的一维表示就是： <span class="math display">\[\begin{align*}
\pm1\rightarrow1,\quad \pm e_{1\sim d}\rightarrow1.
\end{align*}\]</span> 注意，<span class="math inline">\(e_\mu\)</span>
与 <span class="math inline">\(-e_\mu\)</span>
同属一个共轭类进而特征标相同，而它们的特征标又不是 <span
class="math inline">\(0\)</span>，这导致 <span
class="math inline">\(-1\)</span> 的表示只能为 <span
class="math inline">\(1\)</span>。由于 <span
class="math inline">\(\pm1\)</span> 的表示都为 <span
class="math inline">\(1\)</span>，而 <span
class="math inline">\(e_\mu^2=\pm1\)</span>，所以 <span
class="math inline">\(e_\mu\)</span> 的表示只能为 <span
class="math inline">\(\pm1\)</span> 不能为 <span
class="math inline">\(\pm\mathrm{i}\)</span>。其余的一维表示可通过将某些
<span class="math inline">\(\pm e_\mu\)</span> 的表示设为 <span
class="math inline">\(-1\)</span> 来得到。这样的 <span
class="math inline">\(1\)</span> 维表示共有 <span
class="math inline">\(2^d\)</span> 个。</p>
<hr />
<p>(step-4)<span
class="math inline">\(\quad\)</span>然后我们确定高于一维的表示的维数。</p>
<p>我们知道，群论中有如下定理：有限群不等价不可约表示的个数等于其共轭类的个数，不等价不可约表示的维数的平方和等于群的阶数。</p>
<p>对于 <span class="math inline">\(d\)</span> 为偶数的情形，<span
class="math inline">\(\Gamma_{p,q}\)</span> 共有 <span
class="math inline">\(2^{d}+1\)</span> 个共轭类（注意 <span
class="math inline">\(\pm1\)</span> 是两个共轭类），因此有 <span
class="math inline">\(2^{d}+1\)</span> 个不等价不可约表示，<span
class="math inline">\(1\)</span> 维表示占了其中 <span
class="math inline">\(2^d\)</span> 个，因此高于 <span
class="math inline">\(1\)</span> 维的表示只有一个，其维数为 <span
class="math inline">\(\sqrt{2^{d+1}-2^d}=2^{d/2}\)</span>。</p>
<p>对于 <span class="math inline">\(d\)</span> 为奇数的情形，<span
class="math inline">\(\Gamma_{p,q}\)</span> 共有 <span
class="math inline">\(2^{d}+2\)</span> 个共轭类（注意 <span
class="math inline">\(\pm1\)</span> 与 <span class="math inline">\(\pm
e_{d+1}\)</span> 是四个共轭类），因此有 <span
class="math inline">\(2^{d}+2\)</span> 个不等价不可约表示，<span
class="math inline">\(1\)</span> 维表示占了其中 <span
class="math inline">\(2^d\)</span> 个，因此高于 <span
class="math inline">\(1\)</span> 维的表示有 <span
class="math inline">\(2\)</span> 个。这两个表示的维数的平方和为 <span
class="math inline">\(2^{d+1}-2^d=2^d\)</span>，而 <span
class="math inline">\(d\geqslant2\)</span> 时 <span
class="math inline">\(a^2+b^2=2^d\)</span> 的整数解只有 <span
class="math inline">\(a=b=2^{(d-1)/2}\)</span>（证明放在下面）。</p>
<p>综合以上两种情形，<span class="math inline">\(\Gamma_{p,q}\)</span>
的高于 <span class="math inline">\(1\)</span>
维的不等价不可约表示的维数只可能是 <span
class="math inline">\(2^{\lfloor d/2\rfloor}\)</span>。</p>
<hr />
<p><span class="math inline">\(a^2+b^2=2^d\)</span> 的整数解只有 <span
class="math inline">\(a=b=2^{(d-1)/2}\)</span> 的证明：</p>
<p><span class="math inline">\(d=0\)</span> 时，<span
class="math inline">\(a^2+b^2=2^d\)</span>
的非负整数解只有两种可能：<span
class="math inline">\(a=0\)</span>、<span
class="math inline">\(b=1\)</span> 或 <span
class="math inline">\(a=1\)</span>、<span
class="math inline">\(b=0\)</span>。</p>
<p><span class="math inline">\(d=1\)</span> 时，仅有的可能是 <span
class="math inline">\(a=b=1\)</span>。</p>
<p>然后我们考虑 <span class="math inline">\(d\geqslant2\)</span>
的情况。 <span class="math inline">\(d\geqslant2\)</span> 时，<span
class="math inline">\(a\)</span> 与 <span
class="math inline">\(b\)</span> 奇偶性相同。</p>
<p>先用反证法排除 <span class="math inline">\(a\)</span> 与 <span
class="math inline">\(b\)</span> 都是奇数的情形：假设 <span
class="math inline">\(a=2m+1\)</span>，<span
class="math inline">\(b=2n+1\)</span>，那么 <span
class="math display">\[a^2+b^2=4(m^2+n^2+m+n)+2,\]</span> 这意味着 <span
class="math inline">\(2(m^2+n^2+m+n)+1=2^{d-1}\)</span>，左右两边的奇偶性就会不同，不可能有解，因此
<span class="math inline">\(a\)</span> 与 <span
class="math inline">\(b\)</span> 必须都是偶数。</p>
<p>假设 <span class="math inline">\(a=m_a\times 2^{n_a}\)</span>，<span
class="math inline">\(b=m_b\times 2^{n_b}\)</span>，<span
class="math inline">\(m_a\)</span> 与 <span
class="math inline">\(m_b\)</span> 为奇数。假设 <span
class="math inline">\(n_a\leqslant n_b\)</span>，那么 <span
class="math inline">\(a^2+b^2=2^d\)</span> 意味着 <span
class="math display">\[m_a^2+(m_b\times
2^{n_b-n_a})^2=2^{d-2n_a}.\]</span> 如果 <span
class="math inline">\(n_b\neq
n_a\)</span>，那么两边奇偶性不一致，所以只可能是 <span
class="math inline">\(n_a=n_b\)</span>。这意味着 <span
class="math inline">\(m_a^2+m_b^2=2^{d-2n_a}\)</span>，唯一的可能性是
<span class="math inline">\(d-2n_a=1\)</span> 且 <span
class="math inline">\(m_a=m_b=1\)</span>。</p>
<p>因此 <span class="math inline">\(a^2+b^2=2^d\)</span> 的正整数解只有
<span class="math inline">\(a=b=2^{(d-1)/2}\)</span>。</p>

    </div>
</div>
<h2 id="具体的表示">具体的表示</h2>
<p>对于 <span class="math inline">\(d\)</span>
为偶数的情形，我们可以写出如下 <span
class="math inline">\(2^{d/2}\)</span>
维表示——许多结论可从这组表示中得到： <span
class="math display">\[\begin{align}
\begin{split}
\gamma_1=&amp;\;\varepsilon_1\sigma^x\otimes I\otimes I\otimes I\otimes
\cdots\\
\gamma_2=&amp;\;\varepsilon_2\sigma^y\otimes I\otimes I\otimes I\otimes
\cdots\\
\gamma_3=&amp;\;\varepsilon_3\sigma^z\otimes\sigma^x\otimes I\otimes
I\otimes \cdots\\
\gamma_4=&amp;\;\varepsilon_4\sigma^z\otimes\sigma^y\otimes I\otimes
I\otimes \cdots\\
\gamma_5=&amp;\;\varepsilon_5\sigma^z\otimes\sigma^z\otimes\sigma^x\otimes
I\otimes\cdots\\
\gamma_6=&amp;\;\varepsilon_6\sigma^z\otimes\sigma^z\otimes\sigma^y\otimes
I\otimes\cdots\\
\vdots\;&amp;
\end{split}
\label{even_Clifford_repr}\end{align}\]</span> 其中 <span
class="math inline">\(I\)</span> 为 <span
class="math inline">\(2\times2\)</span> 单位矩阵。每一个 <span
class="math inline">\(\gamma\)</span> 矩阵都由 <span
class="math inline">\(d/2\)</span> 个 <span
class="math inline">\(2\)</span> 维矩阵直积得来，因此这是一个 <span
class="math inline">\(2^{d/2}\)</span> 维表示。每一个 <span
class="math inline">\(\gamma\)</span> 矩阵前面的系数用于确保 <span
class="math inline">\(\gamma_\mu^2=+1\)</span> 或 <span
class="math inline">\(-1\)</span>。利用泡利矩阵的反对易性不难验证不同的
<span class="math inline">\(\gamma_\mu\)</span>
之间都是反对易的，因此它们的确能够构成偶数维实 Clifford
代数的复表示。</p>
<p>还是对于 <span class="math inline">\(d\)</span>
为偶数的情形，假如已知一个 <span class="math inline">\((d-1)\)</span>
维时的表示： <span class="math display">\[\begin{align*}
\tilde\gamma_1,\tilde\gamma_2,\cdots,\tilde\gamma_{d-1},
\end{align*}\]</span> 其中每一个 <span
class="math inline">\(\tilde\gamma\)</span> 都是 <span
class="math inline">\(2^{(d-2)/2}\)</span> 维矩阵，那么 <span
class="math inline">\(d\)</span> 维情形的一种表示就是： <span
class="math display">\[\begin{align}
\begin{split}
\gamma_i&amp;=\varepsilon_i\sigma^x\otimes\tilde\gamma_i=\begin{bmatrix}0&amp;\tilde\gamma_i\\
\tilde\gamma_i&amp;0\end{bmatrix},\quad i=1\sim(d-1),\\
\gamma_d&amp;=\varepsilon_d\begin{bmatrix}0&amp;I_{2^{(d-2)/2}\times2^{(d-2)/2}}\\-I_{2^{(d-2)/2}\times2^{(d-2)/2}}&amp;0\end{bmatrix}.
\end{split}
\label{odd_d_to_d+1_method1}\end{align}\]</span> 另一种表示是： <span
class="math display">\[\begin{align}
\begin{split}
\gamma_i&amp;=\varepsilon_i\sigma^x\otimes\tilde\gamma_i=\begin{bmatrix}0&amp;\tilde\gamma_i\\
\tilde\gamma_i&amp;0\end{bmatrix},\quad i=1\sim(d-1),\\
\gamma_d&amp;=\varepsilon_d\begin{bmatrix}I_{2^{(d-2)/2}\times2^{(d-2)/2}}&amp;0\\0&amp;-I_{2^{(d-2)/2}\times2^{(d-2)/2}}\end{bmatrix}.
\end{split}
\label{odd_d_to_d+1_method2}\end{align}\]</span></p>
<p>对于 <span class="math inline">\(d\)</span>
为奇数的情形，假如我们能够找到 <span
class="math inline">\((d-1)\)</span> 维 Clifford 代数的表示，即找到
<span class="math inline">\(2^{(d-1)/2}\)</span> 个 <span
class="math inline">\(\gamma\)</span> 矩阵 <span
class="math inline">\(\gamma_{1\sim (d-1)}\)</span> 使其平方为 <span
class="math inline">\(\pm1\)</span> 且互相之间反对易，那么我们可以选取：
<span class="math display">\[\begin{align}
\gamma_d=\pm\varepsilon_d\gamma_1\gamma_2\cdots\gamma_{d-1}.
\label{gamma_d_from_gamma_1tod-1}\end{align}\]</span> 不难验证，<span
class="math inline">\(\gamma_d\)</span> 的确与 <span
class="math inline">\(\gamma_{1\sim(d-1)}\)</span>
的每一个都反对易且平方为 <span
class="math inline">\(\pm1\)</span>，因而能够与 <span
class="math inline">\(\gamma_{1\sim(d-1)}\)</span> 一起构成 Clifford
代数的表示。可以证明，(<span
class="math inline">\(\ref{gamma_d_from_gamma_1tod-1}\)</span>)
给出的两种 <span class="math inline">\(\gamma_d\)</span> 正好对应于此时
Clifford 代数仅有的两个不等价不可约表示。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明（Clifford 代数表示的特征标）
    </div>
    <div class='spoiler-content'>
        <p>对于 <span class="math inline">\(d:= p+q\)</span>
为偶数的情形，不难想象所有的一维表示的特征标都满足正交关系：假设某个
<span class="math inline">\(1\)</span> 维表示 <span
class="math inline">\(\chi_1\)</span> 将 <span class="math inline">\(\pm
e_\mu\)</span> 的表示设为 <span
class="math inline">\(a_\mu\)</span>，另一个表示 <span
class="math inline">\(\chi_2\)</span> 将 <span class="math inline">\(\pm
e_\mu\)</span> 的表示设为 <span class="math inline">\(b_\mu\)</span>
(<span class="math inline">\(a_\mu\)</span> 与 <span
class="math inline">\(b_\mu\)</span> 的取值范围都为 <span
class="math inline">\(\pm1\)</span>)，那么： <span
class="math display">\[\sum_{g\in\Gamma_{p,q}}[\chi_1(g)]^\ast\chi_2(g)=\prod_{\mu=1}^d(1+a_\mu
b_\mu).\]</span> 只要这两个表示不相同，就至少存在一个 <span
class="math inline">\(\mu\)</span> 使得 <span
class="math inline">\(a_\mu
b_\mu=-1\)</span>，导致这两个表示的特征标正交。</p>
<p>然后我们考虑 (<span
class="math inline">\(\ref{even_Clifford_repr}\)</span>)
式给出的不可约表示 <span class="math inline">\(\chi_0\)</span>。由于
<span class="math inline">\(\mathrm{tr}(a\otimes
b)=\mathrm{tr}(a)\mathrm{tr}(b)\)</span>，而 <span
class="math inline">\(\mathrm{tr}(\sigma^{x,y,z})=0\)</span>，所以所有
<span class="math inline">\(\mathrm{tr}(\gamma_\mu)=0\)</span>，因此：
<span class="math display">\[\chi_0(1)=2^{d/2},\quad
\chi_0(-1)=-2^{d/2},\quad \text{其余：}0.\]</span> 由于所有 <span
class="math inline">\(1\)</span> 维表示都给出 <span
class="math inline">\(\chi(\pm1)=1\)</span>，所以它也与所有 <span
class="math inline">\(1\)</span> 维表示正交。</p>
<hr />
<p>对于 <span class="math inline">\(d:= p+q\)</span>
为奇数的情形，一维表示彼此之间也是互相正交的。对于 <span
class="math inline">\(&gt;1\)</span> 维的表示，我们先为 <span
class="math inline">\(e_{1\sim(d-1)}\)</span> 构成的 Clifford
代数找到一组表示，将表示矩阵记为 <span
class="math inline">\(\gamma_{1\sim(d-1)}\)</span>。然后我们考虑 <span
class="math display">\[e_{d+1}:= e_1e_2\cdots e_d.\]</span> 它与所有
<span class="math inline">\(e_{1\sim(d-1)}\)</span> 都对易，因此在 <span
class="math inline">\(e_{1\sim(d-1)}\)</span> 构成的 Clifford
代数的表示中，<span class="math inline">\(\gamma_{d+1}\)</span>
一定是一个常数矩阵： <span
class="math display">\[\gamma_{d+1}=aI.\]</span> <span
class="math inline">\(a\)</span> 的取值可从 <span
class="math inline">\(e_{d+1}^2=\pm1\)</span> 得到：<span
class="math inline">\(e_{d+1}^2=1\)</span> 时 <span
class="math inline">\(a=\pm1\)</span>，而 <span
class="math inline">\(e_{d+1}^2=-1\)</span> 时 <span
class="math inline">\(a=\pm\mathrm{i}\)</span>，因此 <span
class="math inline">\(\gamma_{d+1}\)</span>
总是有两种取法，对应两个表示——这两个表示中 <span
class="math inline">\(\pm\gamma_{d+1}\)</span>
的特征标相反，因此互不等价。在确定 <span
class="math inline">\(\gamma_{d+1}\)</span> 的形式后，结合 <span
class="math inline">\(\gamma_{d+1}=\gamma_1\gamma_2\cdots\gamma_d\)</span>
可以算出： <span class="math display">\[\gamma_d =
\pm\varepsilon_d\gamma_1\gamma_2\cdots\gamma_{d-1}.\]</span>
这样一来，我们就得到了 <span class="math inline">\(d:= p+q\)</span>
为奇数时的两个表示。</p>
<p>从 (<span class="math inline">\(\ref{even_Clifford_repr}\)</span>)
式给出的表示可以看到，<span class="math inline">\(\gamma_d\)</span>
将是一系列 <span class="math inline">\(\sigma^z\)</span> 的直积，因此
<span
class="math inline">\(\mathrm{tr}(\gamma_d)=0\)</span>。所以，在这两组表示中，只有
<span class="math inline">\(\pm1\)</span> 与 <span
class="math inline">\(\pm e_{d+1}\)</span> 这四个共轭类的特征标非零：
<span class="math display">\[\begin{align*}
\begin{array}{c|ccccc}
                            &amp;\chi(1)&amp;\chi(-1)&amp;\chi(e_{d+1})&amp;\chi(-e_{d+1})&amp;\text{其它}\\
\hline
1\;\text{维表示}            &amp;1&amp;1&amp;x&amp;x&amp;\text{略}\\
2^{(d-1)/2}\;\text{维表示 1}&amp;2^{(d-1)/2}&amp;-2^{(d-1)/2}&amp;a\cdot
2^{(d-1)/2}&amp;-a\cdot 2^{(d-1)/2}&amp;0\\
2^{(d-1)/2}\;\text{维表示
2}&amp;2^{(d-1)/2}&amp;-2^{(d-1)/2}&amp;-a\cdot 2^{(d-1)/2}&amp;a\cdot
2^{(d-1)/2}&amp;0
\end{array}
\end{align*}\]</span> 这也符合特征标的正交关系。</p>

    </div>
</div>
<h2 id="实表示的可能性">实表示的可能性</h2>
<p>以上得到的表示矩阵都是复表示，即表示矩阵都是复矩阵。现在我们来寻找实表示，即表示矩阵都是实数的表示。在
(<span class="math inline">\(\ref{even_Clifford_repr}\)</span>)
式中，虚数单位 <span class="math inline">\(\mathrm{i}\)</span> 出现在
<span class="math inline">\(\sigma^y\)</span> 与 <span
class="math inline">\(\varepsilon_i\)</span>
上，因此，以下矩阵可以构成一组实表示： <span
class="math display">\[\begin{align*}
\begin{split}
\gamma_1=&amp;\;\sigma^x\otimes I\otimes I\otimes I\otimes \cdots\\
\gamma_2=&amp;\;\mathrm{i}\sigma^y\otimes I\otimes I\otimes I\otimes
\cdots\\
\gamma_3=&amp;\;\sigma^z\otimes\sigma^x\otimes I\otimes I\otimes
\cdots\\
\gamma_4=&amp;\;\sigma^z\otimes\mathrm{i}\sigma^y\otimes I\otimes
I\otimes \cdots\\
\gamma_5=&amp;\;\sigma^z\otimes\sigma^z\otimes\sigma^x\otimes
I\otimes\cdots\\
\gamma_6=&amp;\;\sigma^z\otimes\sigma^z\otimes\mathrm{i}\sigma^y\otimes
I\otimes\cdots\\
\vdots\;&amp;
\end{split}
\end{align*}\]</span> 它们是 <span
class="math inline">\(\mathrm{Cl}(n,n)\)</span> 的表示，因此 <span
class="math inline">\(\mathrm{Cl}(n,n)\)</span>
的不可约复表示同时也是实表示。</p>
<p>不难验证，这组 <span class="math inline">\(\gamma_\mu\)</span> 给出的
<span class="math inline">\(\gamma_{2n+1}:=
\gamma_1\gamma_2\cdots\gamma_{2n}\)</span> 满足 <span
class="math inline">\(\gamma_{2n+1}^2=(-1)^{n+n(2n-1)}=1\)</span>，因此这里的
<span class="math inline">\(\gamma_{1\sim (2n+1)}\)</span> 构成 <span
class="math inline">\(\mathrm{Cl}(n+1,n)\)</span>
的表示，它也是实表示。</p>
<p>然后从 (<span
class="math inline">\(\ref{odd_d_to_d+1_method1}\)</span>) 或 (<span
class="math inline">\(\ref{odd_d_to_d+1_method2}\)</span>)
出发，我们也能构造出 <span
class="math inline">\(\mathrm{Cl}(n+2,n)\)</span> 的实表示。</p>
<p>但是，从 <span class="math inline">\(\mathrm{Cl}(n+2,n)\)</span>
的实表示出发，我们不能通过类似的方法构造 <span
class="math inline">\(\mathrm{Cl}(n+3,n)\)</span>
的实表示。实际上，数学上可以证明只有 <span
class="math inline">\(\mathrm{Cl}(n,n)\)</span>、<span
class="math inline">\(\mathrm{Cl}(n+1,n)\)</span>、<span
class="math inline">\(\mathrm{Cl}(n+2,n)\)</span> 的 <span
class="math inline">\(2^{\lfloor d/2\rfloor}\)</span>
维不可约表示是实表示。</p>
<hr />
<h1 id="实-clifford-代数的分类">实 Clifford 代数的分类</h1>
<p>上一节已经给出了如何构建 Clifford
代数的表示。这一小节我们更加仔细地观察 Clifford
代数，并给出其更具体的表示。我们用 <span
class="math inline">\(M_{N}(\mathbb K)\)</span> 表示矩阵元在 <span
class="math inline">\(\mathbb K\)</span> 中取值的 <span
class="math inline">\(N\times N\)</span> 矩阵。</p>
<p>几个低维的 Clifford 代数是： <span
class="math display">\[\begin{align}\label{Cl_d=0,1}
\begin{array}{lll}
\mathrm{Cl}(0,0)=\mathbb R,\quad &amp;\mathrm{Cl}(1,0)=\mathbb
R\oplus\mathbb R,\quad &amp;\mathrm{Cl}(0,1)=\mathbb C.
\end{array}
\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>首先，我们考虑的是实数域上的 Clifford 代数所以 <span
class="math inline">\(\mathrm{Cl}(0,0)=\mathbb R\)</span>。</p>
<p>对于 <span
class="math inline">\(\mathrm{Cl}(1,0)\)</span>，我们可以从中挑出一个
<span class="math inline">\(e\)</span> 使得 <span
class="math inline">\(e^2=1\)</span> 且 <span
class="math inline">\(e\neq 1\)</span>，那么 <span
class="math inline">\(\mathrm{Cl}(1,0)\)</span> 中的任何一个元素都可写为
<span class="math inline">\(x(1+e)/2+y(1-e)/2\)</span> 的形式，考虑到
<span class="math inline">\(P_\pm:= (1\pm e)/2\)</span>
实际上是两个投影算符，所以 <span
class="math inline">\(\mathrm{Cl}(1,0)\)</span> 自然地就等同于 <span
class="math inline">\(\mathbb R\oplus\mathbb R\)</span>。</p>
<p>最后，对于 <span
class="math inline">\(\mathrm{Cl}(0,1)\)</span>，我们注意到虚数单位
<span class="math inline">\(\mathrm{i}\)</span> 自然地满足 <span
class="math inline">\(\mathrm{i}^2=-1\)</span>，因此 <span
class="math inline">\(\mathrm{Cl}(0,1)=\mathbb C\)</span>。</p>

    </div>
</div>
<p>然后 <span class="math inline">\(2\)</span> 维情形的结果是： <span
class="math display">\[\begin{align}\label{Cl, d=2}
\mathrm{Cl}(2,0)=\mathrm{Cl}(1,1)=M_{2}(\mathbb R),\quad
\mathrm{Cl}(0,2)=\mathbb H.
\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(\sigma^x\)</span>、<span
class="math inline">\(\sigma^z\)</span>、<span
class="math inline">\(\mathrm{i}\sigma^y\)</span> 与 <span
class="math inline">\(I_{2\times2}\)</span> 构成了 <span
class="math inline">\(M_{2}(\mathbb R)\)</span> 的一组基。</p>
<p>对于 <span
class="math inline">\(\mathrm{Cl}(2,0)\)</span>，我们可以选择 <span
class="math inline">\(\gamma_1=\sigma^z\)</span>，<span
class="math inline">\(\gamma_2=\sigma^x\)</span>。</p>
<p>对于 <span
class="math inline">\(\mathrm{Cl}(1,1)\)</span>，我们可以选择 <span
class="math inline">\(\gamma_1=\sigma^x\)</span>，<span
class="math inline">\(\gamma_2=\mathrm{i}\sigma^y\)</span>，这样就证明了
<span
class="math inline">\(\mathrm{Cl}(2,0)=\mathrm{Cl}(1,1)=M_{2}(\mathbb
R)\)</span>。</p>
<p>对于 <span class="math inline">\(\mathrm{Cl}(0,2)\)</span>，<span
class="math inline">\(\gamma_1\)</span>、<span
class="math inline">\(\gamma_2\)</span> 以及 <span
class="math inline">\(\gamma_1\gamma_2\)</span> 可以起到四元数中 <span
class="math inline">\(\mathrm{i,j,k}\)</span> 的作用，所以 <span
class="math inline">\(\mathrm{Cl}(0,2)=\mathbb
H\)</span>。更具体地，我们可以选择 <span
class="math inline">\(\gamma_1=-\mathrm{i}\sigma^x\)</span>，<span
class="math inline">\(\gamma_2=-\mathrm{i}\sigma^y\)</span>，这是因为，<span
class="math inline">\(-\mathrm{i}\sigma^{x,y,z}\)</span>
可以起到四元数中 <span class="math inline">\(\mathrm{i,j,k}\)</span>
的作用。</p>

    </div>
</div>
<p>然后我们高维的 Clifford 代数可从低维 Clifford 代数直积得到： <span
class="math display">\[\begin{align}\label{Cl relation}
\begin{split}
\mathrm{Cl}(p,q)\otimes\mathrm{Cl}(2,0)&amp;\simeq\mathrm{Cl}(q+2,p),\\
\mathrm{Cl}(p,q)\otimes\mathrm{Cl}(0,2)&amp;\simeq\mathrm{Cl}(q,p+2),\\
\mathrm{Cl}(p,q)\otimes\mathrm{Cl}(1,1)&amp;\simeq\mathrm{Cl}(p+1,q+1).
\end{split}
\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>假设 <span class="math inline">\(\gamma_{1\sim(p+q)}\)</span> 构成
<span class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示，<span
class="math inline">\(\gamma&#39;_{1,2}\)</span> 构成 <span
class="math inline">\(\mathrm{Cl}(2,0)\)</span> 或 <span
class="math inline">\(\mathrm{Cl}(0,2)\)</span> 或 <span
class="math inline">\(\mathrm{Cl}(1,1)\)</span> 的表示，那么考虑 <span
class="math inline">\(\{\gamma_{1\sim(p+q)}\otimes\gamma_1&#39;\gamma_2&#39;,1\otimes\gamma_1&#39;,1\otimes\gamma_2&#39;\}\)</span>，不难验证这组矩阵可以构成等号右侧的
Clifford 代数的表示。</p>

    </div>
</div>
<p>这样一来，假如 <span class="math inline">\(s&gt;t\)</span>，那么利用
<span class="math inline">\(M_m(\mathbb R)\otimes M_n(\mathbb R)\simeq
M_{mn}(\mathbb R)\)</span> 可以发现： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(s,t)&amp;\simeq
\mathrm{Cl}(s-t,0)\otimes\underbrace{\mathrm{Cl}(1,1)\otimes\mathrm{Cl}(1,1)\otimes\cdots\otimes\mathrm{Cl}(1,1)}_{t\text{个}}\simeq
\mathrm{Cl}(s-t,0)\otimes M_{2^t}(\mathbb R),\\
\mathrm{Cl}(t,s)&amp;\simeq
\mathrm{Cl}(0,s-t)\otimes\underbrace{\mathrm{Cl}(1,1)\otimes\mathrm{Cl}(1,1)\otimes\cdots\otimes\mathrm{Cl}(1,1)}_{t\text{个}}\simeq
\mathrm{Cl}(0,s-t)\otimes M_{2^t}(\mathbb R).
\end{split}
\end{align*}\]</span> 以及： <span class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(d,0)&amp;\simeq\mathrm{Cl}(d-4,0)\otimes\mathrm{Cl}(4,0)\simeq\mathrm{Cl}(d-8,0)\otimes\mathrm{Cl}(8,0),\\
\mathrm{Cl}(0,d)&amp;\simeq\mathrm{Cl}(0,d-4)\otimes\mathrm{Cl}(0,4)\simeq\mathrm{Cl}(0,d-8)\otimes\mathrm{Cl}(0,8).
\end{split}
\end{align*}\]</span></p>
<p>利用 <span class="math inline">\(M_m(\mathbb R)\otimes\mathbb K\simeq
\mathbb K\otimes M_m(\mathbb R)\simeq M_m(\mathbb K)\)</span> 可以算出：
<span class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(4,0)&amp;\simeq \mathrm{Cl}(0,2)\otimes
\mathrm{Cl}(2,0)\simeq \mathbb H\otimes M_2(\mathbb R)\simeq M_2(\mathbb
H),\\
\mathrm{Cl}(0,4)&amp;\simeq \mathrm{Cl}(2,0)\otimes
\mathrm{Cl}(0,2)\simeq M_2(\mathbb R)\otimes \mathbb H \simeq
M_2(\mathbb H).
\end{split}
\end{align*}\]</span> 可以证明： <span class="math display">\[\mathbb
H\otimes\mathbb H\simeq M_4(\mathbb R),\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>可以考虑四元数之间的映射 <span
class="math inline">\(f_{q_1,q_2}\)</span>： <span
class="math display">\[f_{q_1,q_2}(x)=q_1xq_2^{\dagger}.\]</span> 其中
<span class="math inline">\(\bar q_2\)</span> 意为：如果 <span
class="math inline">\(q=a+b\mathrm i+c\mathrm j+d\mathrm k\)</span> 那么
<span class="math inline">\(q^\dagger=a-b\mathrm i-c\mathrm j-d\mathrm
k\)</span>。如果用（<span class="math inline">\(-\mathrm{i}\)</span>
乘以） 泡利矩阵将 <span class="math inline">\(\mathrm{ijk}\)</span>
表示出来的话，<span class="math inline">\(\dagger\)</span>
就是对矩阵做共轭转置，因此 <span class="math inline">\((ab)^\dagger
=b^\dagger a^\dagger\)</span>。</p>
<p>显然 <span class="math inline">\(f_{q_1,q_2}\)</span> 构成 <span
class="math inline">\(\mathbb H\)</span> 的一个自同态，并且有 <span
class="math inline">\(f_{p_1,p_2}f_{q_1,q_2}=f_{p_1q_1,p_2q_2}\)</span>，因此
<span class="math inline">\(f_{q_1,q_2}\)</span> 构成的集合与 <span
class="math inline">\(\mathbb H\otimes\mathbb H\)</span> 同构。由于
<span class="math inline">\(\mathbb H\otimes\mathbb H\)</span> 是 <span
class="math inline">\(16\)</span> 维实线性空间，因此 <span
class="math inline">\(f_{q_1,q_2}\)</span> 构成的集合也是 <span
class="math inline">\(16\)</span> 维实线性空间。由于四元数可视为 <span
class="math inline">\(4\)</span>
维实线性空间，所以四元数的全体自同态就等同于 <span
class="math inline">\(M_{4}(\mathbb R)\)</span>，它也是 <span
class="math inline">\(16\)</span> 维实线性空间，因此 <span
class="math inline">\(f_{q_1,q_2}\)</span> 构成的集合等同于 <span
class="math inline">\(M_{4}(\mathbb R)\)</span>，这也就意味着 <span
class="math display">\[\mathbb H\otimes \mathbb H\simeq M_{4}(\mathbb
R).\]</span></p>

    </div>
</div>
<p>然后就可以算出： <span class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(8,0)&amp;\simeq \mathrm{Cl}(4,0)\otimes
\mathrm{Cl}(4,0)\simeq M_{16}(\mathbb R),\\
\mathrm{Cl}(0,8)&amp;\simeq \mathrm{Cl}(0,4)\otimes
\mathrm{Cl}(0,4)\simeq M_{16}(\mathbb R).
\end{split}
\end{align*}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
\begin{split}
M_2(\mathbb H)\otimes M_2(\mathbb H)&amp;\simeq M_2(\mathbb
R)\otimes\mathbb H\otimes\mathbb H\otimes M_2(\mathbb R)\\
&amp;\simeq M_2(\mathbb R)\otimes M_4(\mathbb R)\otimes M_2(\mathbb
R)\simeq M_{16}(\mathbb R).
\end{split}
\end{align*}\]</span></p>

    </div>
</div>
<p>因此，对于 <span class="math inline">\(\mathrm{Cl}(d,0)\)</span> 与
<span class="math inline">\(\mathrm{Cl}(0,d)\)</span>，我们只需要考虑
<span class="math inline">\(d=1\sim7\)</span> 的情况就足够了，它们可通过
(<span class="math inline">\(\ref{Cl_d=0,1}\)</span>, <span
class="math inline">\(\ref{Cl, d=2}\)</span>, <span
class="math inline">\(\ref{Cl relation}\)</span>) 三式来计算。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>首先 是 <span class="math inline">\(d=3\)</span>： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(3,0)&amp;\simeq\mathrm{Cl}(0,1)\otimes\mathrm{Cl}(2,0)\simeq
\mathbb C\otimes M_2(\mathbb R)\simeq M_2(\mathbb C),\\
\mathrm{Cl}(0,3)&amp;\simeq\mathrm{Cl}(1,0)\otimes\mathrm{Cl}(0,2)\simeq
(\mathbb R\oplus\mathbb R)\otimes \mathbb H\simeq \mathbb H\oplus\mathbb
H.
\end{split}
\end{align*}\]</span></p>
<hr />
<p>先证明一个小结论： <span class="math display">\[\mathbb C\otimes
\mathbb H\simeq M_{2}(\mathbb C).\]</span> <span
class="math inline">\(\mathbb C\)</span> 作为实线性空间时，它的一组基是
<span class="math inline">\(\{0,\mathrm{i}\}\)</span>，<span
class="math inline">\(\mathbb H\)</span> 作为实线性空间时，它的一组基是
<span
class="math inline">\(\{I,-\mathrm{i}\sigma^x,-\mathrm{i}\sigma^y,-\mathrm{i}\sigma^z\}\)</span>。直积之后就能得到
<span class="math inline">\(8\)</span> 个线性无关的矩阵，构成 <span
class="math inline">\(M_{2}(\mathbb C)\)</span> 的基。</p>
<p>再结合 <span class="math inline">\(\mathbb H\otimes \mathbb H\simeq
M_{4}(\mathbb R)\)</span> 我们可以证明： <span
class="math display">\[M_2(\mathbb C)\otimes\mathbb H\simeq M_2(\mathbb
R)\otimes\mathbb C\otimes\mathbb H\simeq M_2(\mathbb R)\otimes
M_2(\mathbb C)\simeq M_4(\mathbb C).\]</span></p>
<p>于是就可算出 <span class="math inline">\(d=5\)</span> 时： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(5,0)&amp;\simeq\mathrm{Cl}(0,3)\otimes\mathrm{Cl}(2,0)\simeq
(\mathbb H\oplus\mathbb H)\otimes M_2(\mathbb R)\simeq M_2(\mathbb
H)\oplus M_2(\mathbb H),\\
\mathrm{Cl}(0,5)&amp;\simeq\mathrm{Cl}(3,0)\otimes\mathrm{Cl}(0,2)\simeq
M_2(\mathbb C)\otimes \mathbb H\simeq M_4(\mathbb C).
\end{split}
\end{align*}\]</span></p>
<hr />
<p>利用 <span class="math inline">\(\mathbb H\otimes \mathbb H\simeq
M_{4}(\mathbb R)\)</span> 可以证明 <span
class="math inline">\(d=6\)</span>： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(6,0)&amp;\simeq\mathrm{Cl}(0,4)\otimes\mathrm{Cl}(2,0)\simeq
M_2(\mathbb H)\otimes M_2(\mathbb R)\simeq M_4(\mathbb H),\\
\mathrm{Cl}(0,6)&amp;\simeq\mathrm{Cl}(4,0)\otimes\mathrm{Cl}(0,2)\simeq
M_2(\mathbb H)\otimes \mathbb H\simeq M_8(\mathbb R).
\end{split}
\end{align*}\]</span></p>
<hr />
<p>然后是 <span class="math inline">\(d=7\)</span>： <span
class="math display">\[\begin{align*}
\begin{split}
\mathrm{Cl}(7,0)&amp;\simeq\mathrm{Cl}(0,5)\otimes\mathrm{Cl}(2,0)\simeq
M_4(\mathbb C)\otimes M_2(\mathbb R)\simeq M_8(\mathbb C),\\
\mathrm{Cl}(0,7)&amp;\simeq\mathrm{Cl}(5,0)\otimes\mathrm{Cl}(0,2)\simeq
[M_2(\mathbb H)\oplus M_2(\mathbb H)]\otimes \mathbb H\simeq M_8(\mathbb
R)\oplus M_8(\mathbb R).
\end{split}
\end{align*}\]</span></p>
<hr />
<p>注意到 <span class="math inline">\(\mathrm{Cl}(1,1)\simeq
M_{2^{(1+1)/2}}(\mathbb R)\)</span>，以及 <span
class="math inline">\(\mathrm{Cl}(8,0)\simeq\mathrm{Cl}(0,8)\simeq
M_{2^{(8+0)/2}}(\mathbb R)\)</span>，因此，得到这些结果之后，对于 <span
class="math inline">\(\mathrm{Cl}(s,t)\)</span>，我们只需要算出 <span
class="math inline">\(r:= (s-t)\;\)</span>mod<span
class="math inline">\(\,8\)</span>，找出相应的 <span
class="math inline">\(\mathrm{Cl}(r,0)\)</span>，然后与 <span
class="math inline">\(M_{2^{(d-r)/2}}(\mathbb R)\)</span>
做直积即可，其中 <span class="math inline">\(d=s+t\)</span>。</p>

    </div>
</div>
<p>最终的结果是： <blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\begin{array}{c|cccc}
\hline
s-t\;\text{mod}\,8    &amp;  0&amp;  1&amp;  2&amp;  3\\
\mathrm{Cl}(s,t)&amp;M_N(\mathbb R)&amp;M_N(\mathbb R)\oplus M_N(\mathbb
R)&amp;M_N(\mathbb R)&amp;M_N(\mathbb C) \\
N           &amp;2^{d/2}&amp;2^{(d-1)/2}&amp;2^{d/2}&amp;2^{(d-1)/2}\\
\hline
\hline
s-t\;\text{mod}\,8    &amp;  4&amp;  5&amp;  6&amp;  7\\
\mathrm{Cl}(s,t)&amp;M_N(\mathbb H)&amp;M_N(\mathbb H)\oplus M_N(\mathbb
H)&amp;M_N(\mathbb H)&amp;M_N(\mathbb C)  \\
N           &amp;2^{(d-2)/2}&amp;2^{(d-3)/2}&amp;2^{(d-2)/2}&amp;2^{(d-1)/2}\\
\hline
\end{array}
\end{align*}\]</span> 其中 <span class="math inline">\(d:=
s+t\)</span>。</p>
</blockquote></p>
<p>对于 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(s,t)\)</span>，利用
<span class="math inline">\(\mathrm{Cl}_{\text{even}}(s,t)\simeq
\mathrm{Cl}(s,t-1)\)</span> 可以算出： <blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\begin{array}{c|cccc}
\hline
s-t\;\text{mod}\,8    &amp;  0&amp;  1&amp;  2&amp;  3\\
\mathrm{Cl}_{\text{even}}(s,t)&amp;M_N(\mathbb R)\oplus M_N(\mathbb
R)&amp;M_N(\mathbb R)&amp;M_N(\mathbb C) &amp;M_N(\mathbb H)\\
N           &amp;2^{(d-2)/2}&amp;2^{(d-1)/2}&amp;2^{(d-2)/2}&amp;2^{(d-3)/2}\\
\hline
\hline
s-t\;\text{mod}\,8    &amp;  4&amp;  5&amp;  6&amp;  7\\
\mathrm{Cl}_{\text{even}}(s,t)&amp;M_N(\mathbb H)\oplus M_N(\mathbb
H)&amp;M_N(\mathbb H)&amp;M_N(\mathbb C) &amp; M_N(\mathbb R) \\
N           &amp;2^{(d-4)/2}&amp;2^{(d-3)/2}&amp;2^{(d-2)/2}&amp;2^{(d-1)/2}\\
\hline
\end{array}
\end{align*}\]</span> 其中 <span class="math inline">\(d:=
s+t\)</span>。</p>
</blockquote></p>
<h1 id="mathrmcl_textevenpq-的表示"><span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>
的表示</h1>
<p>与旋量群 <span class="math inline">\(\mathrm{Spin}_+(p,q)\)</span>
更为相关的是 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>。如果将
<span class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示限定在 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>
上，就能得到 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span> 的一个
<span class="math inline">\(2^{\lfloor (p+q)/2\rfloor}\)</span>
维表示。</p>
<p>由于 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span> 同构于
<span class="math inline">\(\mathrm{Cl}(q,p-1)\)</span> 或 <span
class="math inline">\(\mathrm{Cl}(p,q-1)\)</span>，后两者的 <span
class="math inline">\(&gt;1\)</span> 维的不可约表示是 <span
class="math inline">\(2^{\lfloor (p+q-1)/2\rfloor }\)</span>
维的。因此，如果 <span class="math inline">\(p+q\)</span> 是奇数，那么
<span class="math inline">\(2^{\lfloor (p+q)/2\rfloor}=2^{\lfloor
(p+q-1)/2\rfloor }\)</span>，从 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span>
处得来的表示就是不可约的；如果 <span class="math inline">\(p+q\)</span>
是偶数，那么 <span class="math inline">\(2^{\lfloor
(p+q)/2\rfloor}=2\times2^{\lfloor (p+q-1)/2\rfloor}\)</span>，从 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span>
处得来的表示就是可约的。</p>
<p>对于 <span class="math inline">\(d:= p+q\)</span>
为偶数的情形，可以考虑 <span class="math inline">\(e_{d+1}:=
e_1e_2\cdots e_d\)</span>。不难看出，<span
class="math inline">\(e_{d+1}\)</span> 与 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>
中的所有元素都对易。我们可以选取一个 <span
class="math inline">\(\varepsilon\)</span> 使得 <span
class="math inline">\(\Gamma:=\varepsilon e_{d+1}\)</span> 满足 <span
class="math inline">\(\Gamma^2=1\)</span>，然后定义： <span
class="math display">\[P_\pm:=\dfrac{1}{2}(1\pm\Gamma).\]</span>
不难验证 <span class="math inline">\(P_\pm^2=P_\pm\)</span>、<span
class="math inline">\(P_+P_-=P_-P_+=0\)</span> 以及 <span
class="math inline">\(P_++P_-=1\)</span>，因此 <span
class="math inline">\(P_\pm\)</span> 是投影算子。这样一来，利用 <span
class="math inline">\(P_\pm\)</span> 可以将 <span
class="math inline">\(\mathrm{Cl}(p,q)\)</span> 的表示空间 <span
class="math inline">\(V\)</span> 划分为 <span
class="math inline">\(P_+V\)</span> 与 <span
class="math inline">\(P_-V\)</span> 两部分，它们都在 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>
的作用下不变。从维数的角度来看，它们各自都承载了 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span>
的不可约表示。</p>
<p>然后考虑实表示。利用 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(p,q)\)</span> 同构于
<span class="math inline">\(\mathrm{Cl}(q,p-1)\)</span> 或 <span
class="math inline">\(\mathrm{Cl}(p,q-1)\)</span> 这一点可以发现，<span
class="math inline">\(\mathrm{Cl}_{\text{even}}(n,n)\)</span> 与 <span
class="math inline">\(\mathrm{Cl}_{\text{even}}(n,n\pm1)\)</span> 的
<span class="math inline">\(2^{\lfloor (p+q-1)/2\rfloor }\)</span>
维表示都是实表示，其余情形都是复表示，它们对应于 <span
class="math inline">\(2\times2^{\lfloor (p+q-1)/2\rfloor }\)</span>
维的实表示。</p>
<hr />
<h1 id="参考书籍">参考书籍</h1>
<ul>
<li><p>《Clifford Algebras in Physics》M. Rausch de Traubenberg, <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/hep-th/0506011v1">arXiv:hep-th/0506011</a></p></li>
<li><p>一个<a
target="_blank" rel="noopener" href="https://www.cphysics.org">神奇的网站</a>，上有若干关于 Clifford
代数的讲义：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.cphysics.org/article/03910">Clifford Algebra,
also called Geometric Algebra</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cphysics.org/article/08264">Clifford Algebra,
Lorentz Transformations, and Spin Groups</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cphysics.org/article/86175">Matrix
Representations of Clifford Algebras</a></li>
</ul></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/Krylov/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/Krylov/" class="post-title-link" itemprop="url">Krylov 子空间方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-09 14:11:35" itemprop="dateModified" datetime="2024-08-09T14:11:35+08:00">2024-08-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>找到了一份 <a
target="_blank" rel="noopener" href="https://math.ecnu.edu.cn/~jypan/Teaching/IMP/index.html">优秀的课程</a>，害怕它突然不见了，所以把目前感兴趣的内容的基本思路梳理一下。</p>
<hr />
<h1 id="krylov-子空间">Krylov 子空间</h1>
<p>Krylov 子空间方法的目标是近似求解线性方程组 <span
class="math display">\[Ax=b,\]</span> 其中 <span
class="math inline">\(A\)</span> 是 <span class="math inline">\(n\times
n\)</span> 可逆矩阵，<span class="math inline">\(b\)</span> 是 <span
class="math inline">\(n\times1\)</span> 的列向量。</p>
<p>我们将残量 <span class="math inline">\(r\)</span> 定义为 <span
class="math display">\[r:=b-Ax.\]</span></p>
<h2 id="krylov-子空间方法">Krylov 子空间方法</h2>
<p>投影方法方法的基本思路为：选取 <span class="math inline">\(\mathbb
R^n\)</span> 的 <span class="math inline">\(m\)</span> 维子空间 <span
class="math inline">\(\mathcal K_m\)</span>，在 <span
class="math inline">\(\mathcal K_m\)</span> 中找出一个 <span
class="math inline">\(x^\ast\)</span>
作为原问题的近似解。一种最常使用的思路如下：选取 <span
class="math inline">\(\mathbb R^n\)</span> 的两个 <span
class="math inline">\(m\)</span> 维子空间 <span
class="math inline">\(\mathcal K_m\)</span> 与 <span
class="math inline">\(\mathcal L_m\)</span>，在 <span
class="math inline">\(\mathcal K_m\)</span> 中求出 <span
class="math inline">\(x^\ast\)</span> 使得： <span
class="math display">\[\begin{align}\label{orthogonal_condition}
(Ax^\ast-b) \perp \mathcal L_m.\end{align}\]</span> <span
class="math inline">\(\mathcal K_m\)</span> 称为搜索空间，<span
class="math inline">\(\mathcal L_m\)</span> 称为约束空间。</p>
<p>假设我们为线性方程组选取的初值为 <span
class="math inline">\(x_0\)</span>，<span class="math inline">\(\mathcal
K_m\)</span> 与 <span class="math inline">\(\mathcal L_m\)</span>
的一组基为 <span
class="math display">\[V_m=[v_0,v_1,\cdots,v_{m-1}],\quad
W_m=[w_0,w_1,\cdots,w_{m-1}].\]</span> 再假设 <span
class="math display">\[x^\ast=x_0+V_my,\]</span> 那么条件 (<span
class="math inline">\(\ref{orthogonal_condition}\)</span>)
实际上意味着： <span
class="math display">\[\begin{align}\label{Krylov_reduced_equation}
W_m^{\mathrm T}[A(x_0+V_my)-b]=0,\quad\text{即}\quad (W_m^{\mathrm
T}AV_m)y=W_m^{\mathrm T}(b-Ax_0).
\end{align}\]</span> <span class="math inline">\(W_m^{\mathrm
T}AV_m\)</span> 是一个 <span class="math inline">\(m\times m\)</span>
矩阵，求解这样一个 <span class="math inline">\(m\)</span>
维线性方程组就能得到原方程组的近似解。如果 <span
class="math inline">\(m\ll n\)</span>
，这一方法就对线性方程组进行了有效的降维。</p>
<p>常用的搜索空间即为 <strong>Krylov 子空间</strong>： <span
class="math display">\[\begin{align*}
\mathcal K_m(A,v):=&amp;\;\mathrm{span}\left\lbrace
v,Av,A^2v,\cdots,A^{m-1}v\right\rbrace\\
=&amp;\;\left\lbrace p(A)v:\quad
p(x)\;\text{为次数不超过}\;(m-1)\;\text{的多项式}\right\rbrace.
\end{align*}\]</span> 以 Krylov 子空间为搜索空间的迭代法就是 Krylov
子空间方法。</p>
<p>最常使用的约束空间 <span class="math inline">\(\mathcal L_m\)</span>
有三个：选取 <span class="math inline">\(\mathcal L_m=\mathcal
K_m\)</span> 时 (<span
class="math inline">\(\ref{orthogonal_condition}\)</span>) 式称为
Galerkin 条件，选取 <span class="math inline">\(\mathcal L_m=A\mathcal
K_m\)</span> 时 (<span
class="math inline">\(\ref{orthogonal_condition}\)</span>) 式称为
Petrov-Galerkin 条件，此外在 <span class="math inline">\(\mathcal
K_m=\mathcal K_m(A,v)\)</span> 时还有选取 <span
class="math inline">\(\mathcal L_m=\mathcal K_m(A^{\mathrm
T},v)\)</span> 的做法。</p>
<h2 id="arnoldi-过程">Arnoldi 过程</h2>
<p>在 Krylov 子空间中，<span
class="math inline">\(\{A^iv\}_{i=0}^m\)</span> 这组基有巨大的缺陷：随着
<span class="math inline">\(i\)</span> 的增加，<span
class="math inline">\(A^iv\)</span> 将会逐渐趋于 <span
class="math inline">\(A\)</span>
的最大特征值对应的特征向量（与幂法的思路类似），导致 <span
class="math inline">\(\{A^iv\}_{i=0}^m\)</span> 逐渐变得线性相关。为
Krylov 子空间构造一组正交基的过程就是 <strong>Arnoldi
过程</strong>。</p>
<h3 id="基于-gram-schmidt-正交化的-arnoldi-过程">基于 Gram-Schmidt
正交化的 Arnoldi 过程</h3>
<p>Arnoldi 过程的通常做法是通过 Gram-Schmidt
过程来构造这组正交基。大致算法如下：</p>
<blockquote class="colorquote pseudocode" ><p><span class="math inline">\(v_0=v/\|v\|_2\)</span><br />
for <span class="math inline">\(j=0,1,2,\cdots,(m-1):\)</span><br />
<span class="math inline">\(\quad t=Av_j\)</span><br />
<span class="math inline">\(\quad\)</span>for <span
class="math inline">\(i=0,1,2,\cdots,j:\)</span><br />
<span class="math inline">\(\quad\quad h_{i,j}=v_i^{\mathrm
T}t\)</span><br />
<span class="math inline">\(\quad\quad t=t-h_{i,j}v_i\)</span><br />
<span class="math inline">\(\quad\)</span>endfor<br />
<span class="math inline">\(\quad h_{j+1,j}=\|t\|_2\)</span><br />
<span class="math inline">\(\quad\)</span>if <span
class="math inline">\(h_{j+1,j}==0\)</span>:<br />
<span class="math inline">\(\quad\quad\)</span>break<br />
<span class="math inline">\(\quad\)</span>else:<br />
<span class="math inline">\(\quad\quad
v_{j+1}=t/h_{j+1,j}\)</span><br />
endfor</p>
</blockquote>
<p>不难证明，以上算法给出：</p>
<p><span class="math display">\[\begin{align*}
AV_m=&amp;\;V_mH_m+v_m[0,\;0,\;0,\;\cdots,\;0,\;h_{m,m-1}]_{1\times
m},\\
=&amp;\;V_{m+1}H_{m+1,m}.
\end{align*}\]</span></p>
<p>其中 <span class="math inline">\(V_m\)</span> 就是 Krylov
子空间的正交归一基，<span class="math inline">\(H_m\)</span> 是 <span
class="math inline">\(m\times m\)</span> 的上 Hessenberg 矩阵，<span
class="math inline">\(H_{m+1,m}\)</span> 是 <span
class="math inline">\((m+1)\times m\)</span> 的上 Hessenberg 矩阵，并且
<span class="math inline">\(H_m\)</span> 是 <span
class="math inline">\(H_{m+1}\)</span> 的前 <span
class="math inline">\(m\)</span> 行： <span
class="math display">\[\begin{align}\begin{split}
V_m:=&amp;\;[v_0,\;v_1,\;\cdots,\;v_{m-1}],\\
H_{m}:=&amp;\;\begin{bmatrix}
h_{0,0}&amp;h_{0,1}&amp;h_{0,2}&amp;\cdots&amp;h_{0,m-2}&amp;h_{0,m-1}\\
h_{1,0}&amp;h_{1,1}&amp;h_{1,2}&amp;\cdots&amp;h_{1,m-2}&amp;h_{1,m-1}\\
0      &amp;h_{2,1}&amp;h_{2,2}&amp;\cdots&amp;h_{2,m-2}&amp;h_{2,m-1}\\
0      &amp;0      &amp;h_{3,2}&amp;\cdots&amp;h_{3,m-2}&amp;h_{3,m-1}\\
\vdots &amp;\vdots &amp;\vdots &amp;      &amp;\vdots   &amp;\vdots \\
0      &amp;0      &amp;0&amp;\cdots&amp;h_{m-1,m-2}&amp;h_{m-1,m-1}\\
\end{bmatrix},\\
H_{m+1,m}:=&amp;\;\begin{bmatrix}
h_{0,0}&amp;h_{0,1}&amp;h_{0,2}&amp;\cdots&amp;h_{0,m-2}&amp;h_{0,m-1}\\
h_{1,0}&amp;h_{1,1}&amp;h_{1,2}&amp;\cdots&amp;h_{1,m-2}&amp;h_{1,m-1}\\
0      &amp;h_{2,1}&amp;h_{2,2}&amp;\cdots&amp;h_{2,m-2}&amp;h_{2,m-1}\\
0      &amp;0      &amp;h_{3,2}&amp;\cdots&amp;h_{3,m-2}&amp;h_{3,m-1}\\
\vdots &amp;\vdots &amp;\vdots &amp;      &amp;\vdots   &amp;\vdots \\
0      &amp;0      &amp;0&amp;\cdots&amp;h_{m-1,m-2}&amp;h_{m-1,m-1}\\
0      &amp;0      &amp;0&amp;\cdots&amp;0&amp;h_{m,m-1}\\
\end{bmatrix}.
\end{split}\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>Gram-Schmidt 正交化算法给出： <span
class="math display">\[h_{j+1,j}v_{j+1}=Av_j-(h_{0,j}v_0+h_{1,j}v_1+h_{2,j}v_2+\cdots+h_{j,j}v_j),\]</span>
即 <span
class="math display">\[Av_j=(h_{0,j}v_0+h_{1,j}v_1+h_{2,j}v_2+\cdots+h_{j,j}v_j)+h_{j+1,j}v_{j+1}.\]</span>
写为矩阵形式就是： <span
class="math display">\[A[v_0,\;v_1,\;\cdots,\;v_{m-1}]=[v_0,\;v_1,\;\cdots,\;v_{m-1},\;v_{m}]H_{m+1,m}.\]</span>
我们可以把 <span class="math inline">\(v_m\)</span> 单独拿出： <span
class="math display">\[A[v_0,\;v_1,\;\cdots,\;v_{m-1}]=[v_0,\;v_1,\;\cdots,\;v_{m-1}]H_{m}+v_m[0,\;0,\;0,\;\cdots,\;0,\;h_{m,m-1}]_{1\times
m}.\]</span> 这里的 <span class="math inline">\(H_{m}\)</span> 为 <span
class="math inline">\(H_{m+1,m}\)</span> 的前 <span
class="math inline">\(m\)</span> 行。我们再将 <span
class="math inline">\([v_0,\;v_1,\;\cdots,\;v_{m-1}]\)</span> 记为 <span
class="math inline">\(V_m\)</span>。就有： <span
class="math display">\[AV_m=V_mH_m+v_m[0,\;0,\;0,\;\cdots,\;0,\;h_{m,m-1}]_{1\times
m}.\]</span></p>

    </div>
</div>
<p>不难看出，如果 <span class="math inline">\(h_{m,m-1}=0\)</span>，那么
<span class="math inline">\(v_0\sim v_{m-1}\)</span> 将构成 <span
class="math inline">\(A\)</span> 的一个不变子空间。</p>
<p>由于 <span class="math inline">\(v_0\sim v_m\)</span> 彼此正交，即
<span class="math inline">\(V_m^{\mathrm T}V_m=I_m\)</span>，所以：
<span class="math display">\[\begin{align}\label{VAV}
V_m^{\mathrm T}AV_m=H_m.
\end{align}\]</span></p>
<h3 id="对称矩阵的-lanczos-过程">对称矩阵的 Lanczos 过程</h3>
<p>如果 <span class="math inline">\(A\)</span> 是对称矩阵，从 (<span
class="math inline">\(\ref{VAV}\)</span>) 式可以看出 <span
class="math inline">\(H_m\)</span> 也是对称矩阵，这意味着 <span
class="math inline">\(H_m\)</span> 是三对角矩阵。</p>
<p>此时，Arnoldi 过程中的正交化步骤可得到有效的简化： <span
class="math display">\[\begin{align*}h_{j+1,j}v_{j+1}=&amp;\;Av_j-(h_{0,j}v_0+h_{1,j}v_1+h_{2,j}v_2+\cdots+h_{j,j}v_j)\\
=&amp;\;Av_j-(h_{j-1,j}v_{j-1}+h_{j,j}v_j).\end{align*}\]</span></p>
<h2 id="双正交化过程双边-lanczos-过程">双正交化过程（双边 Lanczos
过程）</h2>
<p>双正交化过程与 Arnoldi 过程不同，它可为 <span
class="math inline">\(\mathcal K_m=\mathcal K_m(A,v)\)</span> 与 <span
class="math inline">\(\mathcal L_m=\mathcal K_m(A^{\mathrm
T},w)\)</span> 分别找到一组不正交的基 <span
class="math inline">\(V_m:=[v_0,\;\cdots,\;v_{m-1}]\)</span> 与 <span
class="math inline">\(W_m:=[w_0,\;\cdots,\;w_{m-1}]\)</span>，使它们满足：
<span class="math display">\[v_i^{\mathrm
T}w_j=\delta_{ij}.\]</span></p>
<p>在双正交过程中，计算 <span class="math inline">\(v_i\)</span> 与
<span class="math inline">\(w_i\)</span> 的递推关系为： <span
class="math display">\[\begin{align*}
\gamma_kv_{k+1}=&amp;\;Av_k-\alpha_kv_k-\beta_{k-1}v_{k-1},\\
\beta_kw_{k+1}=&amp;\;A^{\mathrm T}w_k-\alpha_kw_k-\gamma_{k-1}w_{k-1},
\end{align*}\]</span> 其中 <span
class="math display">\[\alpha_k=w_k^{\mathrm T}Av_k,\quad
\beta_{-1}=\gamma_{-1}=0,\quad
\beta_k,\gamma_k(k\geqslant0)\;\text{可任取只需保证}\;v_{k+1}^{\mathrm
T}w_{k+1}=1.\]</span> 用数学归纳法可以证明这样得到的基确实能够满足 <span
class="math inline">\(v_i^{\mathrm T}w_j=\delta_{ij}\)</span>。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(k=0\)</span> 时 <span
class="math inline">\(v_0^{\mathrm T}w_0=1\)</span> 成立。</p>
<p>假设 <span class="math inline">\(i\leqslant k\)</span>，<span
class="math inline">\(j\leqslant k\)</span> 时有 <span
class="math inline">\(v_i^{\mathrm T}w_j=\delta_{ij}\)</span>。由于
<span class="math inline">\(\gamma_k\beta_k\)</span> 的选择使得 <span
class="math inline">\(v_{k+1}^{\mathrm
T}w_{k+1}=1\)</span>，所以只需要证明对 <span class="math inline">\(0\sim
k\)</span> 中的任意一个 <span class="math inline">\(i\)</span> 都有
<span class="math inline">\(v_{k+1}^{\mathrm T}w_{i}=v_{i}^{\mathrm
T}w_{k+1}=0\)</span> 即可。</p>
<p>如果 <span class="math inline">\(i\leqslant k-2\)</span>，那么 <span
class="math inline">\(v_{k+1}^{\mathrm T}w_i=0\)</span>： <span
class="math display">\[\begin{align*}\gamma_kv_{k+1}^{\mathrm
T}w_i=&amp;\;(v_k^{\mathrm T}A^{\mathrm
T}w_i)-(\alpha_kv_k+\beta_{k-1}v_{k-1})^{\mathrm T}w_i\\
=&amp;\;v_k^{\mathrm
T}(\beta_iw_{i+1}+\alpha_iw_i+\gamma_{i-1}w_{i-1})-0\\
=&amp;\;0,\end{align*}\]</span> 同理可证 <span
class="math inline">\(i\leqslant k-2\)</span> 时 <span
class="math inline">\(v_i^{\mathrm T}w_{k+1}=0\)</span>。</p>
<p><span class="math inline">\(i=k-1\)</span> 时： <span
class="math display">\[\begin{align*}\gamma_kv_{k+1}^{\mathrm
T}w_{k-1}=&amp;\;(v_k^{\mathrm T}A^{\mathrm
T}w_{k-1})-(\alpha_kv_k+\beta_{k-1}v_{k-1})^{\mathrm T}w_{k-1}\\
=&amp;\;v_k^{\mathrm
T}(\beta_{k-1}w_{k}+\alpha_{k-1}w_{k-1}+\gamma_{k-2}w_{k-2})-\beta_{k-1}v_{k-1}^{\mathrm
T}w_{k-1}\\
=&amp;\;\beta_{k-1}-\beta_{k-1}=0,\end{align*}\]</span> 同理可证 <span
class="math inline">\(\beta_kv_{k-1}^{\mathrm T}w_{k+1}=0\)</span>.</p>
<p><span class="math inline">\(i=k\)</span> 时： <span
class="math display">\[\begin{align*}\gamma_kv_{k+1}^{\mathrm
T}w_k=&amp;\;(v_k^{\mathrm T}A^{\mathrm
T}w_k)-(\alpha_kv_k+\beta_{k-1}v_{k-1})^{\mathrm T}w_k\\
=&amp;\;(v_k^{\mathrm T}A^{\mathrm T}w_k)-\alpha_k\\
=&amp;\;0.\end{align*}\]</span> 同理可证 <span
class="math inline">\(\beta_kv_{k}^{\mathrm T}w_{k+1}=0\)</span>.</p>
<p>这样就完成了证明。</p>

    </div>
</div>
<p>相应的算法是：</p>
<blockquote class="colorquote pseudocode" ><p><span class="math inline">\(v_0=v/\|v\|_2\)</span><br />
<span class="math inline">\(w_0=\|v\|_2w/(v^{\mathrm T}w)\)</span><br />
for <span class="math inline">\(j=0,1,2,\cdots,(m-1):\)</span><br />
<span class="math inline">\(\quad \tilde
v_{j+1}=Av_j-\beta_{j-1}v_{j-1}\)</span><br />
<span class="math inline">\(\quad \tilde
w_{j+1}=Aw_j-\gamma_{j-1}w_{j-1}\)</span><br />
<span class="math inline">\(\quad \alpha_j=v_j^{\mathrm T}\tilde
w_{j+1}\)</span><br />
<span class="math inline">\(\quad \tilde v_{j+1}=\tilde
v_{j+1}-\alpha_jv_j\)</span><br />
<span class="math inline">\(\quad \tilde w_{j+1}=\tilde
w_{j+1}-\alpha_jw_j\)</span><br />
<span class="math inline">\(\quad \gamma_j=\sqrt{|\tilde
v_{j+1}^{\mathrm T}\tilde w_{j+1}|}\)</span><br />
<span class="math inline">\(\quad\)</span>if <span
class="math inline">\(\gamma_j==0\)</span>:<br />
<span class="math inline">\(\quad\quad\)</span>break<br />
<span class="math inline">\(\quad\)</span>else:<br />
<span class="math inline">\(\quad\quad \beta_j=(\tilde v_{j+1}^{\mathrm
T}\tilde w_{j+1})/\gamma_j\)</span><br />
<span class="math inline">\(\quad\quad v_{j+1}=\tilde
v_{j+1}/\gamma_j\)</span><br />
<span class="math inline">\(\quad\quad w_{j+1}=\tilde
w_{j+1}/\beta_j\)</span><br />
<span class="math inline">\(\quad\)</span>endif<br />
endfor</p>
</blockquote>
<p>不难验证，这一算法给出：</p>
<p><span class="math display">\[\begin{align*}
AV_m=&amp;\;V_{m+1}T^{(1)}_{m+1,m}=V_mT_m+v_m[0,\;0,\;0,\;\cdots,\;0,\;\gamma_{m-1}]_{1\times
m},\\
A^{\mathrm T}W_m=&amp;\;W_{m+1}T^{(2)}_{m+1,m}=W_mT_m^{\mathrm
T}+w_m[0,\;0,\;0,\;\cdots,\;0,\;\beta_{m-1}]_{1\times m}.
\end{align*}\]</span></p>
<p>其中 <span class="math inline">\(V_m\)</span> 与 <span
class="math inline">\(W_m\)</span> 就是 <span
class="math inline">\(\mathcal K\)</span> 与 <span
class="math inline">\(\mathcal L_m\)</span> 的一组基且满足 <span
class="math inline">\(V_m^{\mathrm T}W_m=I_m\)</span>，<span
class="math inline">\(T_m\)</span> 是 <span
class="math inline">\(m\times m\)</span> 的三对角矩阵，<span
class="math inline">\(T_{m+1,m}\)</span> 是 <span
class="math inline">\((m+1)\times m\)</span> 的上 Hessenberg 矩阵，且
<span class="math inline">\(T_m\)</span> 是 <span
class="math inline">\(T_{m+1}\)</span> 的前 <span
class="math inline">\(m\)</span> 行：</p>
<p><span class="math display">\[\begin{align}\begin{split}
V_m:=&amp;\;[v_0,\;v_1,\;\cdots,\;v_{m-1}],\\
W_m:=&amp;\;[w_0,\;w_1,\;\cdots,\;w_{m-1}],\\
T_{m}:=&amp;\;\begin{bmatrix}
\alpha_0&amp;\beta_0&amp;&amp;&amp;\\
\gamma_0&amp;\alpha_1&amp;\beta_1&amp;&amp;\\
&amp;\gamma_1&amp;\alpha_2&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;\ddots&amp;\beta_{m-2}\\
&amp;&amp;&amp;\gamma_{m-2}&amp;\alpha_{m-1}\\
\end{bmatrix},\\
T_{m+1,m}^{(1)}:=&amp;\;\begin{bmatrix}
\alpha_0&amp;\beta_0&amp;&amp;&amp;\\
\gamma_0&amp;\alpha_1&amp;\beta_1&amp;&amp;\\
&amp;\gamma_1&amp;\alpha_2&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;\ddots&amp;\beta_{m-2}\\
&amp;&amp;&amp;\gamma_{m-2}&amp;\alpha_{m-1}\\
&amp;&amp;&amp; &amp;\gamma_{m-1}\\
\end{bmatrix},\\
T_{m+1,m}^{(2)}:=&amp;\;\begin{bmatrix}
\alpha_0&amp;\gamma_0&amp;&amp;&amp;\\
\beta_0&amp;\alpha_1&amp;\gamma_1&amp;&amp;\\
&amp;\beta_1&amp;\alpha_2&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;\ddots&amp;\gamma_{m-2}\\
&amp;&amp;&amp;\beta_{m-2}&amp;\alpha_{m-1}\\
&amp;&amp;&amp; &amp;\beta_{m-1}\\
\end{bmatrix}.
\end{split}\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>只需注意到双正交过程给出的递推关系是：</p>
<p><span class="math display">\[\begin{align*}
Av_k=&amp;\;\gamma_kv_{k+1}+\alpha_kv_k+\beta_{k-1}v_{k-1},\\
A^{\mathrm T}w_k=&amp;\;\beta_kw_{k+1}+\alpha_kw_k+\gamma_{k-1}w_{k-1},
\end{align*}\]</span> 其中 <span
class="math inline">\(\beta_{-1}=\gamma_{-1}=0\)</span>。</p>

    </div>
</div>
<p>以上结果告诉我们： <span
class="math display">\[\begin{align}\label{WAV}
W_m^{\mathrm T}AV_m=T_m.
\end{align}\]</span></p>
<p>双正交化过程的优点在于计算量相对 Arnoldi 过程较低，因为构造 <span
class="math inline">\(v_{k+1}\)</span> 与 <span
class="math inline">\(w_{k+1}\)</span> 时只需要考虑 <span
class="math inline">\(i=k-1,k\)</span> 时的 <span
class="math inline">\(v_i\)</span> 与 <span
class="math inline">\(w_i\)</span>。但其问题是这样构造出的 <span
class="math inline">\(v_i\)</span> 之间并不正交，并且容易中断。</p>
<h1 id="krylov-子空间算法">Krylov 子空间算法</h1>
<p>以下主要说明基于 Arnoldi
过程的算法。基于双正交过程的算法留在这一部分的最后一小节。</p>
<p>在以下所有算法中，我们都定义 <span
class="math display">\[\beta:=\|b-Ax_0\|_2.\]</span></p>
<p>对于那些基于 Arnoldi 过程的算法，我们将 <span
class="math inline">\((b-Ax_0)\)</span>——即初值 <span
class="math inline">\(x_0\)</span> 给出的剩余向量——作为 Arnoldi
过程的初值，并计算出 <span
class="math inline">\(V_m=[v_0,v_1,\cdots,v_{m-1}]\)</span>，<span
class="math inline">\(H_m\)</span>，以及 <span
class="math inline">\(H_{m+1,m}\)</span>。</p>
<p>我们还用 <span class="math inline">\(e_i\)</span> 表示只有第 <span
class="math inline">\(i\)</span> 个元素为 <span
class="math inline">\(1\)</span> 其余元素为 <span
class="math inline">\(0\)</span>
的列向量（总长度不固定）。此时，初值的剩余向量可以写为 <span
class="math display">\[b-Ax_0=\beta v_0=\beta V_me_1=\beta
V_{m+1}e_1.\]</span></p>
<h2
id="完全正交方法fom非对称线性方程组">完全正交方法（FOM）：非对称线性方程组</h2>
<p><strong>完全正交方法（Full Orthogonalization Method）</strong>
可用于并不对称的 <span class="math inline">\(A\)</span>。FOM 取约束空间
<span class="math inline">\(\mathcal L_m=\mathcal K_m\)</span>，并用
Arnoldi 过程找出 <span class="math inline">\(\mathcal K_m\)</span> 与
<span class="math inline">\(\mathcal L_m\)</span> 的一组基。此时的条件
(<span class="math inline">\(\ref{Krylov_reduced_equation}\)</span>)——即
<span class="math inline">\((W_m^{\mathrm T}AV_m)y=W_m^{\mathrm
T}(b-Ax_0)\)</span>——变为： <span class="math display">\[(V_m^{\mathrm
T}AV_m)y=V_m^{\mathrm T}(b-Ax_0).\]</span> 由 (<span
class="math inline">\(\ref{VAV}\)</span>) 以及 <span
class="math inline">\(v_0\sim v_{m-1}\)</span> 之间的正交性可得： <span
class="math display">\[H_my=\beta e_1.\]</span> 求出这一 <span
class="math inline">\(m\)</span> 维线性方程组的解 <span
class="math inline">\(y_m\)</span> 就能通过 <span
class="math inline">\(x^\ast_m=x_0+V_my_m\)</span> 得到 <span
class="math inline">\(x^\ast\)</span> 的估计，这就是 FOM
的基本思路。</p>
<p>实际计算时，会逐渐增加 <span class="math inline">\(m\)</span>，直到
<span class="math inline">\(b-Ax^\ast_m\)</span>
变得足够小。在这一过程中，前面算出的 <span
class="math inline">\(v_i\)</span> 与 <span
class="math inline">\(H_m\)</span> 可以保存下来。</p>
<h2
id="广义极小残量法gmres非对称线性方程组">广义极小残量法（GMRES）：非对称线性方程组</h2>
<p><strong>广义极小残量法（Generalized Minimum Residual）</strong>
可用于并不对称的 <span class="math inline">\(A\)</span>。GMRES
取约束空间 <span class="math inline">\(\mathcal L_m=A\mathcal
K_m\)</span>，并用 Arnoldi 过程找出 <span class="math inline">\(\mathcal
K_m\)</span> 的一组基。此时的条件 (<span
class="math inline">\(\ref{Krylov_reduced_equation}\)</span>)——即 <span
class="math inline">\((W_m^{\mathrm T}AV_m)y=W_m^{\mathrm
T}(b-Ax_0)\)</span>——变为： <span class="math display">\[(V_m^{\mathrm
T}A^{\mathrm T}AV_m)y=V_m^{\mathrm T}A^{\mathrm T}(b-Ax_0).\]</span>
这一方程实际上就是最小二乘问题 <span
class="math inline">\(\displaystyle\min_{y\in \mathbb
R^m}\|AV_my-b+Ax_0\|^2_2\)</span>，即 <span
class="math display">\[\displaystyle\min_{x\in x_0+\mathcal
K_m}\|Ax-b\|^2_2\]</span> 的解，这就是广义极小残量法的名称来源。</p>
<p>由于 <span class="math display">\[\begin{align*}\begin{split}
AV_my-b+Ax_0=&amp;\;V_{m+1}H_{m+1,m}y-\beta v_0\\
=&amp;\;V_{m+1}H_{m+1,m}y-\beta V_{m+1}e_1,
\end{split}\end{align*}\]</span></p>
<p>再加 <span class="math inline">\(V_{m+1}^{\mathrm
T}V_{m+1}=I_{m+1}\)</span>，就能发现 <span
class="math display">\[\displaystyle\min_{x\in x_0+\mathcal
K_m}\|Ax-b\|^2_2=\displaystyle\min_{y\in \mathbb R^m}\|H_{m+1,m}y-\beta
e_1\|^2_2.\]</span> 由于 <span class="math inline">\(H_{m+1,m}\)</span>
是上 Hessenberg 矩阵，并且维数不高，所以这一最小二乘问题可以用 QR
分解求解。这就是 GMRES 的基本思路。</p>
<p>在对 <span class="math inline">\(H_{m+1,m}\)</span> 做 QR
分解时可采用 Givens 变换。由于</p>
<ul>
<li><span class="math inline">\(H_{m+2,m+1}\)</span>
中对角线以下的元素的数目相较于 <span
class="math inline">\(H_{m+1,m}\)</span> 仅仅只多了 <span
class="math inline">\(1\)</span> 个，</li>
<li><span class="math inline">\(H_{m+1,m}\)</span> 是 <span
class="math inline">\(H_{m+2,m+1}\)</span> 的子矩阵，</li>
</ul>
<p>所以要完成 <span class="math inline">\(H_{m+2,m+1}\)</span> 的 QR
分解，就只需要在 <span class="math inline">\(H_{m+1,m}\)</span> 的 QR
分解的基础上再加一次 Givens 变换即可。存储的时候只需要记录下 Givens
变换即可，甚至可以将 QR 分解得到的 <span
class="math inline">\(R\)</span> 存储在 <span
class="math inline">\(H\)</span> 中。</p>
<p>当迭代次数过多，即 <span class="math inline">\(m\)</span>
过大时，存储量会很大，此时可以采取重启策略。即当 <span
class="math inline">\(m\)</span> 达到 <span
class="math inline">\(20\sim50\)</span>
时，以最后一步的结果作为初值，重新开始 GMRES 方法。</p>
<h2
id="共轭梯度法cg对称线性方程组">共轭梯度法（CG）：对称线性方程组</h2>
<p>如果 <span class="math inline">\(A\)</span> 是对称正定矩阵，那么
<span class="math inline">\(Ax=b\)</span> 可通过
<strong>共轭梯度法（Conjugate Gradient, CG）</strong>
求解。接下来我们证明，共轭梯度法本质上就是 FOM，即 <span
class="math inline">\(\mathcal L_m=\mathcal K_m\)</span> 且用 Arnoldi
过程寻找 <span class="math inline">\(\mathcal K_m\)</span> 的一组基的
Krylov 子空间算法。</p>
<p>我们将 FOM 的每一步迭代产生的估计 <span
class="math inline">\(x_m\)</span> 写出：</p>
<p><span class="math display">\[\begin{align*}
x_m=&amp;\;x_0+V_my_m=x_0+V_m(H_m^{-1}\beta e_1).
\end{align*}\]</span> 由于 <span class="math inline">\(A\)</span>
是对称正定矩阵，所以 <span class="math inline">\(H_m=V_m^{\mathrm
T}AV_m\)</span> 也是对称正定矩阵，我们可以对 <span
class="math inline">\(H_m\)</span> 做 <span
class="math inline">\(LDL^{\mathrm T}\)</span> 分解： <span
class="math display">\[\begin{align}\label{H=LDL}
H_m=L_mD_mL_m^{\mathrm T}=
\begin{bmatrix}
1&amp;&amp;&amp;\\
l_1&amp;1&amp;&amp;\\
&amp;\ddots&amp;\ddots&amp;\\
&amp;&amp;l_{m-1}&amp;1
\end{bmatrix}
\begin{bmatrix}
d_0&amp;&amp;&amp;\\
&amp;d_1&amp;&amp;\\
&amp;&amp;\ddots&amp;\\
&amp;&amp;&amp;d_{m-1}
\end{bmatrix}
\begin{bmatrix}
1&amp;l_1&amp;&amp;\\
&amp;1&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;l_{m-1}\\
&amp;&amp;&amp;1
\end{bmatrix}
.\end{align}\]</span> 其中： <span
class="math display">\[d_0=h_{0,0},\quad l_i=h_{i-1,i}/d_{i-1},\quad
d_i=h_{i,i}-l_ih_{i-1,i}\quad(i&gt;0).\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
(L_mD_m)L_m^{\mathrm T}=&amp;\;\begin{bmatrix}
d_0&amp;&amp;&amp;&amp;\\
l_1d_0&amp;d_1&amp;&amp;&amp;\\
&amp;l_2d_1&amp;d_2&amp;&amp;\\[1em]
&amp;&amp;\ddots&amp;\ddots&amp;\\[1em]
&amp;&amp;&amp;l_{m-1}d_{m-2}&amp;d_{m-1}
\end{bmatrix}\begin{bmatrix}
1&amp;l_1&amp;&amp;\\
&amp;1&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;l_{m-1}\\
&amp;&amp;&amp;1
\end{bmatrix}\\
=&amp;\;\begin{bmatrix}
d_0&amp;l_1d_0&amp;&amp;&amp;\\
l_1d_0&amp;d_1+l_1^2d_0&amp;l_2d_1&amp;&amp;\\
&amp;l_2d_1&amp;d_2+l_2^2d_1&amp;\ddots&amp;\\[1em]
&amp;&amp;\ddots&amp;\ddots&amp;l_{m-1}d_{m-2}\\[1em]
&amp;&amp;&amp;l_{m-1}d_{m-2}&amp;d_{m-1}+l_{m-1}^2d_{m-2}
\end{bmatrix}
\end{align*}\]</span> 因此 <span
class="math display">\[h_{0,0}=d_0,\quad h_{j-1,j}=l_jd_{j-1},\quad
h_{j,j}=d_j+l_j^2d_{j-1}=d_j+l_jh_{j-1,j}\quad (j&gt;0).\]</span></p>

    </div>
</div>
<p>我们将 <span class="math inline">\((L_m^{\mathrm T})^{-1}\)</span>
简记为 <span class="math inline">\(L_m^{-\mathrm T}\)</span>，那么 <span
class="math display">\[\begin{align*}
x_m=&amp;\;x_0+V_my_m=x_0+(V_mL_m^{-\mathrm T})(\beta
D_m^{-1}L_m^{-1}e_1)\\
:=&amp;\;x_0+\tilde P_m\tilde y_m,
\end{align*}\]</span> 其中 <span class="math inline">\(\tilde
P_m:=V_mL_m^{-\mathrm T}\)</span>，<span class="math inline">\(\tilde
y_m=\beta D_m^{-1}L_m^{-1}e_1\)</span>。再假设 <span
class="math display">\[\tilde P_m:=[\tilde p_0,\tilde p_1,\cdots,\tilde
p_{m-1}],\quad \tilde y_m:=[\eta_0,\eta_1,\cdots,\eta_{m-1}]^{\mathrm
T}.\]</span> 那么 <span class="math display">\[x_{m+1}=x_0+\tilde
P_{m+1}\tilde y_{m+1}=x_0+\tilde P_{m}\tilde y_{m}+\eta_m\tilde
p_{m}=x_m+\eta_m\tilde p_{m}.\]</span></p>
<p>我们可以证明 <span class="math inline">\(\tilde P_m^{\mathrm
T}A\tilde P_m\)</span> 是对角矩阵： <span class="math display">\[\tilde
P_m^{\mathrm T}A\tilde P_m=L_m^{-1}V_m^{\mathrm T}AV_mL_m^{-\mathrm
T}=L_m^{-1}H_mL_m^{-\mathrm T}=D_m,\]</span> 这意味着 <span
class="math inline">\(\tilde P_m\)</span> 的列向量，即 <span
class="math inline">\(\tilde p_m\)</span> 是 <span
class="math inline">\(A\)</span>-正交的。</p>
<p><span class="math inline">\(\tilde p_{m}\)</span> 的具体形式是：
<span class="math display">\[\begin{align*}
[\tilde p_0,\tilde p_1,\cdots,\tilde
p_{m-1}]=&amp;\;[v_0,v_1,\cdots,v_{m-1}]\begin{bmatrix}
1&amp;-l_1&amp;&amp;\\
&amp;1&amp;\ddots&amp;\\
&amp;&amp;\ddots&amp;-l_{m-1}\\
&amp;&amp;&amp;1
\end{bmatrix}\\
=&amp;\;[v_0,v_1-l_1v_0,\cdots,v_{m-1}-l_{m-1}v_{m-2}].\end{align*}\]</span></p>
<p>考虑到：</p>
<ul>
<li><span class="math inline">\(\tilde p_0=\tilde
v_0\)</span>，这与共轭梯度法一致。</li>
<li><span class="math inline">\(\tilde
p_m=v_{m}-l_{m}v_{m-1}\)</span>，这意味着 <span
class="math inline">\(\tilde p_m\)</span> 由 <span
class="math inline">\(v_0\sim v_m\)</span> 生成，也就是由 <span
class="math inline">\(A^0v_0\sim A^mv_0\)</span>
生成。这与共轭梯度法一致。</li>
<li>迭代的每一步都沿着互相 <span
class="math inline">\(A\)</span>-正交的方向，这与共轭梯度法一致。</li>
<li>当 <span
class="math inline">\(m=n\)</span>，即搜索空间的维数等于原线性方程组的维数时，<span
class="math inline">\(x_m\)</span>
就是原方程组的解，这与共轭梯度法一致。</li>
</ul>
<p>所以通过 FOM 方法产生的序列 <span
class="math inline">\(\{x_k\}_{k=0}^n\)</span>
与共轭梯度法产生的序列一样，因此 FOM 等价于共轭梯度法。</p>
<h2
id="极小残量法minres对称线性方程组">极小残量法（MINRES）：对称线性方程组</h2>
<p>CG 只适用于 <span class="math inline">\(A\)</span>
对称正定的情形，<span class="math inline">\(A\)</span>
不定时可用<strong>极小残量法（MINRES）</strong>，它是 GMRES
在对称情形下的特例。由于 <span class="math inline">\(A\)</span>
是对称的，所以 <span class="math inline">\(H_m\)</span>
是三对角矩阵，通过 Givens 变换做 QR 分解时可以有相当程度的简化。</p>
<h2 id="symmlq-方法对称线性方程组">SYMMLQ 方法：对称线性方程组</h2>
<p>SYMMLQ 方法与 CG 或 FOM 一样，取 <span class="math inline">\(\mathcal
L_m=\mathcal K_m\)</span>，并用 Arnoldi 过程为 <span
class="math inline">\(\mathcal K_m\)</span> 找出一组基。它在 <span
class="math inline">\(A\)</span> 为对称正定时等价于 CG，但也可用于处理
<span class="math inline">\(A\)</span> 不定的情形。</p>
<p>在 <span class="math inline">\(A\)</span> 不定时，(<span
class="math inline">\(\ref{H=LDL}\)</span>) 式的 <span
class="math inline">\(LDL^{\mathrm T}\)</span> 分解不一定存在（因为
<span class="math inline">\(D\)</span> 中的 <span
class="math inline">\(d_i\)</span> 可能为 <span
class="math inline">\(0\)</span> 导致算法无法推进）。此时，可以对 <span
class="math inline">\(H_m\)</span> 做 LQ 分解（与 QR 分解类似）： <span
class="math display">\[H_m=\tilde L_mQ_m\]</span> <span
class="math inline">\(\tilde L_m\)</span> 是下三角矩阵，<span
class="math inline">\(Q_m\)</span> 是正交矩阵。</p>
<p>基于这一分解，FOM 方法产生的序列为： <span
class="math display">\[\begin{align*}
x_m=&amp;\;x_0+V_my_m=x_0+V_m(H_m^{-1}\beta e_1)\\
=&amp;\;x_0+(V_mQ_m^{\mathrm T})(L_m^{-1}\beta e_1).
\end{align*}\]</span></p>
<p><span class="math inline">\(H_m\)</span> 是三对角矩阵，所以 <span
class="math inline">\(H_m\)</span> 的 LQ 分解可通过 Givens
变换完成，并且 <span class="math inline">\(H_{m+1}\)</span> 的 LQ
分解相较于 <span class="math inline">\(H_m\)</span> 而言只多了一次
Givens 变换。由此可构建递推关系。</p>
<h2 id="基于双正交化过程的一些算法">基于双正交化过程的一些算法</h2>
<p>在基于双正交化过程的算法中，类似于 FOM
的方法是双共轭梯度法（BiCG），类似于 GMRES 的方法是 QMR 方法。</p>
<p>双正交化过程通常都会将 <span
class="math inline">\(b-Ax_0\)</span>——即初值的残量——作为 <span
class="math inline">\(\beta v_0\)</span>，其中 <span
class="math inline">\(\beta:=\|b-Ax_0\|_2\)</span>，然后再任选一个不与
<span class="math inline">\(v_0\)</span> 正交的向量作为 <span
class="math inline">\(w_0\)</span>（通常也选为 <span
class="math inline">\(v_0\)</span>）。选定这两个初值后，经过双正交化过程就能得到
<span class="math inline">\(V_m\)</span>，<span
class="math inline">\(W_m\)</span> 以及 <span
class="math inline">\(T_m\)</span>。</p>
<p>BiCG 方法中，条件 (<span
class="math inline">\(\ref{Krylov_reduced_equation}\)</span>)——即 <span
class="math inline">\((W_m^{\mathrm T}AV_m)y=W_m^{\mathrm
T}(b-Ax_0)\)</span>——变为： <span class="math display">\[T_my=\beta
e_1.\]</span> 这是一个三对角线性方程组。可以证明，当 <span
class="math inline">\(A\)</span> 对称正定且 <span
class="math inline">\(w_0=v_0\)</span>
时它等价于共轭梯度法。但在很多情况下，BiCG 的稳定性并不很好。</p>
<p>QMR 算法与 GMRES 一样考虑如下最小二乘问题： <span
class="math display">\[\displaystyle\min_{x\in x_0+\mathcal
K_m}\|Ax-b\|^2_2.\]</span> 但在 QMR 算法中： <span
class="math display">\[\begin{align*}
b-Ax=&amp;\;b-A(x_0+V_my)=\beta v_0-AV_my\\
=&amp;\;\beta v_0-V_{m+1}T^{(1)}_{m+1,m}y\\
=&amp;\;V_{m+1}(\beta e_1-T^{(1)}_{m+1,m}y).
\end{align*}\]</span> 非常尴尬的是，<span
class="math inline">\(V_{m+1}\)</span> 不是正交矩阵，因此： <span
class="math display">\[\|Ax-b\|_2\leqslant\|V_{m+1}\|_2\|\beta
e_1-T^{(1)}_{m+1,m}y\|_2,\]</span> 这意味着通过求解 <span
class="math inline">\(\displaystyle\min_{y\in \mathbb R^m}\|\beta
e_1-T^{(1)}_{m+1,m}y\|_2\)</span> 得到的结果相较于 GMRES
似乎更粗糙一些。</p>
<hr />
<h1 id="参考书籍">参考书籍</h1>
<ul>
<li><a
target="_blank" rel="noopener" href="https://math.ecnu.edu.cn/~jypan/Teaching/IMP/index.html">优秀的课程</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/Optimization-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/Optimization-1/" class="post-title-link" itemprop="url">数值优化1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-09 15:10:05" itemprop="dateModified" datetime="2024-08-09T15:10:05+08:00">2024-08-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>优化问题的大致概念，以及各类优化算法的大致思路。</p>
<hr />
<h1 id="优化问题的极小条件">优化问题的极小条件</h1>
<h2 id="梯度的直观图像">梯度的直观图像</h2>
<p>函数 <span class="math inline">\(f(x)\)</span> 的梯度 <span
class="math inline">\(\nabla f(x)\)</span>
反映了这个函数上升最快的方向，大致的理解思路如下：考虑 <span
class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x_0\)</span> 附近的泰勒展开 <span
class="math display">\[f(x_0+\alpha p)\approx f(x_0)+\alpha p^{\mathrm
T}\nabla f(x_0),\]</span> 其中 <span class="math inline">\(p\)</span>
为某个单位矢量，<span class="math inline">\(\alpha&gt;0\)</span> 为在
<span class="math inline">\(p\)</span> 方向的步长。</p>
<p>等号右边第二项为向量内积，所以，当 <span
class="math inline">\(p\)</span> 与 <span class="math inline">\(\nabla
f(x_0)\)</span> 指向相同时 <span class="math inline">\(f(x)\)</span>
上升最显著，<span class="math inline">\(p\)</span> 与 <span
class="math inline">\(\nabla f(x_0)\)</span> 指向相反时 <span
class="math inline">\(f(x)\)</span> 下降最显著。</p>
<h2 id="无约束优化问题的局部极小条件">无约束优化问题的局部极小条件</h2>
<p>一个函数 <span class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x^*\)</span>
处取得局部极小值的充分条件与必要条件有：</p>
<blockquote class="colorquote theorem" ><ul>
<li><p>一阶必要条件：如果函数 <span class="math inline">\(f(x)\)</span>
的一阶导是连续的，且 <span class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x^*\)</span> 处取得局部极小，那么 <span
class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x^*\)</span> 处的一阶导为 0，即 <span
class="math inline">\(\nabla f(x)|_{x=x_0}=0\)</span>。</p></li>
<li><p>二阶必要条件：如果函数 <span class="math inline">\(f(x)\)</span>
的二阶导是连续的，且 <span class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x^*\)</span> 处取得局部极小，那么 <span
class="math inline">\(f(x)\)</span> 在 <span
class="math inline">\(x^*\)</span> 处满足一阶导 <span
class="math inline">\(\nabla f(x)|_{x=x^*}=0\)</span> 且二阶导 <span
class="math inline">\(\nabla^2f(x)|_{x=x^*}\)</span> 半正定。</p></li>
<li><p>二阶充分条件：如果函数 <span class="math inline">\(f(x)\)</span>
的二阶导连续，并且在 <span class="math inline">\(x^*\)</span>
处满足一阶导 <span class="math inline">\(\nabla
f(x)|_{x=x^*}=0\)</span>、二阶导 <span
class="math inline">\(\nabla^2f(x)|_{x=x^*}\)</span> 正定，那么 <span
class="math inline">\(x^*\)</span> 是 <span
class="math inline">\(f(x)\)</span> 的一个局部极小值点。</p></li>
</ul>
</blockquote>
<p>这些条件的理解方式很简单： <span
class="math display">\[f(x^\ast+\delta)=f(x^\ast)+\delta^{\mathrm
T}[\nabla f(x^\ast)]+\dfrac12\delta^{\mathrm T}[\nabla^2
f(x^\ast)]\delta+\cdots.\]</span> 然后比较 <span
class="math inline">\(f(x^\ast+\delta)\)</span> 与 <span
class="math inline">\(f(x^\ast)\)</span> 的大小即可：</p>
<ul>
<li><p>一阶必要条件：如果 <span class="math inline">\([\nabla
f(x^\ast)]\)</span> 不为 <span
class="math inline">\(0\)</span>，就必有某个与 <span
class="math inline">\([\nabla f(x^\ast)]\)</span> 呈钝角的 <span
class="math inline">\(\delta\)</span> 使 <span
class="math inline">\(f(x^\ast)\)</span> 下降。</p></li>
<li><p>二阶必要条件：如果 <span class="math inline">\([\nabla
f(x^\ast)]=0\)</span> 但 <span class="math inline">\([\nabla^2
f(x^\ast)]\)</span> 有负的特征值，就可以将 <span
class="math inline">\(\delta\)</span> 取为负特征值的特征向量使 <span
class="math inline">\(f(x^\ast)\)</span> 下降。</p></li>
<li><p>二阶充分条件：如果 <span class="math inline">\([\nabla^2
f(x^\ast)]\)</span> 正定，那么所有非零的 <span
class="math inline">\(\delta\)</span> 都会使得 <span
class="math inline">\(f(x^\ast+\delta)&gt;f(x^\ast)\)</span>。</p></li>
</ul>
<h2 id="kkt-条件">KKT 条件</h2>
<p>考虑以下形式的优化问题：</p>
<p><span class="math display">\[\text{最小化}\;f(x),\qquad
x\;\text{满足}\;\begin{cases}
E_i(x)=0:\quad i\in\mathcal E,\\
I_j(x)\geqslant0:\quad j\in\mathcal I.
\end{cases}\]</span></p>
<p>为此需要引入<strong>拉格朗日函数</strong></p>
<blockquote class="colorquote definition" ><p><span class="math display">\[\mathcal L(x,\lambda):=
f(x)-\sum_{i\in\mathcal E}\lambda_iE_i(x)-\sum_{j\in\mathcal
I}\lambda_jI_j(x).\]</span></p>
</blockquote>
<p>满足以下条件的点 <span class="math inline">\(x\)</span> 称为
<strong>KKT 点</strong>：</p>
<blockquote class="colorquote definition" ><ul>
<li><p><span class="math inline">\(\nabla_x\mathcal
L(x,\lambda)=0.\)</span></p></li>
<li><p>等式约束：<span class="math inline">\(E_i(x)=0\)</span> 或 <span
class="math inline">\(\nabla_{\lambda_i}\mathcal
L(x,\lambda)=0\)</span>，其中 <span class="math inline">\(i\in\mathcal
E.\)</span></p></li>
<li><p>不等式约束：<span class="math inline">\(I_j(x)\geqslant0\)</span>
且 <span class="math inline">\(\lambda_j\geqslant0\)</span> 且 <span
class="math inline">\(\lambda_jI_j(x)=0\)</span>，其中 <span
class="math inline">\(j\in\mathcal I.\)</span></p></li>
</ul>
</blockquote>
<p>在很多情况下，约束优化问题的极值点就是 KKT 点。</p>
<p>KKT 条件中，不等式约束的三个条件可通过如下方式理解：</p>
<ul>
<li><p>如果 <span class="math inline">\(I_j(x)&gt;0\)</span>，那么 <span
class="math inline">\(I_j(x)\geqslant0\)</span>
的条件实际上不起作用，这等价于没有这个约束，也就是 <span
class="math inline">\(\lambda_j=0\)</span>，所以不等式约束的三个条件都能满足。</p></li>
<li><p>如果 <span class="math inline">\(I_j(x)=0\)</span>，那么 <span
class="math inline">\(I_j(x)\geqslant0\)</span>
的条件起了作用，不等式约束的第一个和最后一个条件都能满足。所以问题的关键在于
<span class="math inline">\(\lambda_j\geqslant0\)</span>
的理解方式。</p></li>
</ul>
<p>首先，我们已经知道，梯度 <span class="math inline">\(\nabla
f(x)\)</span> 代表了 <span class="math inline">\(f(x)\)</span>
的上升方向，而 <span class="math inline">\(-\nabla f(x)\)</span>
代表了下降的方向。然后：</p>
<ul>
<li><p>如果 <span class="math inline">\(f(x)\)</span> 的极小值在
<strong>可行区域</strong>（即满足了所有约束条件的区域）的边界上取得，那么
<span class="math inline">\(-\nabla f(x)\)</span>
一定指向可行区域以外，否则其极小值就在可行区域内部取到。</p></li>
<li><p>可行区域由 <span class="math inline">\(I_j(x)\geqslant0\)</span>
确定 (<span class="math inline">\(i\in\mathcal I\)</span>)，因此 <span
class="math inline">\(\nabla I_j(x)\)</span>
一定指向可行区域内部，因为它代表了 <span
class="math inline">\(I_j(x)\)</span> 上升的方向。</p></li>
<li><p>所以 <span class="math inline">\(-\nabla f(x)\)</span> 与 <span
class="math inline">\(\nabla I_j(x)\)</span>
的方向在某种程度上应该是相反的，这就意味着，如果 <span
class="math inline">\(\nabla_x\mathcal L(x,\lambda)=0\)</span> 就必然有
<span class="math inline">\(\lambda_i\geqslant0\)</span>。</p></li>
</ul>
<p>需要注意的是，约束优化问题的极值点不一定是 KKT
点。例如有这样一个例子：</p>
<blockquote class="colorquote example" ><p><span class="math display">\[\begin{align}\label{LFD and SFD, KKT}
\text{最小化}\;f(x,y)=x,\qquad x,y\;\text{满足}
\begin{cases}
x^3-y\geqslant0\\
y\geqslant0
\end{cases}.
\end{align}\]</span></p>
</blockquote>
<p>不难想象，全局极小值点为 <span
class="math inline">\((0,0)\)</span>。这个例子的拉格朗日函数为 <span
class="math inline">\(\mathcal
L(x,y)=x-\lambda_1y-\lambda_2(x^3-y)\)</span>，由 <span
class="math inline">\(\partial\mathcal L/\partial x=0\)</span>
的条件可得 <span
class="math inline">\(1-3\lambda_2x^2=0\)</span>，全局极小值点 <span
class="math inline">\((0,0)\)</span> 不可能满足 KKT 条件。</p>
<h2 id="约束优化问题的一阶必要条件">约束优化问题的一阶必要条件</h2>
<p>要得到约束优化问题的一阶必要条件，需要先引入几个概念和引理：</p>
<blockquote class="colorquote definition" ><ul>
<li><p><strong>可行方向（FD, feasible direction）</strong>：给定 <span
class="math inline">\(x\)</span> 和方向 <span
class="math inline">\(d\)</span>，如果存在一个 <span
class="math inline">\(\delta&gt;0\)</span> 使得 <span
class="math inline">\(x\)</span> 到 <span
class="math inline">\((x+td)\)</span>
的连线上的所有的点都满足约束条件，就说 <span
class="math inline">\(d\)</span> 是 <span
class="math inline">\(x\)</span> 处的可行方向。</p></li>
<li><p><strong>序列可行方向（SFD）</strong>：如果存在序列 <span
class="math inline">\(\{(d_k,\delta_k)\}\)</span> 使得 <span
class="math inline">\(\delta_k&gt;0\)</span>，<span
class="math inline">\(\delta_k\rightarrow0\)</span>，<span
class="math inline">\(d_k\rightarrow d\)</span> 且 <span
class="math inline">\(x_k=x+\delta_kd_k\)</span>
一直满足约束条件，那么就说 <span class="math inline">\(d\)</span> 是
<span class="math inline">\(x\)</span> 的一个序列可行方向。</p></li>
<li><p><strong>线性化可行方向（LFD）</strong>：如果 <span
class="math inline">\(x\)</span> 处的某个方向 <span
class="math inline">\(d\)</span> 满足以下条件就说 <span
class="math inline">\(d\)</span> 是 <span
class="math inline">\(x\)</span> 的一个线性化可行方向： <span
class="math display">\[\begin{align*}
d^{\mathrm T}\nabla E_i(x)=0\;(i\in\mathcal E),\quad d^{\mathrm T}\nabla
I_i(x)\geqslant0\;(i\in\mathcal I),
\end{align*}\]</span></p></li>
</ul>
</blockquote>
<p>可以证明，这几个方向之间的关系为： <blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\text{FD}(x)\subseteq\text{SFD}(x)\subseteq\text{LFD}(x).
\end{align*}\]</span></p>
</blockquote></p>
<h3 id="sfd">SFD</h3>
<p>形象地来说，一个点处的 SFD
会形成一个“切锥”，它与约束条件的切线有关。例如约束条件 <span
class="math inline">\(x^2+y^2=1\)</span> 在 <span
class="math inline">\((1,0)\)</span> 处的切锥就是直线 <span
class="math inline">\(x=1\)</span> 代表的方向，约束条件 <span
class="math inline">\(-x^2-y^2\geqslant-1\)</span> 在 <span
class="math inline">\((1,0)\)</span> 处的切锥就是半平面 <span
class="math inline">\(x&lt;1\)</span>。</p>
<p>极小值点的一阶必要条件与序列可行化方向 SFD 相关：假设 <span
class="math inline">\(x^\ast\)</span> 是极小值点，然后考虑 <span
class="math display">\[\begin{align*}
\dfrac{f(x^\ast+\delta_k d_k)-f(x^\ast)}{\delta_k}=d_k^{\mathrm
T}[\nabla f(x^\ast)]+O(\delta_k),
\end{align*}\]</span> 两边取 <span
class="math inline">\(k\rightarrow\infty\)</span>
的极限就可得到约束优化问题的一阶必要条件：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align}\label{SFD-condition}
x^\ast\;\;\text{是}\;\;f(x) \text{ 的局部极小值点
}\quad\Rightarrow\quad\text{对任何 SFD 都有 }\;\;d^{\mathrm T}[\nabla
f(x^\ast)]\geqslant0.
\end{align}\]</span></p>
</blockquote>
<h3 id="lfd">LFD</h3>
<p>相较于 SFD，这里的 LFD
因为具有了明确的表达式而更好分析一些。但作为代价，LFD 相比 SFD
包含了一些额外的方向，这些方向可能指向可行区域以外：</p>
<blockquote class="colorquote example" ><ul>
<li>在 (<span class="math inline">\(\ref{LFD and SFD, KKT}\)</span>)
这个例子中，极小值点 <span class="math inline">\((0,0)\)</span> 处的 SFD
就是 <span class="math inline">\(\{(a,0):\;a&gt;0\}\)</span>，而 LFD 为
<span class="math inline">\(\{(a,0):\;a\in\mathbb R\}\)</span>，<span
class="math inline">\(\mathrm{LFD}\backslash\mathrm{SFD}\)</span>
中的方向就指向可行区域以外。</li>
<li>而在约束条件为 <span
class="math inline">\(-x^2-y^2\geqslant-1\)</span> 的例子中，<span
class="math inline">\(\mathrm{SFD}=\mathrm{LFD}\)</span>。</li>
</ul>
</blockquote>
<p>由于 LFD 可能包含指向可行区域以外的方向，所以存在这样的情形：极小值点
<span class="math inline">\(x^\ast\)</span> 点处的 SFD 中没有方向能使
<span class="math inline">\(f(x)\)</span> 下降，但 <span
class="math inline">\(x^\ast\)</span> 点处 LFD 中却有能让 <span
class="math inline">\(f(x)\)</span> 下降的方向，(<span
class="math inline">\(\ref{LFD and SFD, KKT}\)</span>)
就是这样的一个例子。</p>
<h3 id="kkt-定理">KKT 定理</h3>
<p>LFD 与 Farkas 引理相关。我们考虑 <span
class="math inline">\(x\)</span> 点处所有的具有如下形式的方向： <span
class="math display">\[\begin{align*}
S:= \left\lbrace u:\quad u=\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x)+\sum_{j\in\mathcal I}\lambda_j\nabla I_j(x)\right\rbrace.
\end{align*}\]</span> 不难发现，当 <span
class="math inline">\(x^\ast\)</span>
是我们要考虑的问题的极值点时，<span class="math inline">\(\nabla
f(x^\ast)\in S\)</span>。</p>
<p><span class="math inline">\(S\)</span>
中的方向可以分为两类，其中一类记为 <span
class="math inline">\(S_+\)</span>： <span
class="math display">\[\begin{align*}
S_+=\left\lbrace u=\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x)+\sum_{j\in\mathcal I}\lambda_j\nabla I_j(x):\quad
\lambda_j\geqslant0\;(\forall j \in \mathcal I)\right\rbrace ,
\end{align*}\]</span> 剩下的归为另一类。不难发现，<span
class="math inline">\(S_+\)</span> 是一个凸集（锥）。</p>
<p>对于 LFD 中的任意一个 <span
class="math inline">\(d\)</span>，不难想象： <span
class="math display">\[\begin{align*}
d^{\mathrm T}u=\sum_{j\in\mathcal I}\lambda_jd^{\mathrm T}\nabla
I_j(x)\geqslant0,\qquad\forall u\in S_+.
\end{align*}\]</span> 这意味着 <span class="math inline">\(S_+\)</span>
分布在以 <span class="math inline">\(d\)</span>
为法向量的超平面的一侧，不会跨过这一超平面，这就是 LFD
中的方向的几何含义。</p>
<p>现在，假设 <span class="math inline">\(\nabla f(x)\in
S\)</span>。</p>
<ul>
<li>如果存在一个 <span class="math inline">\(d\)</span> 让 <span
class="math inline">\(f(x)\)</span> 下降，即 <span
class="math inline">\(d^{\mathrm T}\nabla f&lt;0\)</span>，这就意味着
<span class="math inline">\(\nabla f\)</span> 与 <span
class="math inline">\(S_+\)</span> 分布在以 <span
class="math inline">\(d\)</span> 为法向量的超平面的两侧，也就是 <span
class="math inline">\(\nabla f\notin S_+\)</span>。</li>
<li>反之，如果 <span class="math inline">\(\nabla f\in S\)</span> 但
<span class="math inline">\(\nabla f\notin
S_+\)</span>，那么依据凸集分离定理总能找到一个平面将 <span
class="math inline">\(\nabla f\)</span> 与 <span
class="math inline">\(S_+\)</span> 分隔开，这个平面的指向 <span
class="math inline">\(S_+\)</span> 的法向量 <span
class="math inline">\(d\)</span> 满足 <span
class="math inline">\(d^{\mathrm T}\nabla f&lt;0\)</span>。</li>
</ul>
<p>这样就证明了：如果 <span class="math inline">\(\nabla f(x)\in
S\)</span>，那么 LFD 中存在一个方向 <span
class="math inline">\(d\)</span> 使 <span
class="math inline">\(d^{\mathrm T}\nabla f&lt;0\)</span> 当且仅当 <span
class="math inline">\(\nabla f\notin S_+\)</span>。因此，如果 <span
class="math inline">\(\nabla f\in S\)</span>，就有：</p>
<p><span class="math display">\[\begin{align}
\label{LFD-condition}
\text{对任何}\;\;d\in\text{LFD 都有 }\;\;d^{\mathrm T}[\nabla
f(x^\ast)]\geqslant0\quad\Rightarrow\quad [\nabla f(x^\ast)]\in S_+.
\end{align}\]</span></p>
<p>那么结合 (<span class="math inline">\(\ref{SFD-condition}\)</span>,
<span
class="math inline">\(\ref{LFD-condition}\)</span>)，我们就能得到以下一阶必要条件
(KKT 定理)：</p>
<blockquote class="colorquote theorem" ><p>如果 <span
class="math inline">\(\mathrm{SFD}=\mathrm{LFD}\)</span>，且 <span
class="math inline">\(x^\ast\)</span> 是局部极小值点，那么必然存在一组
<span class="math inline">\(\{\lambda_i\}_{i\in \mathcal E}\)</span> 与
<span class="math inline">\(\{\lambda_j\}_{j\in \mathcal
I}\)</span>，使得： <span class="math display">\[\begin{align*}
\nabla f(x^\ast)=\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x^\ast)+\sum_{j\in\mathcal I}\lambda_j\nabla I_j(x^\ast),\quad
\lambda_j\geqslant0\;(j\in\mathcal I),
\end{align*}\]</span></p>
</blockquote>
<p>所以，问题就归结于 <span
class="math inline">\(\mathrm{SFD}=\mathrm{LFD}\)</span>
何时能够成立。常见的情形有：</p>
<ul>
<li><span class="math inline">\(\{E_i\}_{i\in\mathcal
E}\cup\{I_j\}_{j\in\mathcal I}\)</span> 都是线性函数。</li>
<li>LICQ：<span class="math inline">\(\{\nabla E_i\}_{i\in\mathcal
E}\cup\{\nabla I_j\}_{j\in\mathcal I}\)</span> 线性无关。</li>
<li>Mangasarian-Fromowitz 条件：略(</li>
</ul>
<hr />
<h1 id="两种迭代法的思路">两种迭代法的思路</h1>
<p>求解优化问题的数值方法总是以迭代法为基础，即根据上一个点 <span
class="math inline">\(x_k\)</span> 的信息计算出下一个需要考虑的点 <span
class="math inline">\(x_{k+1}\)</span>，直到某一步的 <span
class="math inline">\(x_k\)</span>
达到收敛条件。迭代法的基本思路有两个：第一个思路是线搜索方法，第二个是信赖域方法。</p>
<p>线搜索方法在得到 <span class="math inline">\(x_k\)</span>
之后，先通过某种方法确定 <span class="math inline">\(x_k\)</span>
处的搜索方向 <span
class="math inline">\(p_k\)</span>，然后在这个方向上通过某种方法确定步长
<span class="math inline">\(\alpha_k\)</span>，就可得到下一个迭代点
<span class="math inline">\(x_{k+1}=x_k+\alpha_k p_k\)</span>。</p>
<p>信赖域方法用某个函数 <span class="math inline">\(m_k(x)\)</span> 近似
<span class="math inline">\(f(x)\)</span>，并假定这一近似在 <span
class="math inline">\(\|x-x_k\|\leqslant\Delta_k\)</span>
——即信赖域——的范围内成立，然后求出 <span
class="math inline">\(m_k(x)\)</span> 在信赖域内的极小值点 <span
class="math inline">\(x_{k+1}\)</span>，以此作为下一个迭代点，并依照结果调整
<span class="math inline">\(\Delta_k\)</span>。</p>
<h2 id="非精确线搜索的判定条件">非精确线搜索的判定条件</h2>
<p>在线搜索方法中，如果明确了搜索方向为 <span
class="math inline">\(p_k\)</span>，就需要选取合适的步长 <span
class="math inline">\(\alpha\)</span>
来确定下一个迭代点。一种可行的方法是精确线搜索，即求出使得 <span
class="math inline">\(f(x_k+\alpha p_k)\)</span> 取最小值的 <span
class="math inline">\(\alpha\)</span> 来作为 <span
class="math inline">\(\alpha_k\)</span>，但这种精确线搜索有时并不划算，因此需要使用非精确线搜索。在非精确线搜索中，只要一个
<span class="math inline">\(\alpha\)</span>
能够满足某些判定条件就可用于确定迭代点。</p>
<p>一个常见的判定条件是 Wolfe 条件，它由 Armijo 条件和曲率条件构成：</p>
<blockquote class="colorquote definition" ><p><strong>Armijo 条件（充分下降条件）</strong>：步长 <span
class="math inline">\(\alpha\)</span> 应该满足 <span
class="math display">\[f(x_k+\alpha p_k)\leqslant f(x_k)+c_1\alpha
p_k^{\mathrm T}\nabla f(x_k):= l(\alpha),\]</span> 其中常数 <span
class="math inline">\(c_1\)</span> 满足 <span
class="math inline">\(0&lt;c_1&lt;1\)</span>。</p>
<p><strong>曲率条件</strong>：步长 <span
class="math inline">\(\alpha\)</span> 应该满足 <span
class="math display">\[p_k^{\mathrm T}\nabla f(x_k+\alpha p_k)\geqslant
c_2p_k^{\mathrm T}\nabla f(x_k),\]</span> 其中常数 <span
class="math inline">\(c_2\)</span> 满足 <span
class="math inline">\(c_1&lt;c_2&lt;1\)</span>。</p>
</blockquote>
<p>这两个条件的含义如下：</p>
<ul>
<li><p>Armijo 条件：步长 <span class="math inline">\(\alpha\)</span>
应该使得 <span class="math inline">\(f(x)\)</span>
充分下降，如下图所示。</p></li>
<li><p>曲率条件的含义如下图所示：不等式左侧为 <span
class="math inline">\(\mathrm d f(x_k+\alpha p_k)/\mathrm
d\alpha\)</span>，不等式右侧为 <span
class="math inline">\(\alpha=0\)</span> 处的 <span
class="math inline">\(\mathrm d f(x_k+\alpha p_k)/\mathrm
d\alpha\)</span>，后者是负的，前者应该比后者更大一些，以便更加接近极小值点。</p></li>
</ul>
<center>
<p><img src="/picture/Wolfe_condition.png" width="75%"></p>
<div
style="display: inline-block; width: 75%; text-align: left; color: #999999; font-size: 8">
<p>Wolfe 条件示意图。 斜率 desired slope 就是 <span
class="math inline">\(f(x_k+\alpha p_k)\)</span> 对 <span
class="math inline">\(\alpha\)</span> 的导数。斜线 <span
class="math inline">\(l(\alpha)\)</span> 是 <span
class="math inline">\(l(\alpha):= f(x_k)+c_1\alpha p_k^{\mathrm T}\nabla
f(x_k)\)</span>。区间 acceptable 就是同时满足这两个条件的 <span
class="math inline">\(\alpha\)</span>：既要让 <span
class="math inline">\(f(x_k+\alpha p_k)\)</span> 位于 <span
class="math inline">\(l(\alpha)\)</span> 下方，又要让 <span
class="math inline">\(f(x_k+\alpha p_k)\)</span> 的斜率相较 <span
class="math inline">\(p_k^{\mathrm T}\nabla f(x_k)\)</span>
更大一些。</p>
</div>
</center>
<p>可以看到，曲率条件也会筛选出那些使得 <span
class="math inline">\(\mathrm d f(x_k+\alpha p_k)/\mathrm
d\alpha&gt;0\)</span> 的 <span
class="math inline">\(\alpha\)</span>。<strong>强 Wolfe 条件</strong>
将曲率条件修改为 <span class="math display">\[\left| p_k^{\mathrm
T}\nabla f(x_k+\alpha p_k)\right| \geqslant\left|  c_2p_k^{\mathrm
T}\nabla f(x_k)\right|,\]</span> 以便将这些 <span
class="math inline">\(\alpha\)</span> 排除出去。</p>
<h2 id="信赖域方法">信赖域方法</h2>
<h3 id="一般思路">一般思路</h3>
<p>信赖域方法就是用一个函数 <span class="math inline">\(m_k\)</span>
来近似第 <span class="math inline">\(k\)</span> 步迭代点 <span
class="math inline">\(x_k\)</span> 附近的 <span
class="math inline">\(f(x)\)</span>，并假设这一近似在 <span
class="math inline">\(\|x-x_k\|&lt;\Delta_k\)</span>
的范围内（即信赖域以内）成立。通常将 <span
class="math inline">\(m_k\)</span> 取为二次函数： <span
class="math display">\[\begin{align}\label{trust-region-problem}
m_k(x)=\dfrac12(x-x_k)^{\mathrm T}G_k(x-x_k)-b_k^{\mathrm
T}(x-x_k)+(\cdots),\quad \|x-x_k\|\leqslant\Delta_k.
\end{align}\]</span></p>
<p>信赖域方法通常会通过某种方式在信赖域内部找出下一个迭代点 <span
class="math inline">\(x_{k+1}\)</span> 使它满足 <span
class="math inline">\(m_k(x_{k+1})&lt;m_k(x_k)\)</span>，并计算 <span
class="math display">\[\begin{align*}
\rho_k:=\dfrac{f(x_k)-f(x_{k+1})}{m_k(x_k)-m_k(x_{k+1})},
\end{align*}\]</span> 然后根据 <span
class="math inline">\(\rho_k\)</span>
的大小确定下一步的要做的两件事情：</p>
<blockquote class="colorquote algorithm" ><ul>
<li><p>调整信赖域大小：</p>
<ul>
<li><p>如果 <span class="math inline">\(\rho_k&lt;1/4\)</span>：这说明
<span class="math inline">\(m_k(x)\)</span> 并不能很好地近似 <span
class="math inline">\(f(x)\)</span>，下一步需要缩小信赖域的范围，例如取
<span
class="math inline">\(\Delta_{k+1}=\Delta_{k}/4\)</span>。</p></li>
<li><p>如果 <span
class="math inline">\(1/4&lt;\rho_k&lt;3/4\)</span>：那么 <span
class="math inline">\(m_k(x)\)</span> 作为 <span
class="math inline">\(f(x)\)</span>
的近似不好不坏，信赖域在下一步迭代时不变：<span
class="math inline">\(\Delta_{k+1}=\Delta_{k}\)</span>。</p></li>
<li><p>如果 <span class="math inline">\(\rho_k&gt;3/4\)</span>：那么
<span class="math inline">\(m_k(x)\)</span> 是 <span
class="math inline">\(f(x)\)</span>
的很好的近似，在下一步迭代时可以适当扩大信赖域的范围，例如取 <span
class="math inline">\(\Delta_{k+1}=2\Delta_{k}\)</span>。</p></li>
</ul></li>
<li><p>选取下一个迭代点：</p>
<ul>
<li><p>如果 <span class="math inline">\(\rho_k&lt;\eta\)</span>（<span
class="math inline">\(\eta\)</span> 为某个位于 <span
class="math inline">\(0\sim1/4\)</span> 间的常数），这一步迭代并没有让
<span class="math inline">\(f(x)\)</span> 发生足够的下降甚至让 <span
class="math inline">\(f(x)\)</span> 发生了上升，因此 <span
class="math inline">\(x_{k+1}\)</span>
不能作为下一个迭代点。此时需要做回退 <span
class="math inline">\(x_{k+1}=x_k\)</span> 并在调整信赖域大小后重新计算
<span class="math inline">\(x_{k+1}\)</span>。</p></li>
<li><p>如果 <span class="math inline">\(\rho_k&gt;\eta\)</span>
那么就可以接受 <span class="math inline">\(x_{k+1}\)</span>
作为新的迭代点。</p></li>
</ul></li>
</ul>
</blockquote>
<p><span id="Levenberg-Marquardt"></p>
<h3
id="另一种思路levenberg-marquardt-方法">另一种思路（Levenberg-Marquardt
方法）</h3>
<p></span></p>
<p>最小化 (<span
class="math inline">\(\ref{trust-region-problem}\)</span>)
可被视为是一个约束优化问题。如果将信赖域取为 <span
class="math inline">\(\|x-x_k\|_2^2\leqslant\Delta_k^2\)</span>，那么这一问题的
KKT 条件为： <span
class="math display">\[\begin{align}\label{LM-method-KKT-condition}
(G_k+\lambda_k I)(x-x_k)=b_k,\quad \lambda_k\geqslant0,\quad
\lambda_k(\|x-x_k\|_2-\Delta_k)=0.
\end{align}\]</span></p>
<p>如果 <span class="math inline">\(G\)</span>
是对称正定的，那么就有一种求解这一约束优化问题的有趣思路。容易看出（通过矩阵对角化），<span
class="math inline">\(\lambda_k\)</span> 越大，求解 (<span
class="math inline">\(\ref{LM-method-KKT-condition}\)</span>)
的第一个式子给出的 <span class="math inline">\(\|x-x_k\|_2\)</span>
就越小，因此，<span class="math inline">\(\lambda_k\)</span>
也可以起到类似于 <span class="math inline">\(\Delta_k\)</span>
的作用。</p>
<p>于是，我们有如下魔改版的信赖域方法：</p>
<blockquote class="colorquote algorithm" ><ul>
<li><p>选定一个 <span class="math inline">\(\lambda_k\)</span>，求解
(<span class="math inline">\(\ref{LM-method-KKT-condition}\)</span>)
的第一个式子得到 <span class="math inline">\(x_{k+1}\)</span>，并计算
<span class="math inline">\(\rho_k\)</span>。</p>
<ul>
<li><p>如果 <span
class="math inline">\(\rho_k&lt;1/4\)</span>：在下一步中选取 <span
class="math inline">\(\lambda_{k+1}=4\lambda_k\)</span>
达到缩小信赖域的效果。</p></li>
<li><p>如果 <span
class="math inline">\(1/4&lt;\rho_k&lt;3/4\)</span>：在下一步中选取
<span class="math inline">\(\lambda_{k+1}=\lambda_k\)</span>。</p></li>
<li><p>如果 <span
class="math inline">\(\rho_k&gt;3/4\)</span>：在下一步中选取 <span
class="math inline">\(\lambda_{k+1}=\lambda_k/2\)</span>
达到扩大信赖域的效果。</p></li>
</ul></li>
<li><p>选取下一个迭代点：同一般思路</p></li>
</ul>
</blockquote>
<hr />
<h1 id="无约束优化问题的拟牛顿法">无约束优化问题的拟牛顿法</h1>
<h2 id="牛顿法的基本思路">牛顿法的基本思路</h2>
<p>牛顿法的基本思路是：对 <span class="math inline">\(\nabla
f(x)\)</span> 做以下近似： <span class="math display">\[\begin{align*}
\nabla f(x)\approx \nabla f(x_k)+[\nabla^2f(x_k)] (x-x_k),
\end{align*}\]</span> 然后通过 <span class="math inline">\(\nabla
f(x_{k+1})=0\)</span> 的条件将下一步的迭代点选为：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align}\label{Newton-method}
x_{k+1}=x_k-\alpha_k[\nabla^2f(x_k)]^{-1}\nabla f(x_k).
\end{align}\]</span></p>
</blockquote>
<p><span class="math inline">\(\alpha_k=1\)</span> 或由线搜索确定。</p>
<p>搜索方向 <span class="math inline">\(d_k=-[\nabla^2f(x_k)]^{-1}\nabla
f(x_k)\)</span> 通常由求解如下线性方程组确定： <span
class="math display">\[\begin{align*}
[\nabla^2f(x_k)]d=-\nabla f(x_k).
\end{align*}\]</span>
在问题规模较大时，严格求解这一线性方程组往往是很困难的，并且还可能是没有必要的，因此我们可以借用其他方法近似求解这一线性方程组。
在 python 的 scipy.optimize.minimize 函数中，Newton-CG
方法的思想就是用做了某些小修正的共轭梯度法求解这一方程组，trust-ncg
方法可被视为是结合了信赖域方法的 Newton-CG 方法，而 trust-krylov 与
trust-exact 则使用了其他方法求解信赖域方法中需要用到的步长。</p>
<h2 id="拟牛顿法的基本思路">拟牛顿法的基本思路</h2>
<p>牛顿法需要计算二阶导，代价比较大。拟牛顿法的思路就是用一系列比较好算的矩阵
<span class="math inline">\(B_k\)</span> 来近似二阶导 <span
class="math inline">\([\nabla^2f(x_k)]\)</span>，或者用一系列比较好算的矩阵
<span class="math inline">\(H_k\)</span> 来近似二阶导 <span
class="math inline">\([\nabla^2f(x_k)]^{-1}\)</span>。</p>
<p>拟牛顿法在最开始做迭代时，采用 <span
class="math inline">\([\nabla^2f(x_0)]\)</span> 或 <span
class="math inline">\([\nabla^2f(x_0)]^{-1}\)</span> 来作为 <span
class="math inline">\(B_0\)</span> 或 <span
class="math inline">\(H_0\)</span>；在从 <span
class="math inline">\(x_k\)</span> 得到 <span
class="math inline">\(x_{k+1}\)</span> 之后，对 <span
class="math inline">\(B_k\)</span> 或 <span
class="math inline">\(H_k\)</span> 做出修正得到 <span
class="math inline">\(B_{k+1}\)</span> 或 <span
class="math inline">\(H_{k+1}\)</span> 用于下一步的迭代。要让 <span
class="math inline">\(B_k\)</span> 或 <span
class="math inline">\(H_k\)</span> 一直成为 <span
class="math inline">\([\nabla^2f(x_k)]\)</span> 或 <span
class="math inline">\([\nabla^2f(x_k)]^{-1}\)</span>
的好的近似，就需要让它们满足拟牛顿条件。</p>
<p>我们定义： <span class="math display">\[\begin{align*}
y_k:= \nabla f(x_{k+1})-\nabla f(x_k),\quad s_k:= x_{k+1} - x_k.
\end{align*}\]</span> 显然，二阶导数近似地满足： <span
class="math display">\[\begin{align*}
\nabla f(x_k)\approx \nabla f(x_{k+1})+[\nabla^2f(x_{k+1})]
(x_k-x_{k+1}),\quad \text{或}\quad [\nabla^2f(x_{k+1})]s_k=y_k.
\end{align*}\]</span> 拟牛顿条件就是：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align}\label{secant condition}
B_{k+1}s_k=y_k,\quad \text{或}\quad s_k=H_{k+1}y_k.
\end{align}\]</span></p>
</blockquote>
<h2 id="三种常用的修正">三种常用的修正</h2>
<h3 id="sr1-修正">SR1 修正</h3>
<p>最简单的对 <span class="math inline">\(B_k\)</span> 或 <span
class="math inline">\(H_k\)</span> 做出修正得到 <span
class="math inline">\(B_{k+1}\)</span> 或 <span
class="math inline">\(H_{k+1}\)</span> 的方法是 SR1（对称秩
1）修正。其思路如下：假设 <span class="math display">\[\begin{align*}
B_{k+1}=B_k+u_ku_k^{\mathrm T}.
\end{align*}\]</span> <span class="math inline">\(B_{k+1}\)</span> 与
<span class="math inline">\(B_k\)</span> 只相差一个秩为 <span
class="math inline">\(1\)</span>
的对称矩阵，这就是这一方法的名称的来源。于是由拟牛顿条件 (<span
class="math inline">\(\ref{secant condition}\)</span>) 可以得到： <span
class="math display">\[\begin{align*}
u_k(u_k^{\mathrm T}s_k)+B_ks_k=y_k.
\end{align*}\]</span> 注意到 <span class="math inline">\((u_k^{\mathrm
T}s_k)\)</span> 是常数，所以 <span class="math inline">\(u_k\)</span>
的形式必然为 <span
class="math inline">\(u_k=a(y_k-B_ks_k)\)</span>。代入以上表达式就不难算出
<span class="math inline">\(a^2=1/[(y_k-B_ks_k)^{\mathrm
T}s_k]\)</span>，这样就得到了 <span
class="math inline">\(B_{k+1}\)</span>。<span
class="math inline">\(H_{k+1}\)</span> 可通过一样的方法得到。</p>
<p>SR1 修正的最终表达式为：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\begin{split}
\text{SR1}:\quad B_{k+1}=&amp;\;B_k+\dfrac{1}{(y_k-B_ks_k)^{\mathrm
T}s_k}(y_k-B_ks_k)(y_k-B_ks_k)^{\mathrm T},\\
\text{SR1}:\quad H_{k+1}=&amp;\;H_k+\dfrac{1}{(s_k-H_ky_k)^{\mathrm
T}y_k}(s_k-H_ky_k)(s_k-H_ky_k)^{\mathrm T}.
\end{split}
\end{align*}\]</span></p>
</blockquote>
<p>SR1 方法的问题在于，并不能保证 <span
class="math inline">\(B_{k+1}\)</span> 或 <span
class="math inline">\(H_{k+1}\)</span> 的正定性。</p>
<h3 id="bfgs-与-dfp-修正">BFGS 与 DFP 修正</h3>
<p>另两套重要的修正方法是 BFGS 与 DFP 修正。BFGS 方法的思路如下：假设
<span class="math display">\[\begin{align*}
B_{k+1}=B_k+u_ku_k^{\mathrm T}+v_kv_k^{\mathrm T}.
\end{align*}\]</span> 由拟牛顿条件可得： <span
class="math display">\[\begin{align*}
y_k=B_ks_k+u_k(u_k^{\mathrm T}s_k)+v_k(v_k^{\mathrm T}s_k).
\end{align*}\]</span> 假设 <span
class="math inline">\(u_k=aB_ks_k\)</span>、<span
class="math inline">\(v_k=b y_k\)</span>，不难算出 <span
class="math inline">\(a^2=-1/[(B_ks_k)^{\mathrm T}s_k]\)</span>、<span
class="math inline">\(b^2=1/(y_k^{\mathrm T}s_k)\)</span>，这样就得到了
BFGS 修正。</p>
<p>DFP 修正就是对 <span class="math inline">\(H_k\)</span>
做同样的流程，最终的结果是：</p>
<blockquote class="colorquote theorem" ><p><span class="math display">\[\begin{align*}
\begin{split}
\text{BFGS}:\quad&amp;B_{k+1}=B_k-\dfrac{1}{(B_ks_k)^{\mathrm
T}s_k}(B_ks_k)(B_ks_k)^{\mathrm T}+\dfrac{1}{y_k^{\mathrm
T}s_k}y_ky_k^{\mathrm T},\\
\text{DFP}:\quad&amp;H_{k+1}=H_k-\dfrac{1}{(H_ky_k)^{\mathrm
T}y_k}(H_ky_k)(H_ky_k)^{\mathrm T}+\dfrac{1}{s_k^{\mathrm
T}y_k}s_ks_k^{\mathrm T}.
\end{split}
\end{align*}\]</span></p>
</blockquote>
<p>在处理大规模问题时，每次都重新计算 <span
class="math inline">\(B_k\)</span>
是不合适的，一个可取的方法是记录下最近的若干个 <span
class="math inline">\(u_k\)</span> 与 <span
class="math inline">\(v_k\)</span>，这样就不需要再计算 <span
class="math inline">\(B_k\)</span>。这就是所谓的有限内存 (limited
memory) BFGS (L-BFGS) 法的大致思路。</p>
<h1 id="无约束优化问题的共轭梯度法">无约束优化问题的共轭梯度法</h1>
<h2 id="二次函数的共轭梯度法">二次函数的共轭梯度法</h2>
<p>现在，考虑二次函数的无约束优化问题： <span
class="math display">\[\begin{align}\label{quadratic-problem}
f(x)=\dfrac12 x^{\mathrm T}Gx-b^{\mathrm T}x,
\end{align}\]</span> 其中 <span class="math inline">\(G\)</span>
为对称正定矩阵。</p>
<h3 id="基本思路">基本思路</h3>
<p>我们可以指定 <span class="math inline">\(n\)</span>
个线性无关的方向（<span class="math inline">\(n\)</span> 为 <span
class="math inline">\(x\)</span> 的维数）<span
class="math inline">\(p_{1\sim n}\)</span>，使其满足： <span
class="math display">\[\begin{align*}
p^{\mathrm T}_iGp_j=\delta_{ij}(p^{\mathrm T}_iGp_i),
\end{align*}\]</span> 很容易看出来，<span
class="math inline">\(p_i\)</span> 线性无关，且构成了 <span
class="math inline">\(\mathbb R^n\)</span> 的一组 <span
class="math inline">\(G\)</span>-正交基——如果将矢量内积 <span
class="math inline">\(\langle x,y\rangle\)</span> 定义为 <span
class="math inline">\(x^{\mathrm T}Gy\)</span> 的话。</p>
<p>由于 <span class="math inline">\(p_i\)</span> 是一组基，所以最小化
(<span class="math inline">\(\ref{quadratic-problem}\)</span>)
时选取的初值 <span class="math inline">\(x_0\)</span> 与严格最小值 <span
class="math inline">\(x^\ast\)</span> 之间的差异一定可以用 <span
class="math inline">\(p_i\)</span> 线性表示出来： <span
class="math display">\[\begin{align*}
x_0=x^\ast-\sum_{i=0}^{n-1} \alpha_ip_i.
\end{align*}\]</span> 共轭梯度法生成如下序列： <span
class="math display">\[\begin{align}\label{CG x_k}
x_k=x^\ast-\sum_{i=k}^{n-1} \alpha_ip_i=x_{k-1}+\alpha_{k-1}p_{k-1},
\end{align}\]</span> 使得 <span class="math inline">\(n\)</span>
步迭代后的 <span class="math inline">\(x_{n}\)</span> 就等于 <span
class="math inline">\(x^\ast\)</span>。也就是说，共轭梯度法在第 <span
class="math inline">\(k\)</span> 步迭代的时候会消除 <span
class="math inline">\(x_0\)</span> 与 <span
class="math inline">\(x^\ast\)</span> 在 <span
class="math inline">\(p_k\)</span> 方向上的差异，遍历完全部的 <span
class="math inline">\(n\)</span> 个方向之后，<span
class="math inline">\(x_n\)</span> 自然就会等于 <span
class="math inline">\(x^\ast\)</span>。</p>
<p>共轭梯度法并不是在一开始就确定了全部的 <span
class="math inline">\(p_k\)</span>，<span
class="math inline">\(p_k\)</span> 的具体形式需要在计算出 <span
class="math inline">\(x_{0\sim k}\)</span>，<span
class="math inline">\(p_{0\sim (k-1)}\)</span> 以及 <span
class="math inline">\(r_{0\sim k}\)</span> 之后才能确定（因为 <span
class="math inline">\(p_k\)</span> 是用于从 <span
class="math inline">\(x_k\)</span> 得到 <span
class="math inline">\(x_{k+1}\)</span> 的），其中 <span
class="math inline">\(r_k\)</span> 表示 <span
class="math inline">\(x_k\)</span> 处的梯度： <span
class="math display">\[\begin{align*}
r_k:= Gx_k-b.
\end{align*}\]</span></p>
<h3 id="p_k-的选取"><span class="math inline">\(p_k\)</span> 的选取</h3>
<p>以下我们就来讨论 <span class="math inline">\(p_k\)</span>
的选取方式。如果 <span class="math inline">\(r_k\)</span> 在某一步变为
<span class="math inline">\(0\)</span>
就意味着我们已经找到了原二次函数的极值点。如果不为 <span
class="math inline">\(0\)</span>，那么，由 (<span
class="math inline">\(\ref{CG x_k}\)</span>) 以及 <span
class="math inline">\(Gx^\ast=b\)</span> 可以发现 <span
class="math display">\[\begin{align}\label{CG-r_k}
r_k=\left(Gx^\ast-\sum_{i=k}^{n-1}
\alpha_iGp_i\right)-b=-\sum_{i=k}^{n-1} \alpha_iGp_i.
\end{align}\]</span></p>
<p>由于 <span class="math inline">\(p_i\)</span> 应该是 <span
class="math inline">\(G\)</span>-正交的，所以 <span
class="math inline">\(p_{0\sim(k-1)}^{\mathrm T}r_k=0\)</span>，这意味着
<span class="math inline">\(r_k\)</span> 中必定包含了独立于 <span
class="math inline">\(p_0\sim p_{k-1}\)</span>
以外的方向，于是我们可以从 <span class="math inline">\(r_k\)</span>
中提取出一个方向作为 <span class="math inline">\(p_k\)</span>。</p>
<p>我们假定 <span class="math inline">\(p_k\)</span> 具有如下形式：
<span class="math display">\[\begin{align}\label{p_k-form}
p_k=-r_k+\beta_kp_{k-1}+\sum_{j=0}^{k-2}\gamma_{k,j}p_j.
\end{align}\]</span> 系数 <span
class="math inline">\(\beta_k,\gamma_{k,j}\)</span> 应当使 <span
class="math inline">\(p^{\mathrm
T}_{0\sim(k-1)}Gp_k=0\)</span>。可以证明， 符合这一条件的系数为： <span
class="math display">\[\gamma_{k,j}=0,\]</span> 以及 <span
class="math display">\[\begin{align}\label{CG-beta_k}
\beta_k=\dfrac{r_k^{\mathrm T}(r_k-r_{k-1})}{p_{k-1}^{\mathrm
T}(r_k-r_{k-1})}=\dfrac{r_k^{\mathrm T}(r_k-r_{k-1})\quad \text{或}\quad
r_k^{\mathrm T}r_k}{p_{k-1}^{\mathrm T}(r_k-r_{k-1})\quad \text{或}\quad
(-p_{k-1}^{\mathrm T}r_{k-1})\quad\text{或}\quad r_{k-1}^{\mathrm
T}r_{k-1}},
\end{align}\]</span> 此外，这样定出的 <span
class="math inline">\(p_k\)</span> 满足： <span
class="math display">\[p_{i=0\sim(k-1)}^{\mathrm T}r_k=0,\quad
r_{i=0\sim(k-1)}^{\mathrm T}r_k=0.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>首先证明 <span class="math inline">\(\gamma_{k,j}\)</span> 全部为
<span class="math inline">\(0\)</span>。</p>
<p>为此，我们在 (<span class="math inline">\(\ref{p_k-form}\)</span>)
式两侧同时左乘 <span class="math inline">\(p_j^{\mathrm T}G\)</span>：
<span class="math display">\[\begin{align*}
(p_j^{\mathrm T}Gp_j)\gamma_{k,j}=&amp;\;p_j^{\mathrm
T}Gp_k+p_j^{\mathrm T}Gr_k-\beta p_j^{\mathrm T}Gp_{k-1}=p_j^{\mathrm
T}Gr_k\\
=&amp;\;\dfrac{1}{\alpha_j}(x_{j+1}-x_j)^{\mathrm T}Gr_k\\
=&amp;\;\dfrac{1}{\alpha_j}(r_{j+1}-r_j)^{\mathrm T}r_k.
\end{align*}\]</span> 其中 <span
class="math inline">\(j=0\sim(k-2)\)</span>。不难看出，只需证明 <span
class="math inline">\(r_{i=0\sim(k-1)}^{\mathrm T}r_k=0\)</span>
就能完成证明。</p>
<p>(<span class="math inline">\(\ref{CG-r_k}\)</span>) 告诉我们 <span
class="math inline">\(r_k\)</span> 是 <span
class="math inline">\(Gp_{k\sim(n-1)}\)</span> 的线性组合，因此如果
<span class="math inline">\(i&lt;k\)</span> 就一定有： <span
class="math display">\[p_{i=0\sim(k-1)}^{\mathrm T}r_k=0.\]</span></p>
<p>从我们选取的 (<span class="math inline">\(\ref{p_k-form}\)</span>)
可以看出，<span class="math inline">\(r_i\)</span> 是 <span
class="math inline">\(p_{0\sim i}\)</span> 的线性组合，因此： <span
class="math display">\[r_{i=0\sim(k-1)}^{\mathrm T}r_k=0.\]</span>
这样就完成了证明。</p>
<hr />
<p>由于 <span class="math inline">\(\gamma_{k,j}\)</span> 全部为 <span
class="math inline">\(0\)</span>，所以 <span
class="math inline">\(p_k\)</span> 的形式为： <span
class="math display">\[\begin{align*}
p_k=-r_k+\beta_kp_{k-1}.
\end{align*}\]</span> 再结合 <span
class="math inline">\(p_{k-1}^{\mathrm T}Gp_k=0\)</span> 的条件可以算出
<span class="math inline">\(\beta_k\)</span>： <span
class="math display">\[\begin{align*}
\beta_k=\dfrac{p^{\mathrm T}_{k-1}Gr_k}{p_{k-1}^{\mathrm
T}Gp_{k-1}}=\dfrac{r_k^{\mathrm T}Gp_{k-1}}{p_{k-1}^{\mathrm
T}Gp_{k-1}}.
\end{align*}\]</span> 从 (<span
class="math inline">\(\ref{CG-r_k}\)</span>) 可以看出 <span
class="math inline">\(r_k=r_{k-1}+\alpha_{k-1}Gp_{k-1}\)</span>，所以
<span
class="math inline">\(Gp_{k-1}\propto(r_k-r_{k-1})\)</span>，因此以上表达式也可以写为：
<span class="math display">\[\begin{align*}
\beta_k=\dfrac{r_k^{\mathrm T}(r_k-r_{k-1})}{p_{k-1}^{\mathrm
T}(r_k-r_{k-1})}=\dfrac{r_k^{\mathrm T}(r_k-r_{k-1})\quad \text{或}\quad
r_k^{\mathrm T}r_k}{p_{k-1}^{\mathrm T}(r_k-r_{k-1})\quad \text{或}\quad
(-p_{k-1}^{\mathrm T}r_{k-1})\quad\text{或}\quad r_{k-1}^{\mathrm
T}r_{k-1}},
\end{align*}\]</span> 第二个等号用到了 <span
class="math inline">\(r_k^{\mathrm T}r_{0\sim(k-1)}=0\)</span>、<span
class="math inline">\(p_{0\sim(k-1)}^{\mathrm T}r_k=0\)</span>
等各类结果。这一结果的重要之处在于：<span
class="math inline">\(\beta_k\)</span> 的表达式中可以摆脱二阶导 <span
class="math inline">\(G\)</span>。</p>

    </div>
</div>
<h3 id="alpha_k-的选取"><span class="math inline">\(\alpha_k\)</span>
的选取</h3>
<p>在明确了 <span class="math inline">\(\beta_k\)</span>
之后，我们可以考虑 <span class="math inline">\(f(x_k+\alpha
p_k)\)</span>： <span class="math display">\[\begin{align*}
f(x_k+\alpha p_k)=\dfrac12p_k^{\mathrm T}Gp_k\alpha^2+p_k^{\mathrm
T}(Gx_k-b)\alpha+(\cdots),
\end{align*}\]</span> <span class="math inline">\(\alpha_k\)</span>
应该让 <span class="math inline">\(f(x_k+\alpha p_k)\)</span>
取极小值以便消除 <span class="math inline">\(x_k\)</span> 与 <span
class="math inline">\(x^\ast\)</span> 在 <span
class="math inline">\(p_k\)</span> 方向上的差距： <span
class="math display">\[\begin{align}\label{CG alpha_k}
\alpha_k=-\dfrac{p_k^{\mathrm T}r_k}{p_k^{\mathrm T}Gp_k}.
\end{align}\]</span></p>
<p>总结一下，二次函数的共轭梯度法的流程大致为： <span
class="math display">\[x_k\rightarrow r_k\rightarrow p_k\rightarrow
\alpha_k\rightarrow x_{k+1}(=x_k+\alpha_kp_k).\]</span></p>
<h2 id="非二次函数的共轭梯度法">非二次函数的共轭梯度法</h2>
<p>非二次函数的共轭梯度法直接使用 (<span
class="math inline">\(\ref{p_k-form}\)</span>, <span
class="math inline">\(\ref{CG-beta_k}\)</span>) 算出 <span
class="math inline">\(p_k\)</span> 作为搜索方向（<span
class="math inline">\(\gamma_{k,j}=0\)</span>，<span
class="math inline">\(r_k\)</span> 就直接取为 <span
class="math inline">\(x_k\)</span> 的导数），然后在 <span
class="math inline">\(p_k\)</span>
方向做线搜索进而得到下一个迭代点。</p>
<hr />
<h1 id="其他问题与算法">其他问题与算法</h1>
<h2 id="最小二乘问题">最小二乘问题</h2>
<h3 id="一般的最小二乘问题">一般的最小二乘问题</h3>
<p>最小二乘问题的被优化函数 <span class="math inline">\(f(x)\)</span>
一般具有如下形式： <span class="math display">\[\begin{align*}
f(x)=\dfrac12\sum_{i=1}^m [r_i(x)]^2,\quad m&gt;n\;(n\text{ 为
}\;x\text{ 的维数}).
\end{align*}\]</span> 我们可以将 <span class="math inline">\(r_{i=1\sim
m}\)</span> 排成列向量，我们还可以定义一个 <span
class="math inline">\(m\)</span> 行 <span
class="math inline">\(n\)</span> 列的矩阵 <span
class="math inline">\(J\)</span>，使其第 <span
class="math inline">\(i\)</span> 行就是排成行向量的 <span
class="math inline">\(\nabla r_i(x)\)</span>： <span
class="math display">\[\begin{align*}
r(x):=[r_1,r_2,\cdots,r_m]^{\mathrm T},\quad J(x):=[\nabla r_1,\nabla
r_2,\cdots,\nabla r_m]^{\mathrm T}.
\end{align*}\]</span> 不难看出，<span
class="math inline">\(f(x)\)</span> 的一阶导和二阶导分别为： <span
class="math display">\[\begin{align*}
\nabla f(x) = J(x)^{\mathrm T}r(x),\quad \nabla^2f(x)=J(x)^{\mathrm
T}J(x)+\sum_{i=1}^mr_i(x)\nabla^2r_i(x).
\end{align*}\]</span></p>
<p>线性最小二乘问题可以用牛顿法处理。在牛顿法的流程中，如果近似地认为
<span class="math display">\[\begin{align*}
\nabla^2f(x)\approx J^{\mathrm T}(x)J(x),
\end{align*}\]</span> 也就是忽略 <span class="math inline">\(\nabla
f(x)\)</span> 中的第二项，就得到了高斯-牛顿法。这一方法非常适用于 <span
class="math inline">\(r_i(x)\)</span>
都比较小或都比较接近线性函数的情形。</p>
<p>另一种重要的方法是 Levenberg-Marquardt 方法，其基本思路就是 <a
href="#Levenberg-Marquardt">Levenberg-Marquardt 方法小节</a>
所描述的思路。事实上，Levenberg-Marquardt
方法可被视为是信赖域方法的起源之一。稍加改进的 Levenberg-Marquardt
方法是现在处理无约束最小二乘问题的最优方法。</p>
<h3 id="线性最小二乘问题">线性最小二乘问题</h3>
<p>最简单的最小二乘问题就是线性最小二乘问题，这里的被优化函数的形式是：
<span class="math display">\[\begin{align*}
f(x)=\dfrac12(Jx-y)^{\mathrm T}(Jx-y).
\end{align*}\]</span></p>
<p>我们可以用 QR 分解的思路处理线性最小二乘问题。假设 <span
class="math inline">\(J\)</span> 的 QR 分解为： <span
class="math display">\[\begin{align*}
J=Q_{m\times m}\begin{bmatrix}R_{n\times n}\\0_{(m-n)\times
n}\end{bmatrix}=\begin{bmatrix}(Q_1)_{m\times n}&amp;(Q_2)_{m\times
(m-n)}\end{bmatrix}\begin{bmatrix}R_{n\times n}\\0_{(m-n)\times
n}\end{bmatrix}
\end{align*}\]</span> 于是： <span class="math display">\[\begin{align*}
f(x)=\dfrac12(Q^{\mathrm T}Jx-Q^{\mathrm T}y)^{\mathrm T}(Q^{\mathrm
T}Jx-Q^{\mathrm T}y)=\dfrac12\|Rx-Q_1^{\mathrm
T}y\|^2+\dfrac12\|Q_2^{\mathrm T}y\|^2.
\end{align*}\]</span>
这意味着，线性最小二乘问题的解就是如下线性方程组的解： <span
class="math display">\[\begin{align*}
Rx=Q_1^{\mathrm T}y.
\end{align*}\]</span></p>
<p>我们也可以在以上方程组两边同时乘以 <span
class="math inline">\(R^{\mathrm T}\)</span>。注意到 <span
class="math inline">\(R^{\mathrm T}R=J^{\mathrm T}J\)</span>，<span
class="math inline">\(R^{\mathrm T}Q_1^{\mathrm T}=(Q_1R)^{\mathrm
T}=J^{\mathrm T}\)</span>，所以以上方程组也就等价于： <span
class="math display">\[\begin{align*}
J^{\mathrm T}Jx=J^{\mathrm T}y.
\end{align*}\]</span> <span class="math inline">\(J^{\mathrm
T}J\)</span> 总是对称半正定的，所以可通过 Cholesky
分解等方法求解这一线性方程组。</p>
<p>另一种思路是对 <span class="math inline">\(J\)</span> 做 SVD
分解，再参考 QR 分解的思路。</p>
<h2 id="线性规划问题的单纯形法">线性规划问题的单纯形法</h2>
<h3 id="线性规划问题">线性规划问题</h3>
<p>优化目标与约束条件都是 <span class="math inline">\(x\)</span>
的线性函数的优化问题就是线性规划问题。线性规划问题的标准形式为； <span
class="math display">\[\begin{align}
\text{最小化}\;\;c^{\mathrm T}x,\qquad x\;\text{满足}\;
\begin{cases}
x\geqslant0\\
Ax=b
\end{cases}.
\end{align}\]</span> 其中 <span class="math inline">\(A\)</span> 为
<span class="math inline">\(m\times n\)</span> 的行满秩矩阵。</p>
<p>对于形如 <span class="math inline">\(a&#39;^{\mathrm T}x\geqslant
b&#39;\)</span> 这样的不等式约束，我们可以引入松弛变量 <span
class="math inline">\(x&#39;\geqslant0\)</span> 来使其变为 <span
class="math inline">\(a^{\mathrm T}x-x&#39;=b\)</span>。对于取值范围为
<span class="math inline">\(\mathbb R\)</span> 的自变量 <span
class="math inline">\(x&#39;&#39;\)</span>，我们可以引入两个变量 <span
class="math inline">\(x_1\geqslant0\)</span> 和 <span
class="math inline">\(x_2\geqslant0\)</span>，将 <span
class="math inline">\(x&#39;&#39;\)</span> 改写为 <span
class="math inline">\(x_1-x_2\)</span>。如果是最大化 <span
class="math inline">\(c^{\mathrm T}x\)</span>，那么可将优化目标选取为
<span class="math inline">\(-c^{\mathrm
T}x\)</span>。这样一来，所有线性规划问题都能被化为以上标准形式。</p>
<p>处理线性规划问题的最重要的算法是单纯形法。需要注意的是，除了线性规划的单纯性法以外，优化问题中还有另一种截然不同的、不需要计算导数的单纯形法。</p>
<h3 id="单纯形法的基本思路">单纯形法的基本思路</h3>
<p>在高中时我们都学习过二维线性规划，线性规划的结果总是能够在可行区域的顶点上取得。这一点在更一般的线性规划问题中也是成立的。线性规划的单纯形法的迭代步骤就是在这些“顶点”之间左右横跳，最终找到结果。</p>
<p>由于线性规划问题的约束具有 <span class="math inline">\(Ax=b\)</span>
的形式，并且 <span class="math inline">\(A\)</span>
是行满秩的，所以一个很自然的想法就是从中挑出 <span
class="math inline">\(x\)</span> 的 <span
class="math inline">\(m\)</span> 个分量（称为基变量），并记为 <span
class="math inline">\(x_B\)</span>，然后将剩下的部分部分记为 <span
class="math inline">\(x_N\)</span>。我们当然可以调整 <span
class="math inline">\(x\)</span> 中各个分量的顺序（同时也调整 <span
class="math inline">\(A\)</span> 与 <span
class="math inline">\(c\)</span>），使得基变量排在前面： <span
class="math display">\[\begin{align*}
x=[x_B,\;x_N]^{\mathrm T},\quad A=[A_B,\;A_N],\quad c =
[c_B,\;c_N]^{\mathrm T}.
\end{align*}\]</span> 由于 <span class="math inline">\(A\)</span>
是行满秩的，所以 <span class="math display">\[\begin{align}\label{xB xN}
Ax=b\quad\Leftrightarrow\quad A_Bx_B+A_Nx_N=b\quad\Leftrightarrow\quad
x_B=A_B^{-1}b-A_B^{-1}A_Nx_N.
\end{align}\]</span> 将它代入优化目标： <span
class="math display">\[\begin{align*}
c^{\mathrm T}x=c_B^{\mathrm T}x_B+c_N^{\mathrm T}x_N=c_B^{\mathrm
T}A_B^{-1}b+(c_N^{\mathrm T}-c_B^{\mathrm T}A_B^{-1}A_N)x_N.
\end{align*}\]</span></p>
<p>如果 <span class="math inline">\((c_N^{\mathrm T}-c_B^{\mathrm
T}A_B^{-1}A_N)\)</span> 的分量全是正数，由于 <span
class="math inline">\(x_N\geqslant0\)</span>，那么 <span
class="math inline">\(c^{\mathrm T}x\)</span> 的极小值就在 <span
class="math inline">\(x_N=0\)</span>
处取得。实际上可以证明，满足约束条件的区域的“顶点”一定是那些有 <span
class="math inline">\((n-m)\)</span> 个分量为 <span
class="math inline">\(0\)</span> 的点，即 <span
class="math inline">\(x_N=0\)</span> 的点。</p>
<p>如果 <span class="math inline">\((c_N^{\mathrm T}-c_B^{\mathrm
T}A_B^{-1}A_N)\)</span> 的第 <span class="math inline">\(i\)</span>
个分量是负数，就意味着我们可以增加 <span
class="math inline">\((x_N)_i\)</span> 来使 <span
class="math inline">\(c^{\mathrm T}x\)</span> 减小。很多情况下 <span
class="math inline">\((x_N)_i\)</span> 并不是无限制的，因为 <span
class="math inline">\(x_N\)</span> 会通过 (<span
class="math inline">\(\ref{xB xN}\)</span>) 影响 <span
class="math inline">\(x_B\)</span>。如果当 <span
class="math inline">\((x_N)_i\)</span> 增大到使某个 <span
class="math inline">\((x_B)_j\)</span> 变为 <span
class="math inline">\(0\)</span> 的程度，那么就应该调整 <span
class="math inline">\(B\)</span> 与 <span
class="math inline">\(N\)</span>，将 <span
class="math inline">\((x_B)_j\)</span> 加入 <span
class="math inline">\(x_N\)</span>，将 <span
class="math inline">\((x_N)_i\)</span> 加入 <span
class="math inline">\(x_B\)</span>。如果这种增加是无限制的，就说明目前的线性规划问题无解。</p>
<p>以上就是单纯形法的基本思路，当然还有很多细节没有补充，例如怎样选取
<span class="math inline">\((x_N)_i\)</span>
才不会导致死循环，如何选择初值等等。</p>
<h2 id="信赖域的-dogleg-方法">信赖域的 dogleg 方法</h2>
<p>在信赖域方法中，从 <span class="math inline">\(x_k\)</span> 确定出
<span class="math inline">\(x_{k+1}\)</span> 的方法有很多种，scipy
库中使用了一种名为 dogleg 的方法，它的基本做法是：</p>
<blockquote class="colorquote algorithm" ><ul>
<li><p>在信赖域方法中，用二次函数 <span
class="math inline">\(m_k(x)\)</span> 作为原函数的近似。</p></li>
<li><p>假设这是一个无约束优化问题，分别计算由梯度下降法得到的结果
(柯西点) <span class="math inline">\(x_{k+1}^C\)</span>
和由牛顿法得到的结果 <span
class="math inline">\(x^N_{k+1}\)</span>。</p></li>
<li><p>如果 <span class="math inline">\(x^N_{k+1}\)</span>
位于信赖域内，那么 <span
class="math inline">\(x_{k+1}=x^N_{k+1}\)</span>。如果 <span
class="math inline">\(x^N_{k+1}\)</span> 不在信赖域内，那么 <span
class="math inline">\(x_{k+1}\)</span> 取为折线 <span
class="math inline">\(x_{k}\)</span>-<span
class="math inline">\(x_{k+1}^C\)</span>-<span
class="math inline">\(x_{k+1}^N\)</span>（形象地称为
dogleg）与信赖域的交点。</p></li>
</ul>
</blockquote>
<p>这一方法可通过如下方式理解：接近 <span
class="math inline">\(x_k\)</span> 时，<span
class="math inline">\(m_k(x)\)</span>
的二阶项可忽略，下降最快的方向是负梯度方向，离 <span
class="math inline">\(x_k\)</span> 较远时，<span
class="math inline">\(m_k(x)\)</span>
的二阶项开始占主导，下降最快的方向趋于牛顿方向，dogleg
方法就是将这两种极端情形简单地拼接起来。</p>
<h2 id="约束优化问题的内点方法">约束优化问题的内点方法</h2>
<h3 id="约束优化问题的-kkt-条件">约束优化问题的 KKT 条件</h3>
<p>我们考虑的约束优化问题是： <span
class="math display">\[\begin{align}\label{original form constraint}
\text{最小化}\;f(x),\qquad x\;\text{满足}
\begin{cases}
E_i(x)=0:\quad i\in\mathcal E\\
I_j(x)\geqslant0:\quad j\in\mathcal I
\end{cases}.
\end{align}\]</span> 我们可以将它转换为另一种等价的形式： <span
class="math display">\[\begin{align}\label{equivalent-form-constraint}
\text{最小化}\;f(x,s)=f(x),\qquad x,s\;\text{满足}
\begin{cases}
E_i(x)=0:&amp;\quad i\in\mathcal E\\
I_j(x)-s_j=0:&amp;\quad j\in\mathcal I\\
s_j\geqslant0:&amp;\quad j\in\mathcal I
\end{cases}.
\end{align}\]</span></p>
<p>我们来考虑 (<span
class="math inline">\(\ref{equivalent-form-constraint}\)</span>) 的 KKT
条件。它的拉格朗日函数是： <span class="math display">\[\begin{align}
\mathcal L(x,s)= f(x)-\sum_{i\in\mathcal
E}\lambda_iE_i(x)-\sum_{j\in\mathcal
I}z_j[I_j(x)-s_j]-\sum_{j\in\mathcal I}z_js_j.
\end{align}\]</span> 从 <span class="math inline">\(\partial\mathcal
L(x,s)/\partial s=0\)</span> 的条件可以发现 <span
class="math inline">\(s_j\)</span> 与 <span
class="math inline">\([I_j(x)-s_j]\)</span>
项的拉格朗日乘子相等，这一点也可从原问题 (<span
class="math inline">\(\ref{original form constraint}\)</span>) 的 KKT
条件看出来。其他的 KKT 条件为： <span
class="math display">\[\begin{align}\label{KKT condition of constraint}
\begin{cases}
&amp;\nabla f(x)-\displaystyle\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x)-\sum_{j\in\mathcal I}z_j\nabla I_j(x)=0,\\
&amp;z_js_j=0,\quad z_j\geqslant0,\quad s_j\geqslant0:\quad j\in\mathcal
I,\\[3.5mm]
&amp;I_j(x)=s_j:\quad j\in\mathcal I,\\[3.5mm]
&amp;E_i(x)=0:\quad i\in\mathcal E.
\end{cases}
\end{align}\]</span> 内点法求解的是满足如下的近似 KKT 条件： <span
class="math display">\[\begin{align}
\begin{cases}
&amp;\nabla f(x)-\displaystyle\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x)-\sum_{j\in\mathcal I}z_j\nabla I_j(x)=0,\\
&amp;z_js_j=\mu&gt;0,\quad z_j\geqslant0,\quad s_j\geqslant0:\quad
j\in\mathcal I,\\[3.5mm]
&amp;I_j(x)=s_j:\quad j\in\mathcal I,\\[3.5mm]
&amp;E_i(x)=0:\quad i\in\mathcal E.
\end{cases}
\end{align}\]</span></p>
<p>如果 <span class="math inline">\(\mu=0\)</span>，以上近似 KKT
条件就是约束优化问题的 KKT 条件。如果 <span
class="math inline">\(\mu&gt;0\)</span>，那么求解以上近似 KKT 条件得到的
<span class="math inline">\(z\)</span> 与 <span
class="math inline">\(s\)</span> 都是大于 <span
class="math inline">\(0\)</span> 的，而 <span
class="math inline">\(s&gt;0\)</span> 意味着所有 <span
class="math inline">\(I(x)\)</span> 都大于 <span
class="math inline">\(0\)</span>，所以以上近似 KKT
条件的解都是可行区域的内点。可以想象，只要选取一个收敛于 <span
class="math inline">\(0\)</span> 的序列 <span
class="math inline">\(\{\mu_k\}\)</span>，对每个 <span
class="math inline">\(\mu_k\)</span> 求解以上近似 KKT
条件，那么得到的内点就会趋近于约束优化问题的解，这就是内点法的思路。</p>
<h3 id="对偶罚函数的-kkt-条件">对偶罚函数的 KKT 条件</h3>
<p>另一个与之相关的问题是对偶罚函数问题： <span
class="math display">\[\begin{align}\label{log panalty function}
\text{最小化}\;f(x,s)=f(x)-\mu\sum_{j\in\mathcal I}\log s_j,\qquad
x\;\text{满足}
\begin{cases}
E_i(x)=0:\quad i\in\mathcal E\\
I_j(x)=s_j:\quad j\in\mathcal I
\end{cases}.
\end{align}\]</span> 其中 <span
class="math inline">\(\mu&gt;0\)</span>。</p>
<p>这个问题的拉格朗日函数为： <span class="math display">\[\begin{align}
\mathcal L(x,s)= f(x)-\dfrac1t\sum_{j\in\mathcal I}\log
s_j-\sum_{i\in\mathcal E}\lambda_iE_i(x)-\sum_{j\in\mathcal
I}z_j[I_j(x)-s_j].
\end{align}\]</span> 它的 KKT 条件为： <span
class="math display">\[\begin{align}\label{KKT condition of log panalty}
\begin{cases}
&amp;\nabla f(x)-\displaystyle\sum_{i\in\mathcal E}\lambda_i\nabla
E_i(x)-\sum_{j\in\mathcal I}z_j\nabla I_j(x)=0,\\
&amp;-\mu\dfrac{1}{s_j}+z_j=0:\quad j\in\mathcal I,\\[3.5mm]
&amp;I_j(x)=s_j:\quad j\in\mathcal I,\\[3.5mm]
&amp;E_i(x)=0:\quad i\in\mathcal E.
\end{cases}
\end{align}\]</span> 可以看到，这个问题的 KKT 条件与内点法求解的近似 KKT
条件是等价的，只在第二个方程上存在差距。</p>
<hr />
<h1 id="参考书籍">参考书籍</h1>
<ul>
<li>《非线性优化计算方法》 袁亚湘.<span
class="math inline">\(\quad\)</span>北京：科学出版社，2008.</li>
<li>《最优化理论与方法》 袁亚湘, 孙文瑜.<span
class="math inline">\(\quad\)</span>北京：科学出版社，1997.</li>
<li>《<a
target="_blank" rel="noopener" href="https://www.math.uci.edu/~qnie/Publications/NumericalOptimization.pdf">Numerical
Optimization (2rd Ed.)</a>》 Jorge Nocedal, Stephen J. Wright. Springer
New York, 2006.</li>
<li>《<a
target="_blank" rel="noopener" href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf">Convex
Optimization</a>》 Stephen Boyd, Lieven Vandenberghe. Cambridge:
Cambridge University Press, 2004.</li>
<li>《非线性最优化计算方法》 张光澄主编.<span
class="math inline">\(\quad\)</span>北京：高等教育出版社，2005.</li>
<li><span class="math inline">\(\;\;\)</span><a
target="_blank" rel="noopener" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize
的文档</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/Orthogonal_Polynomials/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/Orthogonal_Polynomials/" class="post-title-link" itemprop="url">正交多项式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-18 10:40:29" itemprop="dateModified" datetime="2024-07-18T10:40:29+08:00">2024-07-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>基于拉夫连季耶夫与沙巴特的《复变函数论方法》的第七章（特殊函数）第2节（正交多项式）做了一个简单的整理。所用记号与书内有所不同。</p>
<hr />
<h1 id="一般形式的正交多项式">一般形式的正交多项式</h1>
<p>我们来讨论如下问题：给定一个区间 <span
class="math inline">\([a,b]\)</span>，以及一个在 <span
class="math inline">\([a,b]\)</span> 上恒为非负的权重函数 <span
class="math inline">\(\rho(x)\)</span>，并且假定 <span
class="math inline">\(\rho(x)\)</span> 满足：</p>
<ul>
<li><span
class="math inline">\(\dfrac{\rho&#39;(x)}{\rho(x)}=\dfrac{\alpha_0+\alpha_1x}{\beta_0+\beta_1x+\beta_2x^2}:=\dfrac{\alpha(x)}{\beta(x)}\)</span>,
<span class="math inline">\(\,\\[1em]\)</span></li>
<li><span
class="math inline">\(\rho(a)\beta(a)=\rho(b)\beta(b)=0\)</span>, <span
class="math inline">\(\,\\[1em]\)</span></li>
<li><span class="math inline">\(\alpha_1\)</span> 与 <span
class="math inline">\(\beta_2\)</span> 中至少一个不为 <span
class="math inline">\(0\)</span>. <span
class="math inline">\(\,\\[1em]\)</span></li>
</ul>
<p>然后求出 <span class="math inline">\(n\)</span> 次多项式 <span
class="math inline">\(\varphi_n(x)\)</span>，使其满足： <span
class="math display">\[\int_a^b\rho(x)\varphi_n(x)\varphi_m(x)\mathrm
dx=\delta_{mn}w_n^2,\]</span> 并讨论 <span
class="math inline">\(\varphi_n(x)\)</span> 的性质。</p>
<p>我们还将归一化之后的 <span
class="math inline">\(\varphi_n(x)\)</span> 记为 <span
class="math inline">\(\varphi^0_n(x)\)</span>，并将它们的各向系数记为
<span class="math inline">\(a_{n,i}\)</span> 与 <span
class="math inline">\(a_{n,i,0}\)</span>： <span
class="math display">\[\varphi_n(x)=\sum_{i=0}^na_{n,i}x^i,\quad
\varphi^0_n(x):=\dfrac{1}{w_n}\varphi_n(x)=\sum_{i=0}^na^0_{n,i}x^i.\]</span>
显然 <span class="math inline">\(a_{n,i}^0=a_{n,i}/w_n\)</span>。</p>
<h2 id="完备性">完备性</h2>
<p>不难想象，任何一个 <span class="math inline">\(n\)</span> 次多项式
<span class="math inline">\(g_n\)</span> 都能写为 <span
class="math inline">\(\varphi_1(x)\sim\varphi_n(x)\)</span> 的线性组合：
<span
class="math display">\[g_n(x)=\sum_{i=0}^ng_{n,i}\varphi_i(x),\quad
g_{n,i}=\dfrac{1}{w_i}\int_a^b\rho(x)g_n(x)\varphi_i(x)\mathrm
dx.\]</span> 因此，<span class="math inline">\(\varphi_n(x)\)</span>
与所有次数小于等于 <span class="math inline">\((n-1)\)</span>
的多项式正交。</p>
<h2 id="零点">零点</h2>
<p>正交多项式 <span class="math inline">\(\varphi_n(x)\)</span> 在 <span
class="math inline">\((a,b)\)</span> 上有 <span
class="math inline">\(n\)</span> 个零点。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>用反证法。</p>
<p>假设 <span class="math inline">\(\varphi_n(x)\)</span> 在 <span
class="math inline">\((a,b)\)</span> 上有 <span
class="math inline">\(m\)</span> 个零点，且 <span
class="math inline">\(m&lt;n\)</span>。将这些零点记为 <span
class="math inline">\(x_1,x_2,\cdots,x_m\)</span>
（重根也重复计入）。</p>
<p>考虑 <span class="math inline">\(m\)</span> 次多项式 <span
class="math display">\[R_m(x):=(x-x_1)(x-x_2)\cdots(x-x_m).\]</span>
然后考虑： <span
class="math display">\[\int_a^b\rho(x)\varphi_n(x)R_m(x)\mathrm
dx.\]</span> 由于 <span class="math inline">\(R_m\)</span> 的次数为
<span class="math inline">\(m\)</span>，所以它可写为 <span
class="math inline">\(\varphi_1(x)\sim\varphi_m(x)\)</span>
的线性组合。由于 <span class="math inline">\(m&lt;n\)</span> 所以 <span
class="math inline">\(\varphi_1(x)\sim\varphi_m(x)\)</span> 与 <span
class="math inline">\(\varphi_n(x)\)</span> 全部正交，进而上述积分为
<span class="math inline">\(0\)</span>。</p>
<p>但是，由于 <span class="math inline">\(R_m(x)\varphi_n(x)\)</span> 在
<span class="math inline">\([a,b]\)</span>
上始终不变号，所以这个积分应该大于 <span
class="math inline">\(0\)</span>，这样就推出了矛盾，因此 <span
class="math inline">\(m\)</span> 只能为 <span
class="math inline">\(n\)</span>。</p>

    </div>
</div>
<h2 id="微分方程">微分方程</h2>
<p>正交多项式 <span class="math inline">\(\varphi_n(x)\)</span>
满足微分方程： <span
class="math display">\[\begin{align}\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0.\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>考虑积分 <span
class="math display">\[\begin{align*}I_{n,k}:=&amp;\;\int_a^b[\beta(x)\rho(x)\varphi&#39;_n(x)]&#39;x^k\mathrm
dx\\
=&amp;\;[x^k\beta(x)\rho(x)\varphi&#39;_n(x)]^b_a-k\int_a^b\beta(x)\rho(x)\varphi&#39;_n(x)x^{k-1}\mathrm
dx\\
=&amp;-k\int_a^b\beta(x)\rho(x)x^{k-1}\cdot \varphi&#39;_n(x)\mathrm
dx\\
=&amp;-k[\beta(x)\rho(x)x^{k-1}\varphi_n(x)]^b_a+k\int_a^b[\beta(x)\rho(x)x^{k-1}]&#39;\varphi_n(x)\mathrm
dx\\
=&amp;\;k\int_a^b[\beta(x)\rho(x)x^{k-1}]&#39;\varphi_n(x)\mathrm dx\\
=&amp;\;k\int_a^b[\beta&#39;(x)\rho(x)x^{k-1}+\alpha(x)\rho(x)x^{k-1}+(k-1)\beta(x)\rho(x)x^{k-2}]\varphi_n(x)\mathrm
dx\\
=&amp;\;\int_a^b\rho(x)
[\beta&#39;(x)x^{k-1}+\alpha(x)x^{k-1}+(k-1)\beta(x)x^{k-2}]\varphi_n(x)\mathrm
dx
.\end{align*}\]</span> 不难看出，<span
class="math inline">\([\cdots]\)</span> 中是一个 <span
class="math inline">\(k\)</span> 次多项式，因此，只要 <span
class="math inline">\(k=0\sim(n-1)\)</span>，就必有 <span
class="math inline">\(I_{n,k}=0\)</span>。</p>
<p>然后回到 <span class="math inline">\(I_{n,k}\)</span> 的原初定义：
<span
class="math display">\[\begin{align*}I_{n,k}:=&amp;\;\int_a^b[\beta(x)\rho(x)\varphi&#39;_n(x)]&#39;x^k\mathrm
dx\\
=&amp;\;\int_a^b[\beta&#39;(x)\rho(x)\varphi&#39;_n(x)+\alpha(x)\rho(x)\varphi&#39;_n(x)+\beta(x)\rho(x)\varphi&#39;&#39;_n(x)]x^k\mathrm
dx\\
=&amp;\;\int_a^b\rho(x)
[\beta&#39;(x)\varphi&#39;_n(x)+\alpha(x)\varphi&#39;_n(x)+\beta(x)\varphi&#39;&#39;_n(x)]x^k\mathrm
dx
.\end{align*}\]</span> 由于 <span
class="math inline">\(k=0\sim(n-1)\)</span> 时 <span
class="math inline">\(I_{n,k}=0\)</span>，而 <span
class="math inline">\(\varphi_0(x)\sim\varphi_{n-1}(x)\)</span> 都可写为
<span class="math inline">\(x^0\sim x^{n-1}\)</span>
的线性组合，所以我们发现 <span class="math inline">\([\cdots]\)</span>
中的 <span class="math inline">\(n\)</span> 次多项式与 <span
class="math inline">\(\varphi_0(x)\sim\varphi_{n-1}(x)\)</span>
正交，显然，这个 <span class="math inline">\(n\)</span> 次多项式只可能是
<span class="math inline">\(\varphi_n(x)\)</span> 乘以一个常数 <span
class="math inline">\(\gamma_n\)</span>。对比一下 <span
class="math inline">\(x^n\)</span> 项的系数就能发现： <span
class="math display">\[\gamma_na_{n,n}=(2\beta_2+\alpha_1)\cdot
na_{n,n}+\beta_2\cdot n(n-1)a_{n,n}.\]</span> 于是我们就得到了 <span
class="math inline">\(\varphi_n(x)\)</span> 满足的微分方程： <span
class="math display">\[\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0.\]</span></p>

    </div>
</div>
<h2 id="微分表达式">微分表达式</h2>
<p><span class="math inline">\(\varphi_n(x)\)</span> 满足： <span
class="math display">\[\begin{align}
\varphi_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm d^n}{\mathrm
dx^n}[\rho(x)\beta^n(x)].\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>首先证明等号右侧的确是一个 <span class="math inline">\(n\)</span>
次多项式。</p>
<hr />
<p>考虑： <span
class="math display">\[Q_{n,k}(x):=\dfrac{1}{\rho(x)\beta^{n-k}(x)}\dfrac{\mathrm
d^k}{\mathrm dx^k}[\rho(x)\beta^n(x)].\]</span> <span
class="math inline">\(k=1\)</span> 时 <span
class="math inline">\(Q_{n,1}\)</span> 是 <span
class="math inline">\(1\)</span> 次多项式： <span
class="math display">\[\begin{align*}Q_{n,1}(x)=&amp;\;\dfrac{1}{\rho(x)\beta^{n-1}(x)}\dfrac{\mathrm
d}{\mathrm
dx}[\rho(x)\beta^n(x)]=\dfrac{\rho&#39;(x)\beta^n(x)+n\rho(x)\beta^{n-1}(x)\beta&#39;(x)}{\rho(x)\beta^{n-1}(x)}\\
=&amp;\;\alpha(x)+n\beta&#39;(x).\end{align*}\]</span> <span
class="math inline">\(k=2\)</span> 时 <span
class="math inline">\(Q_{n,2}\)</span> 是 <span
class="math inline">\(2\)</span> 次多项式： <span
class="math display">\[\begin{align*}Q_{n,2}(x)=&amp;\;\dfrac{1}{\rho(x)\beta^{n-2}(x)}\dfrac{\mathrm
d^2}{\mathrm dx^2}[\rho(x)\beta^n(x)]\\
=&amp;\;\dfrac{\rho&#39;&#39;\beta^n+2n\rho&#39;\beta^{n-1}\beta&#39;+n(n-1)\rho\beta^{n-2}(\beta&#39;)^2+n\rho\beta^{n-1}\beta&#39;&#39;}{\rho\beta^{n-2}}\\
=&amp;\;\beta^2\dfrac{\rho&#39;&#39;}{\rho}+2n\alpha\beta&#39;+n(n-1)(\beta&#39;)^2+n\beta\beta&#39;&#39;\\
=&amp;\;\beta^2\dfrac{\rho&#39;&#39;}{\rho}+2n\alpha\beta&#39;+n(n-1)(\beta&#39;)^2+n\beta\beta&#39;&#39;\\
=&amp;\;\alpha&#39;\beta+\alpha^2-\beta&#39;\alpha+2n\alpha\beta&#39;+n(n-1)(\beta&#39;)^2+n\beta\beta&#39;&#39;.\end{align*}\]</span>
中间用到了： <span
class="math display">\[\rho&#39;&#39;=(\alpha\rho/\beta)&#39;=\dfrac{\alpha&#39;\rho\beta+\alpha^2\rho-\beta&#39;\alpha\rho}{\beta^2}=\dfrac{\rho}{\beta^2}(\alpha&#39;\beta+\alpha^2-\beta&#39;\alpha).\]</span>
然后考虑一般的 <span class="math inline">\(k\)</span>： <span
class="math display">\[\begin{align*}
Q_{n,k}(x)=&amp;\;\dfrac{1}{\rho(x)\beta^{n-k}(x)}\dfrac{\mathrm
d^k}{\mathrm
dx^k}[\rho(x)\beta^n(x)]=\dfrac{1}{\rho(x)\beta^{n-k}(x)}\dfrac{\mathrm
d}{\mathrm dx}[\rho(x)\beta^{n-k+1}(x)Q_{n,k-1}(x)]\\
=&amp;\;\dfrac{\rho&#39;\beta^{n-k+1}Q_{n,k-1}+(n-k+1)\rho\beta^{n-k}\beta&#39;Q_{n,k-1}+\rho\beta^{n-k+1}Q_{n,k-1}&#39;}{\rho\beta^{n-k}}\\
=&amp;\;\alpha Q_{n,k-1}+(n-k+1)\beta&#39;Q_{n,k-1}+\beta
Q_{n,k-1}&#39;.
\end{align*}\]</span> 所以，用数学归纳法就能证明 <span
class="math inline">\(Q_{n,k}(x)\)</span> 是 <span
class="math inline">\(k\)</span> 次多项式。具体过程略。</p>
<hr />
<p>然后考虑积分 <span
class="math display">\[I_{n,k}:=\int_a^b\rho(x)x^kQ_{n,n}(x)\mathrm
dx.\]</span> 注意： <span
class="math display">\[\rho\beta^{n-i}Q_{n,i}\mathrm dx=\mathrm
d[(\rho\beta^n)^{(i-1)}].\]</span> 所以： <span
class="math display">\[\begin{align*}
I_{n,k}=&amp;\;\int_a^bx^k\mathrm
d[(\rho\beta^n)^{(n-1)}]=-k\int_a^bx^{k-1}(\rho\beta^n)^{(n-1)}\mathrm
dx\\
=&amp;-k\int_a^bx^{k-1}\mathrm
d[(\rho\beta^n)^{(n-2)}]=k(k-1)\int_a^bx^{k-2}(\rho\beta^n)^{(n-2)}\mathrm
dx\\
\vdots&amp;\\
=&amp;\;(-1)^i\dfrac{k!}{(k-i)!}\int_a^bx^{k-i}(\rho\beta^n)^{(n-i)}\mathrm
dx\\
\vdots&amp;\\
=&amp;\;(-1)^kk!\int_a^b(\rho\beta^n)^{(n-k)}\mathrm dx.
\end{align*}\]</span> 中间多次利用了 <span
class="math inline">\(\rho(a)\beta(a)=\rho(b)\beta(b)=0\)</span>
的条件。因此只要 <span class="math inline">\(k&lt;n\)</span>，就有 <span
class="math inline">\(I_{n,k}=0\)</span>。</p>
<hr />
<p>以上结论意味着 <span class="math inline">\(Q_{n,n}(x)\)</span> 与
<span class="math inline">\(x^0\sim x^{n-1}\)</span> 正交，这意味着它与
<span class="math inline">\(\varphi_0(x)\sim\varphi_{n-1}(x)\)</span>
正交。由于 <span class="math inline">\(Q_{n,n}(x)\)</span> 是 <span
class="math inline">\(n\)</span> 次多项式，所以 <span
class="math inline">\(Q_{n,n}(x)\)</span> 与 <span
class="math inline">\(\varphi_n(x)\)</span> 只相差一个常数。</p>

    </div>
</div>
<p>然后我们可以证明： <span
class="math display">\[A_n=\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}\]</span> 其中 <span
class="math display">\[\tilde\delta_n=\int_a^b\rho(x)\beta^n(x)\mathrm
dx,\quad \tilde a_n=\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2).\]</span>
这里的 <span class="math inline">\(\tilde a_n\)</span> 是 <span
class="math inline">\(\varphi_n(x)/A_n\)</span> 的首项系数。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>我们先确定 <span class="math inline">\(Q_{n,n}\)</span>
的最高次项系数，然后将 <span class="math inline">\(Q_{n,n}\)</span>
归一化为 <span class="math inline">\(\varphi_{n}^0\)</span>，再确定
<span class="math inline">\(\tilde a_n\)</span>。</p>
<hr />
<p>之前，我们已经得出： <span class="math display">\[\begin{align*}
Q_{n,k}(x)=\alpha Q_{n,k-1}+(n-k+1)\beta&#39;Q_{n,k-1}+\beta
Q_{n,k-1}&#39;.
\end{align*}\]</span></p>
<p>我们将 <span class="math inline">\(Q_{n,k}(x)\)</span> 的首项系数记为
<span class="math inline">\(q_{1,n,k}\)</span>，那么 <span
class="math inline">\(q_{1,n,k}\)</span> 满足： <span
class="math display">\[\begin{align*}q_{1,n,k}=&amp;\;\alpha_1q_{1,n,k-1}+2\beta_2(n-k+1)q_{1,n,k-1}+(k-1)\beta_2q_{1,n,k-1}\\
=&amp;\;q_{1,n,k-1}[\alpha_1+(2n-k+1)\beta_2].\end{align*}\]</span>
考虑到 <span
class="math inline">\(q_{1,n,1}=\alpha_1+2n\beta_2\)</span>，我们发现：
<span
class="math display">\[q_{1,n,k}=\prod_{i=1}^k[\alpha_1+(2n-i+1)\beta_2],\quad
q_{1,n,n}=\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2).\]</span> 我们将 <span
class="math inline">\(q_{1,n,n}\)</span> 记为 <span
class="math inline">\(\tilde a_n\)</span>。一般情况下，<span
class="math inline">\(\beta_2\leqslant0\)</span>，因此 <span
class="math inline">\(\tilde a_n\)</span> 总是有一个 <span
class="math inline">\((-1)^n\)</span> 的因子。</p>
<hr />
<p>然后我们来计算 <span class="math inline">\(Q_{n,n}\)</span>
与自己的内积： <span class="math display">\[\begin{align*}
\|Q_{n,n}\|^2=\int_a^b\rho(x)Q_{n,n}(x)Q_{n,n}(x)\mathrm dx=\tilde
a_n\int_a^b\rho(x)x^nQ_{n,n}(x)\mathrm dx.
\end{align*}\]</span> 最后一个等号用是因为：<span
class="math inline">\(Q_{n,n}\)</span> 与 <span
class="math inline">\(\varphi_n(x)\)</span> 只相差一个相乘的常数，因此与
<span class="math inline">\(x^0\sim x^{n-1}\)</span>
正交。我们刚刚算出过： <span
class="math display">\[\int_a^b\rho(x)x^kQ_{n,n}(x)\mathrm
dx=(-1)^kk!\int_a^b(\rho\beta^n)^{(n-k)}\mathrm dx,\]</span> 这意味着：
<span class="math display">\[\begin{align*}
\|Q_{n,n}\|^2=\tilde a_n(-1)^nn!\int_a^b\rho(x)\beta^n(x)\mathrm dx.
\end{align*}\]</span> 如果我们定义： <span
class="math display">\[\tilde\delta_n:=\int_a^b\rho(x)\beta^n(x)\mathrm
dx,\]</span> 就有： <span
class="math display">\[\varphi_0(x)=\dfrac{(-1)^n}{\sqrt{(-1)^nn!\tilde
a_n\tilde\delta_n}}Q_{n,n}(x).\]</span> 分子上的 <span
class="math inline">\((-1)^n\)</span> 是因为 <span
class="math inline">\(Q_{n,n}(x)\)</span> 的首项系数 <span
class="math inline">\(\tilde a_n\)</span> 中总是有一个 <span
class="math inline">\((-1)^n\)</span> 的因子，这样可以保证 <span
class="math inline">\(\varphi_0(x)\)</span> 的首项系数为正的。</p>

    </div>
</div>
<p>基于以上结论，我们可以证明： <span
class="math display">\[a_{n,n}=A_n\tilde a_n=\dfrac{(-1)^nw_n\tilde
a_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde a_n}},\]</span> 以及： <span
class="math display">\[a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(a_{n,n}\)</span> 已经算出来了，因此只计算
<span class="math inline">\(a_{n,n-1}\)</span> 。</p>
<p>之前，我们已经得出： <span class="math display">\[\begin{align*}
Q_{n,k}(x)=\alpha Q_{n,k-1}+(n-k+1)\beta&#39;Q_{n,k-1}+\beta
Q_{n,k-1}&#39;.
\end{align*}\]</span></p>
<p>我们将 <span class="math inline">\(Q_{n,k}(x)\)</span>
的第二项的系数，也就是 <span class="math inline">\(x^{k-1}\)</span>
项的系数，记为 <span class="math inline">\(q_{2,n,k}\)</span>，那么
<span class="math inline">\(q_{2,n,k}\)</span> 满足： <span
class="math display">\[\begin{align*}
q_{2,n,k}=&amp;\;(\alpha_1q_{2,n,k-1}+\alpha_0q_{1,n,k-1})+(n-k+1)(2\beta_2q_{2,n,k-1}+\beta_1q_{1,n,k-1})+[\beta_1(k-1)q_{1,n,k-1}+\beta_2(k-2)q_{2,n,k-1}]\\
=&amp;\;q_{1,n,k-1}[\alpha_0+(n-k+1)\beta_1+(k-1)\beta_1]+q_{2,n,k-1}[\alpha_1+2(n-k+1)\beta_2+(k-2)\beta_2]\\
=&amp;\;q_{1,n,k-1}(\alpha_0+n\beta_1)+q_{2,n,k-1}[\alpha_1+(2n-k)\beta_2].\end{align*}\]</span></p>
<p>一下子看不出结果，因此先写出几项观察规律。首先 <span
class="math inline">\(q_{1,n,k}=\prod_{i=1}^k[\alpha_1+(2n-i+1)\beta_2]\)</span>，因此：
<span class="math display">\[\begin{align*}
k=1:\quad q_{2,n,1}=&amp;\;\alpha_0+n\beta_1,\\
q_{1,n,1}=&amp;\;\alpha_1+2n\beta_2,\\
k=2:\quad
q_{2,n,2}=&amp;\;(\alpha_1+2n\beta_2)(\alpha_0+n\beta_1)+(\alpha_0+n\beta_1)
[\alpha_1+(2n-2)\beta_2]\\
=&amp;\;2(\alpha_0+n\beta_1) [\alpha_1+(2n-1)\beta_2],\\
q_{1,n,2}=&amp;\;(\alpha_1+2n\beta_2) [\alpha_1+(2n-1)\beta_2]\\
k=3:\quad q_{2,n,3}=&amp;\;(\alpha_1+2n\beta_2) [\alpha_1+(2n-1)\beta_2]
(\alpha_0+n\beta_1)\\
&amp;\;+2(\alpha_0+n\beta_1)
[\alpha_1+(2n-1)\beta_2][\alpha_1+(2n-3)\beta_2]\\
=&amp;\;3(\alpha_0+n\beta_1)
[\alpha_1+(2n-1)\beta_2][\alpha_1+(2n-2)\beta_2]
.\end{align*}\]</span></p>
<p>我们猜测： <span
class="math display">\[q_{2,n,k}=k(\alpha_0+n\beta_1)\prod_{i=1}^{k-1}[\alpha_1+(2n-i)\beta_2]=k\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k}.\]</span>
然后可以发现： <span class="math display">\[\begin{align*}
q_{2,n,k}=&amp;\;(\alpha_0+n\beta_1)q_{1,n,k-1}+(k-1)\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k-1}[\alpha_1+(2n-k)\beta_2]\\
=&amp;\;\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k-1}\left\{(\alpha_1+2n\beta_2)+(k-1)
[\alpha_1+(2n-k)\beta_2]\right\}\\
=&amp;\;\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k-1}\left\{k\alpha_1+k\cdot
2n\beta_2-k(k-1)\beta_2\right\}\\
=&amp;\;k\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k-1}[\alpha_1+(2n-k+1)\beta_2]\\
=&amp;\;k\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,k}.\end{align*}\]</span>
所以以上猜测确实成立。</p>
<p>这样我们就证明了 <span
class="math display">\[q_{2,n,n}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}q_{1,n,n},\]</span>
也就是 <span
class="math display">\[a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}.\]</span></p>

    </div>
</div>
<h2 id="递推关系">递推关系</h2>
<p>正交多项式满足递推关系：</p>
<p><span class="math display">\[\begin{align}
x\varphi_n(x)=\dfrac{a_{n,n}}{a_{n+1,n+1}}\varphi_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)\varphi_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}\varphi_{n-1}(x)
,\label{x-phi_n-expansion-4}\end{align}\]</span></p>
<p>以及：</p>
<p><span class="math display">\[\begin{align}
x\varphi_n^0(x)=\dfrac{a_{n,n}^0}{a_{n+1,n+1}^0}\varphi_{n+1}^0(x)+\left(\dfrac{a^0_{n,n-1}}{a_{n,n}^0}-\dfrac{a_{n+1,n}^0}{a_{n+1,n+1}^0}\right)\varphi_{n}^0(x)+\dfrac{a_{n-1,n-1}^0}{a_{n,n}^0}\varphi_{n-1}^0(x)
.\label{x-phi_n-expansion-3}\end{align}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>考虑 <span class="math inline">\(x\varphi^0_n(x)\)</span>。由于它是
<span class="math inline">\((n+1)\)</span> 次多项式，所以它能写为 <span
class="math inline">\(\varphi^0_1(x)\sim\varphi^0_{n+1}(x)\)</span>
的线性组合： <span
class="math display">\[\begin{align}x\varphi_n^0(x)=\sum_{i=0}^{n+1}X_{ni}\varphi_i^0(x),\label{x-phi_n-expansion-1}\end{align}\]</span>
其中： <span
class="math display">\[\begin{align}X_{ni}=\int_a^b\rho(x)x\varphi^0_n(x)\varphi_i^0(x)\mathrm
dx.\label{x-phi_n-expansion-2}\end{align}\]</span> 不难看出，<span
class="math inline">\(i&lt;n-1\)</span> 时的 <span
class="math inline">\(X_{n,i}\)</span> 都为 <span
class="math inline">\(0\)</span>，因为此时 <span
class="math inline">\(x\varphi_i(x)\)</span> 的次数小于 <span
class="math inline">\(n\)</span> 因此必然与 <span
class="math inline">\(\varphi^0_n(x)\)</span> 正交。</p>
<p><span class="math inline">\(i=n+1\)</span> 时，比较 (<span
class="math inline">\(\ref{x-phi_n-expansion-1}\)</span>) 式 <span
class="math inline">\(x^{n+1}\)</span> 次项系数可以发现 <span
class="math inline">\(a_{n,n}x^{n+1}=X_{n,n+1}a_{n+1,n+1}x^{n+1}\)</span>，即：
<span
class="math display">\[X_{n,n+1}=\dfrac{a_{n,n}^0}{a_{n+1,n+1}^0}.\]</span>
从 (<span class="math inline">\(\ref{x-phi_n-expansion-2}\)</span>)
式可以发现 <span class="math inline">\(X_{ni}=X_{in}\)</span>，所以
<span
class="math display">\[X_{n,n-1}=X_{n-1,n}=\dfrac{a_{n-1,n-1}^0}{a_{n,n}^0}.\]</span>
再比较 (<span class="math inline">\(\ref{x-phi_n-expansion-1}\)</span>)
式等号两侧 <span class="math inline">\(x^n\)</span> 项的系数可以发现
<span
class="math inline">\(a_{n,n-1}x^n=(X_{n,n+1}a_{n+1,n}^0+X_{n,n}a_{n,n}^0)x^n\)</span>，即：
<span
class="math display">\[X_{n,n}=\dfrac{1}{a_{n,n}^0}\left(a_{n,n-1}^0-\dfrac{a_{n,n}^0}{a_{n+1,n+1}^0}a_{n+1,n}^0\right)=\left(\dfrac{a_{n,n-1}}{a_{n,n}^0}-\dfrac{a_{n+1,n}^0}{a_{n+1,n+1}^0}\right).\]</span></p>
<p>这样一来我们就发现： <span class="math display">\[
x\varphi_n^0(x)=\dfrac{a_{n,n}^0}{a_{n+1,n+1}^0}\varphi_{n+1}^0(x)+\left(\dfrac{a^0_{n,n-1}}{a_{n,n}^0}-\dfrac{a_{n+1,n}^0}{a_{n+1,n+1}^0}\right)\varphi_{n}^0(x)+\dfrac{a_{n-1,n-1}^0}{a_{n,n}^0}\varphi_{n-1}^0(x)
,\]</span> 再利用 <span
class="math inline">\(\varphi_n^0(x)=\varphi_n(x)/w_n\)</span>，<span
class="math inline">\(a_{n,i}^0=a_{n,i}/w_n\)</span>，就能算出： <span
class="math display">\[
x\varphi_n(x)=\dfrac{a_{n,n}}{a_{n+1,n+1}}\varphi_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)\varphi_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}\varphi_{n-1}(x)
.\]</span> 因此，只需要知道 <span class="math inline">\(a_{n,n}\)</span>
与 <span class="math inline">\(a_{n-1}\)</span> 就能确定递推关系。</p>

    </div>
</div>
<h2 id="生成函数">生成函数</h2>
<p>我们考虑如下函数： <span
class="math display">\[\varPsi(z,w):=\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n.\]</span>
那么可以证明： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_w)}{1-w\beta&#39;(\xi_w)},\]</span>
其中 <span class="math inline">\(\xi_w\)</span> 为关于 <span
class="math inline">\(\xi\)</span> 的二次方程 <span
class="math display">\[\xi-z-w\beta(\xi)=0.\]</span> 的在 <span
class="math inline">\(w\)</span> 很小时接近于 <span
class="math inline">\(z\)</span> 的根。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>利用柯西积分公式可以算出：</p>
<p><span class="math display">\[\begin{align*}
\varPsi(z,w)=&amp;\;\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n=\dfrac{1}{\rho(z)}\sum_{n=0}^\infty\dfrac{w^n}{n!}\dfrac{\mathrm
d^n}{\mathrm dz^n}[\rho(z)\beta^n(z)]\\
=&amp;\;\dfrac{1}{\rho(z)}\sum_{n=0}^\infty\dfrac{w^n}{n!}\cdot\dfrac{n!}{2\pi\mathrm
i}\oint_{C_z}\dfrac{\rho(\xi)\beta^n(\xi)}{(\xi-z)^{n+1}}\mathrm d\xi\\
=&amp;\;\dfrac{1}{\rho(z)}\dfrac{1}{2\pi\mathrm
i}\oint_{C_z}\sum_{n=0}^\infty\dfrac{\rho(\xi)
[w\beta(\xi)]^n}{(\xi-z)^{n+1}}\mathrm d\xi\\
=&amp;\;\dfrac{1}{\rho(z)}\dfrac{1}{2\pi\mathrm
i}\oint_{C_z}\dfrac{\rho(\xi)}{\xi-z}\dfrac{1}{1-w\beta(\xi)/(\xi-z)}\mathrm
d\xi\\
=&amp;\;\dfrac{1}{\rho(z)}\dfrac{1}{2\pi\mathrm
i}\oint_{C_z}\dfrac{\rho(\xi)}{\xi-z-w\beta(\xi)}\mathrm d\xi.
\end{align*}\]</span></p>
<p>在计算 <span class="math inline">\(\sum_{n=0}^\infty
w\beta(\xi)/(\xi-z)\)</span> 时，需要保证 <span
class="math inline">\(w\beta(\xi)/(\xi-z)\)</span> 的模足够小。由于围道
<span class="math inline">\(C_z\)</span> 的半径确定，所以当 <span
class="math inline">\(w\)</span> 非常小时，这一点总是能够保障的。</p>
<p>然后考虑方程 <span
class="math inline">\(\xi-z-w\beta(\xi)=0\)</span>： <span
class="math display">\[w\beta_2\xi^2+(w\beta_1-1)\xi+(w\beta_0+z)=0.\]</span></p>
<hr />
<p>在 <span class="math inline">\(\beta_2\neq0\)</span> 时，方程根是：
<span class="math display">\[\begin{align*}
\xi=&amp;\;\dfrac{-(w\beta_1-1)\pm\sqrt{(w\beta_1-1)^2-4w\beta_2(w\beta_0+z)}}{2w\beta_2}\\
=&amp;\;\dfrac{1-w\beta_1\pm\sqrt{1-2w\beta_1+w^2\beta_1^2-4w\beta_2(w\beta_0+z)}}{2w\beta_2}\\
=&amp;\;\dfrac{1-w\beta_1\pm\sqrt{1-2w(\beta_1+2z\beta_2)+w^2(\beta_1^2-4\beta_0\beta_2)}}{2w\beta_2}\\
=&amp;\;\dfrac{1-w\beta_1\pm[1-w(\beta_1+2z\beta_2)+O(w^2)]}{2w\beta_2}.
.\end{align*}\]</span> 于是它的两个根为： <span
class="math display">\[\xi_+=\dfrac{1}{w\beta_2}-\dfrac{\beta_1+z\beta_2}{\beta_2}+O(w),\quad
\xi_-=z+O(w).\]</span></p>
<p>假设围道 <span class="math inline">\(C_z\)</span> 的半径为 <span
class="math inline">\(R\)</span>，那么 <span
class="math inline">\(w\beta(\xi)/(\xi-z)\sim \beta_2Rw\)</span>。只要
<span class="math inline">\(w\)</span> 足够小以至于 <span
class="math display">\[\beta_1 Rw\ll1\]</span> <span
class="math inline">\(w\beta(\xi)/(\xi-z)\)</span> 的模就能远小于 <span
class="math inline">\(1\)</span>，级数 <span
class="math inline">\(\sum_{n=0}^\infty w\beta(\xi)/(\xi-z)\)</span>
就能收敛。与此同时，<span class="math inline">\(\xi_-\)</span>
也必定会落在 <span class="math inline">\(C_z\)</span> 中，并且 <span
class="math inline">\(\xi_+=1/(w\beta_2)\gg R\)</span> 一定在 <span
class="math inline">\(C_z\)</span> 外。</p>
<p>这样一来，围道 <span class="math inline">\(C_z\)</span>
也可视为时一个围绕 <span class="math inline">\(\xi_-\)</span>
的围道，根据留数定理，其结果为： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)},\]</span>
这样就对 <span class="math inline">\(\beta_2\neq0\)</span>
的情形完成了证明。</p>
<hr />
<p>在 <span class="math inline">\(\beta_2\neq0\)</span> 时，方程根是：
<span
class="math display">\[\xi=\dfrac{z+w\beta_0}{1-w\beta_1}=z+w(\beta_0+z\beta_1)+O(w^2).\]</span>
假设围道 <span class="math inline">\(C_z\)</span> 的半径为 <span
class="math inline">\(R\)</span>，那么 <span
class="math inline">\(w\beta(\xi)/(\xi-z)\sim
\beta_1w\)</span>。因此只要 <span class="math inline">\(w\)</span>
足够小，<span class="math inline">\(w\beta(\xi)/(\xi-z)\)</span>
的模就能小于 <span class="math inline">\(1\)</span> 使得级数收敛，同时
<span class="math inline">\(\xi\)</span> 也落在 <span
class="math inline">\(C_z\)</span> 中。</p>
<p>这样一来，围道 <span class="math inline">\(C_z\)</span>
也可视为时一个围绕 <span class="math inline">\(\xi\)</span>
的围道，根据留数定理，其结果为： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)},\]</span>
这样就对 <span class="math inline">\(\beta_2=0\)</span>
的情形完成了证明。</p>

    </div>
</div>
<h1 id="具体的正交多项式">具体的正交多项式</h1>
<h2 id="勒让德多项式">勒让德多项式</h2>
<p>在上一部分的一般讨论中，取： <span
class="math display">\[[a,b]=[-1,1],\quad\rho(x)=1,\quad
\alpha(x)=0,\quad \beta(x)=1-x^2,\quad w_n^2=\dfrac{2}{2n+1}.\]</span>
得到的多项式就是勒让德多项式 <span
class="math inline">\(P_n(x)\)</span>。</p>
<h3 id="几个常数">几个常数</h3>
<p><span class="math display">\[\begin{align*}
\tilde\delta_n=&amp;\;\int_a^b\rho(x)\beta^n(x)\mathrm
dx=\int_{-1}^1(1-x^2)^n\mathrm dx\\
=&amp;\;\int_0^\pi\sin^{2n+1}x\mathrm
dx=2\int_0^{\pi/2}\sin^{2n+1}x\mathrm dx=2\dfrac{(2n)!!}{(2n+1)!!},\\
\tilde
a_n=&amp;\;\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2)=(-1)^n\dfrac{(2n)!}{n!},\\
A_n=&amp;\;\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}=\dfrac{(-1)^n\sqrt{2/(2n+1)}}{\sqrt{(2n)!\cdot2(2n)!!/(2n+1)!!}}\\
=&amp;\;\dfrac{(-1)^n\sqrt{(2n+1)!!}}{\sqrt{(2n+1)!(2n)!!}}=\dfrac{(-1)^n}{(2n)!!}=\dfrac{(-1)^n}{n!2^n}
.\end{align*}\]</span></p>
<h3 id="微分方程-1">微分方程</h3>
<p><span class="math display">\[
\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0\]</span>
<span class="math display">\[\Rightarrow\quad\quad
(1-x^2)P&#39;&#39;_n(x)-2xP&#39;_n(x)+n(n+1)P_n(x)=0.\]</span></p>
<h3 id="微分表达式-1">微分表达式</h3>
<p><span
class="math display">\[P_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm
d^n}{\mathrm
dx^n}[\rho(x)\beta^n(x)]=\dfrac{(-1)^n}{n!2^n}\dfrac{\mathrm
d^n}{\mathrm dx^n}(1-x^2)^n=\dfrac{1}{n!2^n}\dfrac{\mathrm d^n}{\mathrm
dx^n}(x^2-1)^n.\]</span></p>
<p>不难看出：<span
class="math inline">\(P_n(x)=(-1)^nP_n(-x)\)</span>。</p>
<h3 id="生成函数-1">生成函数</h3>
<p><span class="math display">\[(1+w^2-2wz)^{-1/2}=\sum_{n=0}^\infty
P_n(z)w^n.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(\xi-z-w\beta(\xi)=0\)</span>，也就是
<span class="math inline">\(\xi-z-w(1-\xi^2)=0\)</span> 的根为 <span
class="math display">\[\xi_-=\dfrac{-(w\beta_1-1)-\sqrt{(w\beta_1-1)^2-4w\beta_2(w\beta_0+z)}}{2w\beta_2}=\dfrac{1-\sqrt{1+4w(w+z)}}{-2w},\]</span>
于是： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)}=\dfrac{1}{1+2w\xi_-}=\dfrac{1}{\sqrt{1+4w(w+z)}}.\]</span>
它满足： <span
class="math display">\[\varPsi(z,w)=\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n=\sum_{n=0}^\infty(-1)^nP_n(z)(2w)^n.\]</span>
因此： <span
class="math display">\[(1+w^2+2wz)^{-1/2}=\sum_{n=0}^\infty(-1)^nP_n(z)w^n,\]</span>
也即： <span class="math display">\[(1+w^2-2wz)^{-1/2}=\sum_{n=0}^\infty
P_n(z)w^n.\]</span></p>

    </div>
</div>
<h3 id="前两项的系数">前两项的系数</h3>
<p><span class="math display">\[a_{n,n}=A_n\tilde
a_n=\dfrac{(-1)^n}{n!2^n}\cdot
(-1)^n\dfrac{(2n)!}{n!}=\dfrac{(2n)!}{2^n(n!)^2},\]</span> 以及： <span
class="math display">\[a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}=0.\]</span></p>
<h3 id="递推关系-1">递推关系</h3>
<p><span class="math display">\[\begin{align*}
xP_n(x)=&amp;\;\dfrac{n+1}{2n+1}P_{n+1}(x)+\dfrac{n}{2n+1}P_{n-1}(x)
.\end{align*}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
xP_n(x)=&amp;\;\dfrac{a_{n,n}}{a_{n+1,n+1}}P_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)P_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}P_{n-1}(x)\\
=&amp;\;\dfrac{(2n)!}{2^n(n!)^2}\dfrac{2(n+1)^2\cdot
2^n(n!)^2}{(2n+1)(2n+2)(2n)!}P_{n+1}(x)+\dfrac{2(n-1)+1}{2n+1}\dfrac{(2n-2)!}{2^{n-1}[(n-1)!]^2}\dfrac{2n^2\cdot
2^{n-1}[(n-1)!]^2}{(2n-1)(2n) (2n-2)!}P_{n-1}(x)\\
=&amp;\;\dfrac{n+1}{2n+1}P_{n+1}(x)+\dfrac{2n-1}{2n+1}\dfrac{n}{2n-1}P_{n-1}(x)\\
=&amp;\;\dfrac{n+1}{2n+1}P_{n+1}(x)+\dfrac{n}{2n+1}P_{n-1}(x)
.\end{align*}\]</span></p>

    </div>
</div>
<h2 id="厄米多项式">厄米多项式</h2>
<p>在上一部分的一般讨论中，取： <span
class="math display">\[[a,b]=[-\infty,\infty],\quad\rho(x)=\mathrm
e^{-x^2},\quad \alpha(x)=-2x,\quad \beta(x)=1,\quad
w_n^2=2^nn!\sqrt{\pi}.\]</span> 得到的多项式就是厄米多项式 <span
class="math inline">\(H_n(x)\)</span>。</p>
<h3 id="几个常数-1">几个常数</h3>
<p><span class="math display">\[\begin{align*}
\tilde\delta_n=&amp;\;\int_a^b\rho(x)\beta^n(x)\mathrm
dx=\int_{-\infty}^\infty\mathrm e^{-x^2}\mathrm dx=\sqrt{\pi},\\
\tilde a_n=&amp;\;\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2)=(-2)^n,\\
A_n=&amp;\;\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}=\dfrac{(-1)^n\sqrt{2^nn!\sqrt{\pi}}}{\sqrt{2^nn!\sqrt{\pi}}}=(-1)^n
.\end{align*}\]</span></p>
<h3 id="微分方程-2">微分方程</h3>
<p><span class="math display">\[
\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0\]</span>
<span class="math display">\[\Rightarrow\quad\quad
H&#39;&#39;_n(x)-2xH&#39;_n(x)+2nH_n(x)=0.\]</span></p>
<h3 id="微分表达式-2">微分表达式</h3>
<p><span
class="math display">\[H_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm
d^n}{\mathrm dx^n}[\rho(x)\beta^n(x)]=(-1)^n\mathrm
e^{x^2}\dfrac{\mathrm d^n}{\mathrm dx^n}\mathrm e^{-x^2}.\]</span></p>
<h3 id="生成函数-2">生成函数</h3>
<p><span
class="math display">\[\exp\left(-w^2+2wz\right)=\sum_{n=0}^\infty\dfrac{H_n(z)}{n!}w^n.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(\xi-z-w\beta(\xi)=0\)</span> 的根为 <span
class="math display">\[\xi_-=z+w,\]</span> 于是： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)}=\exp\left[-(z+w)^2+z^2\right]=\exp\left(-w^2-2wz\right).\]</span>
它满足： <span
class="math display">\[\varPsi(z,w)=\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n=\sum_{n=0}^\infty(-1)^n\dfrac{H_n(z)}{n!}w^n.\]</span>
也即： <span
class="math display">\[\exp\left(-w^2+2wz\right)=\sum_{n=0}^\infty\dfrac{H_n(z)}{n!}w^n.\]</span></p>

    </div>
</div>
<h3 id="前两项的系数-1">前两项的系数</h3>
<p><span class="math display">\[a_{n,n}=A_n\tilde a_n=2^n,\quad
a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}=0.\]</span></p>
<h3 id="递推关系-2">递推关系</h3>
<p><span
class="math display">\[H_{n+1}(x)=2xH_n(x)-2nH_{n-1}(x).\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
xH_n(x)=&amp;\;\dfrac{a_{n,n}}{a_{n+1,n+1}}H_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)H_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}H_{n-1}(x)\\
=&amp;\;\dfrac12H_{n+1}(x)+\dfrac{2^{n}n!\sqrt{\pi}}{2^{n-1}(n-1)!\sqrt{\pi}}\dfrac{1}{2}H_{n-1}(x)\\
=&amp;\;\dfrac12H_{n+1}(x)+nH_{n-1}(x).\end{align*}\]</span></p>

    </div>
</div>
<h2 id="拉盖尔多项式">拉盖尔多项式</h2>
<p>在上一部分的一般讨论中，在 <span
class="math inline">\(n&gt;0\)</span> 时取： <span
class="math display">\[[a,b]=[0,\infty],\quad\rho(x)=x^\lambda\mathrm
e^{-x},\quad \alpha(x)=\lambda-x,\quad \beta(x)=x,\quad
w_n^2=\dfrac{\Gamma(\lambda+n+1)}{n!}.\]</span>
得到的多项式就是拉盖尔多项式 <span
class="math inline">\(L^{\lambda}_n(x)\)</span>。</p>
<h3 id="几个常数-2">几个常数</h3>
<p><span class="math display">\[\begin{align*}
\tilde\delta_n=&amp;\;\int_a^b\rho(x)\beta^n(x)\mathrm
dx=\int_{0}^\infty x^{n+\lambda}\mathrm e^{-x}\mathrm
dx=\Gamma(\lambda+n+1).\\
\tilde a_n=&amp;\;(-1)^n,\\
A_n=&amp;\;\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}=\dfrac{(-1)^n\sqrt{\Gamma(\lambda+n+1)/n!}}{\sqrt{(-1)^n\cdot
n!\cdot\Gamma(\lambda+n+1)\cdot(-1)^n}}=\dfrac{1}{n!}
.\end{align*}\]</span></p>
<h3 id="微分方程-3">微分方程</h3>
<p><span class="math display">\[
\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0\]</span>
<span class="math display">\[\Rightarrow\quad\quad x\dfrac{\mathrm
d^2L^\lambda_n(x)}{\mathrm dx^2}+(\lambda+1-x)\dfrac{\mathrm
dL^\lambda_n(x)}{\mathrm dx}+nL^\lambda_n(x)=0.\]</span></p>
<h3 id="微分表达式-3">微分表达式</h3>
<p><span
class="math display">\[L^\lambda_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm
d^n}{\mathrm dx^n}[\rho(x)\beta^n(x)]=\dfrac{1}{n!}x^{-\lambda}\mathrm
e^{x}\dfrac{\mathrm d^n}{\mathrm dx^n}(x^{n+\lambda}\mathrm
e^{-x}).\]</span></p>
<h3 id="生成函数-3">生成函数</h3>
<p><span
class="math display">\[\dfrac{\exp[zw/(w-1)]}{(1-w)^{\lambda+1}}=\sum_{n=0}^\infty
L_n^\lambda(z)w^n.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(\xi-z-w\beta(\xi)=0\)</span>，也就是
<span class="math inline">\(\xi-z-w\xi=0\)</span> 的根为 <span
class="math display">\[\xi_-=\dfrac{z}{1-w},\quad
\dfrac{\xi_-}{z}=\dfrac{1}{1-w},\quad z-\xi_-=\dfrac{zw}{w-1}.\]</span>
于是： <span
class="math display">\[\varPsi(z,w)=\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)}=\dfrac{\xi_-^\lambda\mathrm
e^{-\xi_-}}{z^\lambda\mathrm
e^{-z}}\dfrac{1}{1-w}=\dfrac{\exp[zw/(w-1)]}{(1-w)^{\lambda+1}}.\]</span>
它满足： <span
class="math display">\[\varPsi(z,w)=\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n=\sum_{n=0}^\infty
L_n^\lambda(z)w^n.\]</span> 也即： <span
class="math display">\[\dfrac{\exp[zw/(w-1)]}{(1-w)^{\lambda+1}}=\sum_{n=0}^\infty
L_n^\lambda(z)w^n.\]</span></p>

    </div>
</div>
<h3 id="前两项的系数-2">前两项的系数</h3>
<p><span class="math display">\[a_{n,n}=A_n\tilde
a_n=\dfrac{(-1)^n}{n!},\quad
a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}=n\dfrac{\lambda+n}{-1}a_{n,n}=(-1)^{n+1}\dfrac{\lambda+n}{(n-1)!}.\]</span></p>
<h3 id="递推关系-3">递推关系</h3>
<p><span
class="math display">\[(n+1)L^\lambda_{n+1}(x)+\left[x-2n-(\lambda+1)\right]L^\lambda_n(x)+(\lambda+n)L^\lambda_{n-1}(x)=0.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
xL^\lambda_n(x)=&amp;\;\dfrac{a_{n,n}}{a_{n+1,n+1}}L^\lambda_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)L^\lambda_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}L^\lambda_{n-1}(x)\\
=&amp;-(n+1)L^\lambda_{n+1}(x)+\left[-n(\lambda+n)+(n+1)(\lambda+n+1)\right]L^\lambda_n(x)+\dfrac{\Gamma(\lambda+n+1)}{n!}\dfrac{(n-1)!}{\Gamma(\lambda+n)}(-n)L^\lambda_{n-1}(x)\\
=&amp;-(n+1)L^\lambda_{n+1}(x)+\left[\lambda+n+n+1\right]L^\lambda_n(x)-(\lambda+n)L^\lambda_{n-1}(x)
.\end{align*}\]</span></p>

    </div>
</div>
<h2 id="切比雪夫多项式n0-时">切比雪夫多项式（<span
class="math inline">\(n&gt;0\)</span> 时）</h2>
<p>在上一部分的一般讨论中，在 <span
class="math inline">\(n&gt;0\)</span> 时取： <span
class="math display">\[[a,b]=[-1,1],\quad\rho(x)=\dfrac{1}{\sqrt{1-x^2}},\quad
\alpha(x)=x,\quad \beta(x)=1-x^2,\quad w_n^2=\dfrac\pi2.\]</span>
得到的多项式就是切比雪夫多项式 <span
class="math inline">\(T_n(x)\)</span> (<span
class="math inline">\(n&gt;0\)</span>)。</p>
<h3 id="几个常数n0-时">几个常数（<span
class="math inline">\(n&gt;0\)</span> 时）</h3>
<p><span class="math display">\[\begin{align*}
\tilde\delta_n=&amp;\;\int_a^b\rho(x)\beta^n(x)\mathrm
dx=\int_{-1}^1(1-x^2)^{n-1/2}\mathrm dx\\
=&amp;\;\int_0^\pi\sin^{2n}x\mathrm dx=2\int_0^{\pi/2}\sin^{2n}x\mathrm
dx=\dfrac{(2n-1)!!}{(2n)!!}\pi.\\
\tilde
a_n=&amp;\;\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2)=\prod_{i=n+1}^{2n}(1-i)=(-n)(-n-1)\cdots(-2n+1)\\
=&amp;\;(-1)^n\dfrac{(2n-1)!}{(n-1)!}=(-1)^n\dfrac{n}{2n}\dfrac{(2n)!}{n!}=\dfrac{(-1)^n}{2}\dfrac{(2n)!}{n!},\\
A_n=&amp;\;\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}=\dfrac{(-1)^n\sqrt{\pi/2}}{\sqrt{[(2n)!/2]\cdot[(2n-1)!!/(2n)!!]\cdot\pi}}\\
=&amp;\;\dfrac{(-1)^n}{(2n-1)!!}=(-1)^n\dfrac{(2n)!!}{(2n)!}=\dfrac{(-1)^n2^{n}n!}{(2n)!}
.\end{align*}\]</span></p>
<h3 id="微分方程n0-时">微分方程（<span
class="math inline">\(n&gt;0\)</span> 时）</h3>
<p><span class="math display">\[
\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0\]</span>
<span class="math display">\[\Rightarrow\quad\quad
(1-x^2)T&#39;&#39;_n(x)-xT&#39;_n(x)+n^2T_n(x)=0.\]</span></p>
<h3 id="微分表达式n0-时">微分表达式（<span
class="math inline">\(n&gt;0\)</span> 时）</h3>
<p><span
class="math display">\[T_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm
d^n}{\mathrm
dx^n}[\rho(x)\beta^n(x)]=\dfrac{(-1)^n2^{n}n!}{(2n)!}\sqrt{1-x^2}\dfrac{\mathrm
d^n}{\mathrm dx^n}(1-x^2)^{n-1/2}.\]</span></p>
<h3 id="前两项系数n0-时">前两项系数（<span
class="math inline">\(n&gt;0\)</span> 时）</h3>
<p><span class="math display">\[a_{n,n}=A_n\tilde
a_n=\dfrac{(-1)^n2^{n}n!}{(2n)!}\cdot\dfrac{(-1)^n}{2}\dfrac{(2n)!}{n!}=2^{n-1},\]</span>
以及： <span
class="math display">\[a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}=0.\]</span></p>
<h3 id="递推关系n1-时">递推关系（<span
class="math inline">\(n&gt;1\)</span> 时）</h3>
<p><span
class="math display">\[T_{n+1}(x)=2xT_n(x)-T_{n-1}(x).\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
xT_n(x)=&amp;\;\dfrac{a_{n,n}}{a_{n+1,n+1}}T_{n+1}(x)+\left(\dfrac{a_{n,n-1}}{a_{n,n}}-\dfrac{a_{n+1,n}}{a_{n+1,n+1}}\right)T_{n}(x)+\dfrac{w_n^2a_{n-1,n-1}}{w_{n-1}^2a_{n,n}}T_{n-1}(x)\\
=&amp;\;\dfrac12T_{n+1}(x)+\dfrac{1}{2}T_{n-1}(x).\end{align*}\]</span></p>

    </div>
</div>
<p>取 <span class="math inline">\(x=\cos\theta\)</span>，就不难发现
<span class="math inline">\(n&gt;0\)</span> 时 <span
class="math display">\[T_n(\cos\theta)=\cos(n\theta).\]</span>
所以一般在 <span class="math inline">\(n=0\)</span> 时取 <span
class="math inline">\(T_0(x)=1\)</span>。</p>
<h3 id="生成函数-4">生成函数</h3>
<p><span class="math display">\[\begin{align*}
\dfrac{1-tx}{1+t^2-2tx}=\sum_{n=0}^\infty
T_n(x)t^n.
\end{align*}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>与一般理论中的生成函数并不相同</p>
<p>假定 <span class="math inline">\(x=\cos\theta\)</span>，那么： <span
class="math display">\[\begin{align*}
\sum_{n=0}^\infty
T_n(x)t^n=&amp;\;\sum_{n=0}^\infty\cos(n\theta)t^n=\dfrac12\sum_{n=0}^\infty
t^n(\mathrm e^{\mathrm in\theta}+\mathrm e^{-\mathrm
in\theta})=\dfrac12\sum_{n=0}^\infty[(t\mathrm e^{\mathrm
i\theta})^n+(t\mathrm e^{-\mathrm i\theta})^n]\\
=&amp;\;\dfrac12\left[\dfrac{1}{1-t\mathrm e^{\mathrm
i\theta}}+\dfrac{1}{1-t\mathrm e^{-\mathrm
i\theta}}\right]=\dfrac{1-t\cos\theta}{1+t^2-2t\cos\theta}=\dfrac{1-tx}{1+t^2-2tx}.
\end{align*}\]</span></p>

    </div>
</div>
<h2 id="雅可比多项式">雅可比多项式</h2>
<p>在上一部分的一般讨论中，取： <span
class="math display">\[[a,b]=[-1,1],\quad\rho(x)=(1-x)^\lambda(1+x)^\mu,\quad
\alpha(x)=(\mu-\lambda)-(\lambda+\mu)x,\quad \beta(x)=1-x^2,\]</span>
以及 <span class="math display">\[
w_n^2=\dfrac{2^{\lambda+\mu+1}}{2n+\lambda+\mu+1}\dfrac{\Gamma(n+\lambda+1)\Gamma(n+\mu+1)}{n!\Gamma(n+\lambda+\mu+1)}.\]</span>
得到的多项式就是雅可比多项式 <span
class="math inline">\(P^{(\lambda,\mu)}_n(x)\)</span>。取 <span
class="math inline">\(\lambda=\mu=0\)</span> 就能回到勒让德多项式。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        权重的导数的计算
    </div>
    <div class='spoiler-content'>
        <p><span class="math display">\[\begin{align*}
\dfrac{\rho&#39;(x)}{\rho(x)}=\dfrac{-\lambda}{1-x}+\dfrac{\mu}{1+x}=\dfrac{\mu-\lambda-(\mu+\lambda)x}{1-x^2}.\end{align*}\]</span></p>

    </div>
</div>
<h3 id="几个常数-3">几个常数</h3>
<p><span class="math display">\[\begin{align*}
\tilde\delta_n=&amp;\;\int_a^b\rho(x)\beta^n(x)\mathrm
dx=\int_{-1}^1(1-x)^{\lambda+n}(1+x)^{\mu+n}\mathrm dx\\
=&amp;\;\int_0^1(2-2t)^{\lambda+n}(2t)^{\mu+n}\mathrm(2t-1)=2^{\lambda+\mu+2n+1}\int_0^1(1-t)^{\lambda+n}t^{\mu+n}\mathrm
dt\\
=&amp;\;2^{\lambda+\mu+2n+1}\dfrac{\Gamma(\mu+n+1)\Gamma(\lambda+n+1)}{\Gamma(\lambda+\mu+2n+2)},\\
\tilde
a_n=&amp;\;\prod_{i=n+1}^{2n}(\alpha_1+i\beta_2)=\prod_{i=n+1}^{2n}[-(\mu+\lambda)-i]=(-1)^n\dfrac{\Gamma(\lambda+\mu+2n+1)}{\Gamma(\lambda+\mu+n+1)},\\
A_n=&amp;\;\dfrac{(-1)^nw_n}{\sqrt{(-1)^nn!\tilde\delta_n\tilde
a_n}}=(-1)^n\dfrac{\sqrt{\dfrac{2^{\lambda+\mu+1}}{2n+\lambda+\mu+1}\dfrac{\Gamma(n+\lambda+1)\Gamma(n+\mu+1)}{n!\Gamma(n+\lambda+\mu+1)}}}{\sqrt{n!2^{\lambda+\mu+2n+1}\dfrac{\Gamma(\mu+n+1)\Gamma(\lambda+n+1)}{\Gamma(\lambda+\mu+2n+2)}\dfrac{\Gamma(\lambda+\mu+2n+1)}{\Gamma(\lambda+\mu+n+1)}}}\\
=&amp;\;\dfrac{(-1)^n}{n!2^n}
.\end{align*}\]</span></p>
<h3 id="微分方程-4">微分方程</h3>
<p><span class="math display">\[
\beta(x)\varphi&#39;&#39;_n(x)+[\alpha(x)+\beta&#39;(x)]\varphi&#39;_n(x)-n[\alpha_1+(n+1)\beta_2]\varphi_n(x)=0\]</span>
<span class="math display">\[\Rightarrow\quad\quad (1-x^2)\dfrac{\mathrm
d^2}{\mathrm
dx^2}P^{(\lambda,\mu)}_n(x)+[(\mu-\lambda)-(\lambda+\mu+2)x]\dfrac{\mathrm
d}{\mathrm
dx}P^{(\lambda,\mu)}_n(x)+n(\lambda+\mu+n+1)P^{(\lambda,\mu)}_n(x)=0.\]</span></p>
<h3 id="微分表达式-4">微分表达式</h3>
<p><span
class="math display">\[P^{(\lambda,\mu)}_n(x)=A_n\dfrac{1}{\rho(x)}\dfrac{\mathrm
d^n}{\mathrm
dx^n}[\rho(x)\beta^n(x)]=\dfrac{(-1)^n}{n!2^n}(1-x)^{-\lambda}(1+x)^{-\mu}\dfrac{\mathrm
d^n}{\mathrm dx^n}[(1-x)^{\lambda+n}(1+x)^{\mu+n}].\]</span></p>
<h3 id="生成函数-5">生成函数</h3>
<p><span
class="math display">\[\dfrac{\left[w+1-\sqrt{1+w^2+2wz}\right]^\lambda\left[w-1+\sqrt{1+w^2+2wz}\right]^\mu}{w^{\lambda+\mu}(1-z)^\lambda(1+z)^\mu\sqrt{1+w^2+2wz}}=\sum_{n=0}^\infty(-1)^nP^{(\lambda,\mu)}_n(z)w^n.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p><span class="math inline">\(\xi-z-w\beta(\xi)=0\)</span>，也就是
<span class="math inline">\(\xi-z-w(1-\xi^2)=0\)</span> 的根为 <span
class="math display">\[\xi_-=\dfrac{-(w\beta_1-1)-\sqrt{(w\beta_1-1)^2-4w\beta_2(w\beta_0+z)}}{2w\beta_2}=\dfrac{1-\sqrt{1+4w(w+z)}}{-2w},\]</span>
于是： <span class="math display">\[\begin{align*}
\varPsi(z,w)=&amp;\;\dfrac{1}{\rho(z)}\dfrac{\rho(\xi_-)}{1-w\beta&#39;(\xi_-)}=\dfrac{(1-\xi_-)^\lambda(1+\xi_-)^\mu}{(1-z)^\lambda(1+z)^\mu}\dfrac{1}{1+2w\xi_-}\\
=&amp;\;\dfrac{(2w-2w\xi_-)^\lambda(2w+2w\xi_-)^\mu}{(2w)^{\lambda+\mu}(1-z)^\lambda(1+z)^\mu}\dfrac{1}{\sqrt{1+4w(w+z)}}\\
=&amp;\;\dfrac{\left[2w+1-\sqrt{1+4w(w+z)}\right]^\lambda\left[2w-1+\sqrt{1+4w(w+z)}\right]^\mu}{(2w)^{\lambda+\mu}(1-z)^\lambda(1+z)^\mu\sqrt{1+4w(w+z)}}
.\end{align*}\]</span> 它满足： <span
class="math display">\[\varPsi(z,w)=\sum_{n=0}^\infty\dfrac{\varphi_n(z)}{A_nn!}w^n=\sum_{n=0}^\infty(-1)^nP^{(\lambda,\mu)}_n(z)(2w)^n.\]</span>
也就是： <span
class="math display">\[\dfrac{\left[w+1-\sqrt{1+w^2+2wz}\right]^\lambda\left[w-1+\sqrt{1+w^2+2wz}\right]^\mu}{w^{\lambda+\mu}(1-z)^\lambda(1+z)^\mu\sqrt{1+w^2+2wz}}=\sum_{n=0}^\infty(-1)^nP^{(\lambda,\mu)}_n(z)w^n.\]</span></p>

    </div>
</div>
<h3 id="前两项的系数-3">前两项的系数</h3>
<p><span class="math display">\[a_{n,n}=A_n\tilde
a_n=\dfrac{\Gamma(\lambda+\mu+2n+1)}{n!2^n\Gamma(\lambda+\mu+n+1)},\]</span>
以及： <span
class="math display">\[a_{n,n-1}=n\dfrac{\alpha_0+n\beta_1}{\alpha_1+2n\beta_2}a_{n,n}=n\dfrac{\mu-\lambda}{-(\mu+\lambda)-2n}\dfrac{\Gamma(\lambda+\mu+2n+1)}{n!2^n\Gamma(\lambda+\mu+n+1)}=-\dfrac{\mu-\lambda}{(n-1)!2^n}\dfrac{\Gamma(\lambda+\mu+2n)}{\Gamma(\lambda+\mu+n+1)}.\]</span></p>
<h3 id="递推关系-4">递推关系</h3>
<p>略</p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/electromagnetism-dielectric/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/electromagnetism-dielectric/" class="post-title-link" itemprop="url">介电常数与电导率</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-22 21:35:47" itemprop="dateModified" datetime="2024-07-22T21:35:47+08:00">2024-07-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在很多地方都能看到介电函数的虚部就是电导率的说法，于是就仔细地考虑了这个问题。</p>
<hr />
<h1 id="介质中的麦克斯韦方程组">介质中的麦克斯韦方程组</h1>
<h2 id="麦克斯韦方程组">麦克斯韦方程组</h2>
<p>一切经典电磁学/光学问题在根源上都能用麦克斯韦方程组解决：</p>
<p><span class="math display">\[\begin{align}\label{Maxwell0}
\left\lbrace\begin{array}{rcl}
\nabla\cdot\boldsymbol E&amp;=&amp;\dfrac{R_1^2c^2}{4R_2}\rho,\\
\nabla\times\boldsymbol
B&amp;=&amp;\dfrac{1}{c^2R_1}\dfrac{\partial\boldsymbol E}{\partial
t}+\dfrac{R_1}{4R_2}\boldsymbol j,\\[2.5mm]
\nabla\cdot\boldsymbol B&amp;=&amp;0,\\
\nabla\times\boldsymbol E&amp;=&amp;-R_1\dfrac{\partial\boldsymbol
B}{\partial t}.
\end{array}  \right.
\end{align}\]</span> 其中 <span class="math inline">\(\rho\)</span> 与
<span class="math inline">\(\boldsymbol j\)</span>
是参与形成电磁场的总电荷与总电流。常数 <span
class="math inline">\(R_{1,2,3}\)</span> 分别为： <span
class="math display">\[\begin{align*}
\left\lbrace\begin{array}{llll}
\text{国际单位制：}&amp;R_1=1\quad&amp;R_2=\dfrac{1}{4\mu_0}\quad&amp;R_3=1.\\[4mm]
\text{高斯单位制：}&amp;R_1=\dfrac1c\quad&amp;R_2=\dfrac{1}{16\pi}\quad&amp;R_3=4\pi.\\
\end{array}  \right.
\end{align*}\]</span></p>
<h2 id="介质中的麦克斯韦方程组-1">介质中的麦克斯韦方程组</h2>
<p>现在我们来给一块物质加上电磁场。物质中总是包含大量微观粒子，它们有自己的电荷与磁矩，在电磁场的<strong>极化效应</strong>与<strong>磁化效应</strong>的影响下，微观粒子的电荷与磁矩会发生重新排布。重新排布的电荷与磁矩又会产生自己的电磁场，最终的电磁场分布就是外加的电磁场与物质内部微观粒子贡献的电磁场之和。</p>
<h3 id="极化效应">极化效应</h3>
<p>给物质加上电场时，这块物质可能会出现极化效应：电场会使物质内部的正负电荷具有朝相反方向移动的倾向，进而使物质内部出现电偶极矩。单位体积内的电偶极矩的大小记为
<span class="math inline">\(\boldsymbol
P\)</span>，它从负电荷指向正电荷。</p>
<p>在这里，我们约定 <span class="math inline">\(\boldsymbol P\)</span>
包含了物质内部的所有电荷，既包含那些可以在物质内部自由移动的“自由电荷”，也包含那些不能在物质内部自由移动的“束缚电荷”，并且将前者与那些从外界手动引入的电荷
<span class="math inline">\(\rho_{\text{ex}}\)</span>、<span
class="math inline">\(\boldsymbol j_{\text{ex}}\)</span>
视为不同的电荷——要将电导率视为介电函数的虚部就必须这样做。</p>
<p>我们当然也可以采用另一种等价的做法：将物质内部的这些“自由电荷”归入
<span class="math inline">\(\rho_{\text{ex}}\)</span> 与 <span
class="math inline">\(\boldsymbol j_{\text{ex}}\)</span>
中并将二者统称为自由电荷，此时 <span class="math inline">\(\boldsymbol
P\)</span>
就应该只包含“束缚电荷”的贡献。为了讨论介电函数与电导率的关系，我们不采用这种做法。</p>
<p>可以证明，这些电偶极矩可以贡献的电荷密度与电流密度分别是： <span
class="math display">\[\begin{align*}
\rho_ P=-\nabla\cdot\boldsymbol P,\quad \boldsymbol
j_P=\dfrac{\partial\boldsymbol P}{\partial t}.
\end{align*}\]</span></p>
<h3 id="磁化效应">磁化效应</h3>
<p>给物质加上磁场时，这块物质可能会出现磁化效应：磁场会使物质内部的磁矩定向排列，进而使物质内部出现磁矩。单位体积内的磁矩的大小记为
<span class="math inline">\(\boldsymbol
M\)</span>。可以证明，这些磁矩的效果等同于一个电流密度 <span
class="math inline">\(\boldsymbol j_M\)</span>，其大小为： <span
class="math display">\[\begin{align*}
\boldsymbol j_M=\dfrac{1}{R_1}\nabla\times\boldsymbol M.
\end{align*}\]</span></p>
<h3 id="介质中的麦克斯韦方程组-2">介质中的麦克斯韦方程组</h3>
<p>在考虑介质中的极化效应和磁化效应后，麦克斯韦方程组 (<span
class="math inline">\(\ref{Maxwell0}\)</span>) 就变成了： <span
class="math display">\[\begin{align*}
\left\lbrace\begin{array}{rcl}
\nabla\cdot\boldsymbol
E&amp;=&amp;\dfrac{R_1^2c^2}{4R_2}(\rho_{\text{ex}}-\nabla\cdot\boldsymbol
P),\\
\nabla\times\boldsymbol
B&amp;=&amp;\dfrac{1}{c^2R_1}\dfrac{\partial\boldsymbol E}{\partial
t}+\dfrac{R_1}{4R_2}\left( \boldsymbol
j_{\text{ex}}+\dfrac{\partial\boldsymbol P}{\partial
t}+\dfrac{1}{R_1}\nabla\times\boldsymbol M\right) ,\\[2.5mm]
\nabla\cdot\boldsymbol B&amp;=&amp;0,\\
\nabla\times\boldsymbol E&amp;=&amp;-R_1\dfrac{\partial\boldsymbol
B}{\partial t}.
\end{array}  \right.
\end{align*}\]</span> 其中 <span
class="math inline">\(\rho_{\text{ex}}\)</span> 与 <span
class="math inline">\(\boldsymbol j_{\text{ex}}\)</span>
分别表示从外界引入介质中的电荷密度与电流密度，即并非由介质内部的微观粒子贡献的电荷密度与电流密度。</p>
<p>我们可以定义电位移 <span class="math inline">\(\boldsymbol D\)</span>
与磁场强度 <span class="math inline">\(\boldsymbol H\)</span>： <span
class="math display">\[\begin{align*}
\boldsymbol D:= R_3\left[\dfrac{4R_2}{R_1^2c^2}\boldsymbol E+\boldsymbol
P\right],\quad \boldsymbol H:= R_3(4R_2\boldsymbol B-\boldsymbol M).
\end{align*}\]</span> 于是麦克斯韦方程组就变成了： <span
class="math display">\[\begin{align}\label{Maxwell}
\left\lbrace\begin{array}{rcl}
\nabla\cdot\boldsymbol D&amp;=&amp;R_3\rho_{\text{ex}},\\
\nabla\times\boldsymbol H&amp;=&amp;R_1\dfrac{\partial\boldsymbol
D}{\partial t}+R_1R_3\boldsymbol j_{\text{ex}},\\
\nabla\cdot\boldsymbol B&amp;=&amp;0,\\
\nabla\times\boldsymbol E&amp;=&amp;-R_1\dfrac{\partial\boldsymbol
B}{\partial t}.
\end{array}  \right.
\end{align}\]</span> 这就是介质中的麦克斯韦方程组。</p>
<p>从表达式中可以看出，<span class="math inline">\(\boldsymbol
D\)</span> 与 <span class="math inline">\(\boldsymbol H\)</span>
只与自由电荷有关，<span class="math inline">\(\boldsymbol D\)</span>
刻画的是在总电场中扣除掉那些由物质内部的电荷引起的电场之后剩下的部分，<span
class="math inline">\(\boldsymbol H\)</span>
刻画的是在总磁场中扣除掉那些由介质内部的磁矩引起的磁场之后剩下的部分。在某种程度上可以认为它们体现的是没有物质时外加电场或外加磁场的大小，但我们必须注意，<span
class="math inline">\(\boldsymbol D\)</span> 与 <span
class="math inline">\(\boldsymbol H\)</span>
实际上也受到物质的影响。</p>
<h1 id="介电函数与电导率">介电函数与电导率</h1>
<h2 id="频率空间的麦克斯韦方程组">频率空间的麦克斯韦方程组</h2>
<p>现在，我们考虑一个按固定频率变化的电磁场： <span
class="math display">\[\begin{align}
X(t) = \mathrm{Re}\left\lbrace  \int\dfrac{\mathrm d\omega}{2\pi}
X(\omega)\mathrm e^{-\mathrm i \omega t} \right\rbrace ,\quad
X=\boldsymbol E,\boldsymbol B,\boldsymbol H,\boldsymbol
D,\rho,\boldsymbol j.
\end{align}\]</span> 注意：对 <span class="math inline">\(t\)</span>
求导与取实部是对易的。</p>
<p>由于麦克斯韦方程组是线性的，所以可以得到： <span
class="math display">\[\begin{align}\label{Maxwell-frequency}
\left\lbrace\begin{array}{rcl}
\nabla\cdot\boldsymbol
D(\omega)&amp;=&amp;R_3\rho_{\text{ex}}(\omega),\\
\nabla\times\boldsymbol H(\omega)&amp;=&amp;-\mathrm i\omega
R_1\boldsymbol D(\omega)+R_1R_3\boldsymbol j_{\text{ex}}(\omega),\\
\nabla\cdot\boldsymbol B(\omega)&amp;=&amp;0,\\
\nabla\times\boldsymbol E(\omega)&amp;=&amp;\mathrm i\omega
R_1\boldsymbol B(\omega).
\end{array}  \right.
\end{align}\]</span></p>
<span class="math inline">\(\boldsymbol P\)</span> 和 <span
class="math inline">\(\boldsymbol M\)</span>，也就是 <span
class="math inline">\(\boldsymbol D\)</span> 和 <span
class="math inline">\(\boldsymbol H\)</span>
与外场之间的关系由物质本身的性质决定。在各向同性均匀介质中，如果线性响应理论成立，就有：
<span class="math display">\[\begin{align}\label{linear-response}
\left\lbrace\begin{array}{rcl}
\boldsymbol D(\omega)&amp;=&amp;\varepsilon_r(\omega)\left[
\dfrac{4R_2R_3}{R_1^2c^2}\right]\boldsymbol E(\omega),\\
\boldsymbol H(\omega)&amp;=&amp;\dfrac{1}{\mu_r} 4R_2R_3 \boldsymbol
B(\omega).
\end{array}  \right.
\end{align}\]</span>
<p><span class="math inline">\(\varepsilon_r(\omega)\)</span>
称为相对介电常数，<span class="math inline">\(\mu_r(\omega)\)</span>
称为相对磁导率。</p>
<p>一个需要注意的地方是：在线性响应理论中，<span
class="math inline">\(\boldsymbol D\propto\boldsymbol E\)</span>
这样的关系式是在频率空间上才成立的，在时域上不成立。例如 <span
class="math display">\[\boldsymbol
D(\omega)=[4R_2R_3/(R_1^2c^2)]\varepsilon_r(\omega)\boldsymbol
E(\omega)\]</span> 是正确的，而 <span class="math inline">\(\boldsymbol
D(t)=[4R_2R_3/(R_1^2c^2)]\varepsilon_r(t)\boldsymbol E(t)\)</span>
是错误的：正确的 <span class="math inline">\(\boldsymbol D(t)\)</span>
应该通过对 <span class="math inline">\(\boldsymbol D(\omega)\)</span>
做逆傅里叶变换得到——或者等价地，通过对 <span
class="math inline">\(\varepsilon(t)\)</span> 与 <span
class="math inline">\(\boldsymbol E(t)\)</span>
做卷积之类的操作得到——因为响应不可能是瞬时的。也正因为这个理由，在完成电磁波相关的推导时，我们应该直接从单色平面波出发以免产生混乱。</p>
<h2 id="响应函数的物理含义">响应函数的物理含义</h2>
<p>现在我们简要地说明 <span
class="math inline">\(\varepsilon_r(\omega)\)</span> 和 <span
class="math inline">\(\mu_r(\omega)\)</span> 的物理含义。我们假定 <span
class="math inline">\(\varepsilon_r:=\varepsilon_r(0)\)</span> 和 <span
class="math inline">\(\mu_r:=\mu_r(0)\)</span> 都为实数，且 <span
class="math inline">\(\varepsilon_r&gt;1\)</span>（经常如此）。</p>
<p>如果将大小为 <span class="math inline">\(q\)</span>
的自由电荷手动放入介质内，它就会吸引异号电荷、排斥同号电荷，进而影响介质内部的电荷分布，最终这一自由电荷与它吸引过来的电荷之和就是
<span
class="math inline">\(q/\varepsilon_r\)</span>，相当于这个电荷被“抵消”了一部分。</p>
<p>如果给物质外加一个恒定磁场，那么物质内部的磁矩也将在磁场的驱动下规则排列，进而对总磁场产生影响。<span
class="math inline">\(\chi_m := (\mu_r-1)/R_3\)</span>
常被称为磁化率，受外加磁场影响，单位体积内总磁矩的大小就是 <span
class="math inline">\(\boldsymbol M=\chi_m\boldsymbol H\)</span>。</p>
<h2 id="介电函数与电导率的联系">介电函数与电导率的联系</h2>
<p>我们来观察 (<span
class="math inline">\(\ref{Maxwell-frequency}\)</span>)
式的第二个式子，它可被写为： <span class="math display">\[\begin{align}
\nabla\times\boldsymbol H(\omega)=R_1R_3\left[ -\mathrm i \omega
\varepsilon_r(\omega)\dfrac{4R_2}{R_1^2c^2}\boldsymbol
E(\omega)+\boldsymbol j_{\text{ex}}(\omega)\right].
\end{align}\]</span>
在电场的驱动下，物质内部的电荷也可能有运动，例如在金属中，最外层的价电子就可以在整个金属内部运动。相应的电流密度可通过
<span class="math inline">\(\boldsymbol J_P=\partial \boldsymbol
P/\partial t\)</span> 求出： <span class="math display">\[\begin{align}
\boldsymbol j_P(\omega)=-\mathrm i\omega \boldsymbol P(\omega)=-\mathrm
i\omega [\varepsilon_r(\omega)-1]\dfrac{4R_2}{R_1^2c^2}\boldsymbol
E(\omega).
\end{align}\]</span> 假设 <span
class="math inline">\(\varepsilon_r(\omega)\)</span> 是一个复数：<span
class="math inline">\(\varepsilon_r(\omega)=\varepsilon_r&#39;(\omega)+\mathrm
i\varepsilon_r&#39;&#39;(\omega)\)</span>，且其虚部的形式为： <span
class="math display">\[\begin{align}
\varepsilon_r&#39;&#39;(\omega):=
\dfrac{R_1^2c^2}{4R_2}\dfrac{\sigma&#39;(\omega)}{\omega},
\end{align}\]</span> 代入极化电流的表达式，就发现： <span
class="math display">\[\begin{align}
\boldsymbol j_P(\omega)=-\mathrm i\omega
[\varepsilon_r&#39;(\omega)-1]\dfrac{4R_2}{R_1^2c^2}\boldsymbol
E(\omega)+\sigma&#39;(\omega)\boldsymbol E(\omega).
\end{align}\]</span> 后一项的形式与欧姆定律相同。</p>
<p>实际上，因为我们考虑的 <span class="math inline">\(\boldsymbol
P\)</span>
既包含了不能在物质内自由运动的“束缚电荷”，也包含了可以在物质内自由运动的“自由电荷”（这是物质内部的电荷，与
<span class="math inline">\(\rho_{\text{ex}}\)</span> 和 <span
class="math inline">\(\boldsymbol j_{\text{ex}}\)</span>
这些外加的电荷并不一样），这些“自由电荷”的电导率就贡献了介电函数的虚部。如果我们在定义
<span class="math inline">\(\boldsymbol P\)</span> 时认为 <span
class="math inline">\(\boldsymbol P\)</span>
不包含那些物质内部的“自由电荷”的贡献，那么这些自由电荷贡献出的电流就应该和
<span class="math inline">\(\boldsymbol j_{\text{ex}}\)</span>
一起算入自由电流中。但是在真实的体系中，“束缚电荷”与“自由电荷”的区别并不明显，因此，我个人更喜欢将二者同时包含在
<span class="math inline">\(\boldsymbol{P}\)</span> 内的做法。</p>
<p>从这里可以看出，电导率实际上就是复介电函数的虚部。我们也可以定义一个复电导率，使得介电函数就是复电导率的虚部：
<span class="math display">\[\begin{align}
\sigma(\omega)=\sigma&#39;(\omega)-\mathrm i\omega
\varepsilon_r&#39;(\omega)\dfrac{4R_2}{R_1^2c^2}=-\mathrm
i\dfrac{4R_2}{R_1^2c^2}\omega\varepsilon_r(\omega).
\end{align}\]</span></p>
<h2
id="将自由电荷与束缚电荷分开考虑时的麦克斯韦方程组">将自由电荷与束缚电荷分开考虑时的麦克斯韦方程组</h2>
<p>最后，我们假定 <span
class="math inline">\(\varepsilon_r&#39;\)</span> 与 <span
class="math inline">\(\sigma&#39;\)</span>
都是不依赖于频率的常数，然后来推导将 <span
class="math inline">\(\sigma&#39;\)</span>
单独拿出时的麦克斯韦方程组。首先，电位移与磁化强度是： <span
class="math display">\[\begin{align}
\begin{split}
\boldsymbol D(\omega)&amp;=\varepsilon_r(\omega)\left[
\dfrac{4R_2R_3}{R_1^2c^2}\right]\boldsymbol
E(\omega)=\varepsilon_r&#39;\left[
\dfrac{4R_2R_3}{R_1^2c^2}\right]\boldsymbol E(\omega)+\mathrm i
R_3\dfrac{\sigma&#39;}{\omega}\boldsymbol E(\omega):= \boldsymbol
D&#39;(\omega)+\boldsymbol D&#39;&#39;(\omega),\\
\boldsymbol
P(\omega)&amp;=\dfrac{\varepsilon_r(\omega)-1}{R_3\varepsilon_r(\omega)}\boldsymbol
D(\omega)=(\varepsilon_r&#39;-1)\left[
\dfrac{4R_2}{R_1^2c^2}\right]\boldsymbol E(\omega)+\mathrm
i\dfrac{\sigma&#39;}{\omega}\boldsymbol E(\omega):= \boldsymbol
P&#39;(\omega)+\boldsymbol P&#39;&#39;(\omega).
\end{split}
\end{align}\]</span> 介质内部自由电荷的密度是： <span
class="math display">\[\begin{align}
\rho&#39;&#39;(\omega):=-\nabla\cdot\boldsymbol
P&#39;&#39;(\omega)=-\dfrac{1}{R_3}\nabla\cdot\boldsymbol
D&#39;&#39;(\omega).
\end{align}\]</span> 转换到时域，我们发现： <span
class="math display">\[\begin{align}
\boldsymbol D&#39;&#39;(t)=\int\dfrac{\mathrm d\omega}{2\pi}\boldsymbol
D&#39;&#39;(\omega)\mathrm e^{-\mathrm i\omega t}=\int\dfrac{\mathrm
d\omega}{2\pi}\mathrm i R_3\dfrac{\sigma&#39;}{\omega}\boldsymbol
E(\omega)\mathrm e^{-\mathrm i\omega t},\quad \dfrac{\partial\boldsymbol
D&#39;&#39;(t)}{\partial t}=R_3\sigma&#39;\boldsymbol E(t).
\end{align}\]</span> 于是： <span class="math display">\[\begin{align}
\begin{split}
\nabla\cdot\boldsymbol D=R_3\rho_{\text{ex}}\quad&amp;\Rightarrow\quad
\nabla\cdot\boldsymbol D&#39;=R_3(\rho_{\text{ex}}+\rho&#39;&#39;),\\
\nabla\times\boldsymbol H=R_1\dfrac{\partial\boldsymbol D}{\partial
t}+R_1R_3\boldsymbol j_{\text{ex}}\quad&amp;\Rightarrow\quad
\nabla\times\boldsymbol H=R_1\dfrac{\partial\boldsymbol D&#39;}{\partial
t}+R_1R_3(\boldsymbol j_{\text{ex}}+\sigma&#39;\boldsymbol E).
\end{split}
\end{align}\]</span> 所以麦克斯韦方程组也可以写为： <span
class="math display">\[\begin{align}\label{Maxwell sigma}
\left\lbrace\begin{array}{rcl}
\nabla\cdot\boldsymbol
D&#39;&amp;=&amp;R_3(\rho_{\text{ex}}+\rho&#39;&#39;),\\
\nabla\times\boldsymbol H&amp;=&amp;R_1\dfrac{\partial\boldsymbol
D&#39;}{\partial t}+R_1R_3(\boldsymbol
j_{\text{ex}}+\sigma&#39;\boldsymbol E),\\
\nabla\cdot\boldsymbol B&amp;=&amp;0,\\
\nabla\times\boldsymbol E&amp;=&amp;-R_1\dfrac{\partial\boldsymbol
B}{\partial t}.
\end{array}  \right.
\end{align}\]</span>
这种形式的麦克斯韦方程组在某些场景下也会出现——特别是将 <span
class="math inline">\(\boldsymbol{j}_{\text{ex}}\)</span> 写为 <span
class="math inline">\(\sigma\boldsymbol{E}\)</span> 的情形。</p>
<h1
id="介电函数与电导率的经典微观模型">介电函数与电导率的经典微观模型</h1>
<h2 id="经典微观模型">经典微观模型</h2>
<p>复介电函数（含有电导率，即认为 <span
class="math inline">\(\boldsymbol P\)</span>
包含了介质内部的自由电荷与束缚电荷）的行为可由一个经典模型来描述。假设物质中有一个电量为
<span class="math inline">\(q\)</span> 、质量为 <span
class="math inline">\(m\)</span> 的微观粒子，其位置记为 <span
class="math inline">\(\boldsymbol
r\)</span>，我们假设它被束缚在原点附近，以 <span
class="math inline">\(\omega_0\)</span> 为频率做简谐运动：<span
class="math inline">\(m\ddot{\boldsymbol r}=-m\omega_0^2\boldsymbol
r\)</span>。注意：如果 <span
class="math inline">\(\omega_0=0\)</span>，就意味着它实际上是自由电荷。</p>
<p>现在我们给这块物质加上电场 <span class="math inline">\(\boldsymbol
E=\boldsymbol E_0\mathrm e^{-\mathrm
i\omega_0t}\)</span>，那么这个粒子就会在电场的驱动下发生运动。我们还假设它会受到一个阻尼力
<span class="math inline">\(-m\beta\dot{\boldsymbol
r}/\tau\)</span>。于是，这个粒子的运动方程就是： <span
class="math display">\[\begin{align}
m\ddot{\boldsymbol r}+m\dot{\boldsymbol r}/\tau+m\omega_0^2\boldsymbol
r=q\boldsymbol E_0\mathrm e^{-\mathrm i\omega_0t}.
\end{align}\]</span> 这个方程有一个解： <span
class="math display">\[\begin{align}
\boldsymbol r=-\dfrac{q\boldsymbol
E_0}{m}\dfrac{1}{\omega^2-\omega_0^2+\mathrm i\omega/\tau}\mathrm
e^{-\mathrm i\omega t}.
\end{align}\]</span>
它刻画了外加电场之后粒子对平衡位置的偏离，于是这个粒子给出的偶极矩就是：
<span class="math display">\[\begin{align}
\boldsymbol p:= q\boldsymbol
r=-\dfrac{q^2}{m}\dfrac{1}{\omega^2-\omega_0^2+\mathrm
i\omega/\tau}\boldsymbol E_0\mathrm e^{-\mathrm i\omega
t}=-\dfrac{q^2}{m}\dfrac{1}{\omega^2-\omega_0^2+\mathrm
i\omega/\tau}\boldsymbol E.
\end{align}\]</span></p>
<p>假设物质有多种粒子，第 <span class="math inline">\(i\)</span>
种粒子的总数量为 <span
class="math inline">\(N_i\)</span>，那么物质的极化强度就是： <span
class="math display">\[\begin{align}
\boldsymbol
P=-\sum_i\dfrac{q^2_iN_i}{m_iV}\dfrac{1}{\omega^2-\omega_{0,i}^2+\mathrm
i\omega/\tau_i}\boldsymbol
E=-\dfrac{4R_2}{R_1^2c^2}\sum_i\dfrac{\omega_{p,i}^2}{\omega^2-\omega_{0,i}^2+\mathrm
i\omega/\tau_i}\boldsymbol E.
\end{align}\]</span> 其中特征频率 <span
class="math inline">\(\omega_{p,i}\)</span> 的定义为： <span
class="math display">\[\begin{align}
\omega_{p,i}^2:=\dfrac{R_1^2c^2}{4R_2}\dfrac{N_i}{V}\dfrac{q_i^2}{m_i}.
\end{align}\]</span> 对比 <span class="math inline">\(\boldsymbol
P=[\varepsilon_r(\omega)-1]\dfrac{4R_2}{R_1^2c^2}\boldsymbol
E(\omega)\)</span>，我们发现 <span class="math display">\[\begin{align}
\begin{split}
\varepsilon_r(\omega)&amp;=1-\sum_i\dfrac{\omega_{p,i}^2}{\omega^2-\omega_{0,i}^2+\mathrm
i\omega/\tau_i}\\
&amp;=1-\sum_i\omega_{p,i}^2\dfrac{\omega^2-\omega_{0,i}^2}{(\omega^2-\omega_{0,i}^2)^2+(\omega/\tau_i)^2}+\mathrm
i\sum_i\omega_{p,i}^2\dfrac{\omega/\tau_i}{(\omega^2-\omega_{0,i}^2)^2+(\omega/\tau_i)^2}.
\end{split}
\end{align}\]</span></p>
<h2 id="不同粒子的贡献">不同粒子的贡献</h2>
<p>显然，在以上表达式中，各个不同种类的粒子对介电函数的贡献可以分别考虑。</p>
<p>我们先考虑束缚电荷，也就是 <span
class="math inline">\(\omega_0\neq0\)</span>
的那些粒子对介电函数的贡献。假设只有一种束缚且其总数为 <span
class="math inline">\(N\)</span>，于是它们对复电导率的贡献就是： <span
class="math display">\[\begin{align}\label{classical sigma formula}
\sigma_{\text{bound}}(\omega)=-\mathrm
i\dfrac{4R_2}{R_1^2c^2}\omega\left[
-\dfrac{\omega_p^2}{\omega^2-\omega_0^2+\mathrm i\omega/\tau}\right]
=\mathrm
i\dfrac{N}{V}\dfrac{q^2}{m}\dfrac{\omega}{\omega^2-\omega_0^2+\mathrm
i\omega/\tau}.
\end{align}\]</span> 取实部就得到电导率的洛伦兹公式。</p>
<p>现在，我们来考虑自由电荷，也就是 <span
class="math inline">\(\omega_0=0\)</span>
的那些粒子对介电函数的贡献。假设只有一种自由电荷，并且假定其总数为 <span
class="math inline">\(N\)</span>，于是它们对复电导率的贡献就是： <span
class="math display">\[\begin{align}
\sigma_{\text{free}}(\omega)=-\mathrm
i\dfrac{4R_2}{R_1^2c^2}\omega\left[
-\omega_p^2\dfrac{1}{\omega^2+\mathrm i\omega/\tau}\right] =\mathrm
i\dfrac{N}{V}\dfrac{q^2}{m}\dfrac{\tau}{\omega\tau+\mathrm i}.
\end{align}\]</span> 其实部给出电导率： <span
class="math display">\[\begin{align}
\sigma&#39;(\omega)=\dfrac{N}{V}\dfrac{q^2\tau}{m(1+\omega^2\tau^2)},\quad
\sigma(\omega=0)=\dfrac{N}{V}\dfrac{q^2\tau}{m}.
\end{align}\]</span> 后者就是直流电导的 Drude 公式。</p>
<hr />
<h1 id="参考书籍">参考书籍</h1>
<ul>
<li>《新概念物理教程 · 电磁学（第二版）》赵凯华，陈熙谋.<span
class="math inline">\(\quad\)</span>北京：高等教育出版社，2006.</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/06/01/LinearAlgebra/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/06/01/LinearAlgebra/" class="post-title-link" itemprop="url">线性代数（杂乱的问题）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-01 00:00:00" itemprop="dateCreated datePublished" datetime="2024-06-01T00:00:00+08:00">2024-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-09 14:46:22" itemprop="dateModified" datetime="2024-08-09T14:46:22+08:00">2024-08-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr />
<h1 id="一些行列式公式">一些行列式公式</h1>
<h2 id="范德蒙行列式">范德蒙行列式</h2>
<p><span class="math display">\[\begin{vmatrix}
1&amp;1&amp;\cdots&amp;1\\
x_1&amp;x_2&amp;\cdots&amp;x_n\\
x_1^2&amp;x_2^2&amp;\cdots&amp;x_n^2\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
x_1^{n-1}&amp;x_2^{n-1}&amp;\cdots&amp;x_n^{n-1}
\end{vmatrix}=\prod_{1\leqslant i&lt;j\leqslant
n}(x_j-x_i).\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>数学归纳法。</p>
<p><span class="math inline">\(n=1\)</span> 时行列式为 <span
class="math inline">\(1\)</span>。<span
class="math inline">\(n=2\)</span> 时为 <span
class="math inline">\((x_2-x_1)\)</span>。</p>
<p>假设 <span class="math inline">\(n\leqslant k-1\)</span>
时结果成立。那么在 <span class="math inline">\(n=k\)</span>
时，从最后一行开始，每一行减去上一行乘以 <span
class="math inline">\(x_1\)</span>，得到的结果是：</p>
<p><span class="math display">\[\begin{align*}
\mathrm{LHS}&amp;=\begin{vmatrix}
1&amp;1&amp;\cdots&amp;1\\
0&amp;x_2-x_1&amp;\cdots&amp;x_k-x_1\\
0&amp;x_2^2-x_1\cdot x_2&amp;\cdots&amp;x_k^2-x_1\cdot x_k\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
0&amp;x_2^{k-1}-x_1\cdot x_2^{k-2}&amp;\cdots&amp;x_k^{k-1}-x_1\cdot
x_k^{k-2}
\end{vmatrix}\\
&amp;=\begin{vmatrix}
x_2-x_1&amp;\cdots&amp;x_k-x_1\\
x_2^2-x_1\cdot x_2&amp;\cdots&amp;x_k^2-x_1\cdot x_k\\
\vdots&amp;\ddots&amp;\vdots\\
x_2^{k-1}-x_1\cdot x_2^{k-2}&amp;\cdots&amp;x_k^{k-1}-x_1\cdot x_k^{k-2}
\end{vmatrix}\\
&amp;=\begin{vmatrix}
x_2-x_1&amp;\cdots&amp;x_k-x_1\\
x_2\cdot(x_2-x_1)&amp;\cdots&amp;x_k\cdot(x_k-x_1)\\
\vdots&amp;\ddots&amp;\vdots\\
x_2^{k-2}\cdot(x_2-x_1)&amp;\cdots&amp;x_k^{k-2}\cdot(x_k-x_1)
\end{vmatrix}\\
&amp;=(x_k-x_1)\cdots(x_2-x_1)\cdot\begin{vmatrix}
1&amp;\cdots&amp;1\\
x_2&amp;\cdots&amp;x_k\\
\vdots&amp;\ddots&amp;\vdots\\
x_2^{k-2}&amp;\cdots&amp;x_k^{k-2}
\end{vmatrix}\\
&amp;=(x_k-x_1)\cdots(x_2-x_1)\cdot\prod_{2\leqslant i&lt;j\leqslant
k}(x_j-x_i)\\
&amp;=\prod_{1\leqslant i&lt;j\leqslant k}(x_j-x_i).
\end{align*}\]</span> 因此以上结论在 <span
class="math inline">\(n=k\)</span> 时也成立。</p>

    </div>
</div>
<h2 id="循环行列式">循环行列式</h2>
<p><span class="math display">\[\begin{vmatrix}
a_0&amp;a_1&amp;a_2&amp;\cdots&amp;a_{n-2}&amp;a_{n-1}\\
a_{n-1}&amp;a_0&amp;a_1&amp;\cdots&amp;a_{n-3}&amp;a_{n-2}\\
a_{n-2}&amp;a_{n-1}&amp;a_0&amp;\cdots&amp;a_{n-4}&amp;a_{n-3}\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\
a_2&amp;a_3&amp;a_4&amp;\cdots&amp;a_0&amp;a_1\\
a_1&amp;a_2&amp;a_3&amp;\cdots&amp;a_{n-1}&amp;a_0
\end{vmatrix}=\prod_{k=1}^nf(w_k)\]</span> 其中： <span
class="math display">\[w_k=\mathrm e^{2\pi\mathrm i\cdot k/n},\quad
f(x)=a_0+a_1x^1+\cdots+a_{n-1}x^{n-1}.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>取矩阵 <span class="math display">\[
V=\begin{vmatrix}
1&amp;1&amp;\cdots&amp;1\\
w_1&amp;w_2&amp;\cdots&amp;w_n\\
w_1^2&amp;w_2^2&amp;\cdots&amp;w_n^2\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
w_1^{n-1}&amp;w_2^{n-1}&amp;\cdots&amp;w_n^{n-1}
\end{vmatrix},\quad w_k=\mathrm e^{2\pi\mathrm i\cdot k/n}.\]</span>
然后不难算出： <span class="math display">\[\begin{align*}
\mathrm{LHS}\cdot\det(V)&amp;=\begin{vmatrix}
f(w_1)&amp;f(w_2)&amp;\cdots&amp;f(w_n)\\
w_1f(w_1)&amp;w_2f(w_2)&amp;\cdots&amp;w_nf(w_n)\\
w_1^2f(w_1)&amp;w_2^2f(w_2)&amp;\cdots&amp;w_n^2f(w_n)\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
w_1^{n-1}f(w_1)&amp;w_2^{n-1}f(w_2)&amp;\cdots&amp;w_n^{n-1}f(w_n)
\end{vmatrix}\\
&amp;=\left[\prod_{k=1}^nf(w_k)\right]\cdot\det(V).
\end{align*}\]</span></p>

    </div>
</div>
<h2 id="det1x_i-y_j-或-det1a_i-b_j"><span
class="math inline">\(\det[1/(x_i-y_j)]\)</span> 或 <span
class="math inline">\(\det[1/(a_i-b_j)]\)</span></h2>
<p><span class="math display">\[\begin{vmatrix}
\dfrac{1}{x_1-y_1}&amp;\dfrac{1}{x_1-y_2}&amp;\cdots&amp;\dfrac{1}{x_1-y_n}\\
\dfrac{1}{x_2-y_1}&amp;\dfrac{1}{x_2-y_2}&amp;\cdots&amp;\dfrac{1}{x_2-y_n}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
\dfrac{1}{x_n-y_1}&amp;\dfrac{1}{x_n-y_2}&amp;\cdots&amp;\dfrac{1}{x_n-y_n}\\
\end{vmatrix}=\dfrac{(-1)^{n(n-1)/2}\displaystyle\prod_{i&lt;j}(x_j-x_i)(y_j-y_i)}{\displaystyle\prod_{i,j}(x_i-y_j)}.\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>一开始的时候根本不知道怎么算，几年后看到了 <a
target="_blank" rel="noopener" href="https://journals.aps.org/prd/abstract/10.1103/PhysRevD.11.2088">一篇文献</a>
的 (4.11) 与 (4.18)
式，根据答案，自己凑了一个丑陋的证明。后来在和同学讨论的时候，被告知了一个机智的证明思路。</p>
<hr />
<p><strong>丑陋的证明</strong>：</p>
<p>将左侧的矩阵记为 <span class="math inline">\(A_n\)</span>。由于 <span
class="math display">\[\begin{align*}
\dfrac{1}{x_i-y_j}&amp;=\dfrac{1}{(x_i-y_1)(x_i-y_2)\cdots(x_i-y_n)}\cdot\dfrac{(x_i-y_1)(x_i-y_2)\cdots(x_i-y_n)}{x_i-y_j}\\
&amp;=\dfrac{1}{\prod_l(x_i-y_l)}\prod_{k=1\sim n}^{k\neq
j}(x_i-y_k),\end{align*}\]</span></p>
<p>所以可以对每一行都提出一个 <span
class="math inline">\(1/[(x_i-y_1)\cdots(x_i-y_n)]\)</span>
的因子，这样一来， <span class="math display">\[\det
A=\dfrac{1}{\prod_{k,l}(x_k-y_l)}\det A&#39;,\quad
A&#39;=\begin{bmatrix}
\dfrac{\prod_{k}(x_1-y_k)}{x_1-y_1}&amp;\cdots&amp;\dfrac{\prod_{k}(x_1-y_k)}{x_1-y_n}\\
\vdots&amp;\ddots&amp;\vdots\\
\dfrac{\prod_{k}(x_n-y_k)}{x_n-y_1}&amp;\cdots&amp;\dfrac{\prod_{k}(x_n-y_k)}{x_n-y_n}\\
\end{bmatrix}.\]</span> 问题就变成了计算 <span
class="math inline">\(A&#39;\)</span>。</p>
<p>通过简单的多项式展开不难算出： <span
class="math display">\[\dfrac{\prod_{k}(x_i-y_k)}{x_i-y_j}=x_i^{n-1}+(-1)^1x_i^{n-2}\sum_k^{k\neq
i}y_k+(-1)^2x_i^{n-3}\sum_{k&lt;l}^{k,l\neq
i}y_ky_l+\cdots+(-1)^{n-1}\prod_{k}^{k\neq i}y_k\]</span></p>
<p>这意味着： <span class="math display">\[ A&#39;=\begin{bmatrix}
x_1^{n-1}&amp;x_1^{n-2}&amp;\cdots&amp;1\\
x_2^{n-1}&amp;x_2^{n-2}&amp;\cdots&amp;1\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
x_n^{n-1}&amp;x_n^{n-2}&amp;\cdots&amp;1\\
\end{bmatrix}
\begin{bmatrix}
1&amp; &amp; &amp; &amp; \\
&amp;(-1)^1&amp;&amp;&amp;\\[1.3em]
&amp;&amp;\ddots&amp;&amp;\\
&amp;&amp;&amp;&amp;(-1)^{n-1}
\end{bmatrix}
\begin{bmatrix}
1&amp;1&amp;\cdots&amp;1\\
\displaystyle\sum_{k}^{k\neq 1}y_k&amp;\displaystyle\sum_{k}^{k\neq
2}y_k&amp;\cdots&amp;\displaystyle\sum_{k}^{k\neq n}y_k\\[1.5em]
\displaystyle\sum_{k&lt;l}^{k,l\neq
1}y_ky_l&amp;\displaystyle\sum_{k&lt;l}^{k,l\neq
2}y_ky_l&amp;\cdots&amp;\displaystyle\sum_{k&lt;l}^{k,l\neq n}y_ky_l\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
\displaystyle\prod_{k}^{k\neq 1}y_k&amp;\displaystyle\prod_{k}^{k\neq
2}y_k&amp;\cdots&amp;\displaystyle\prod_{k}^{k\neq n}y_k
\end{bmatrix}.\]</span> 等号右边第一个矩阵在经过 <span
class="math inline">\((n-1)+(n-2)+\cdots+1=n(n-1)/2\)</span>
次列轮换之后就是范德蒙行列式，它与等号右边的第二个矩阵一起对 <span
class="math inline">\(\det(A&#39;)\)</span> 贡献了一个 <span
class="math inline">\(\prod_{i&lt;j}(x_j-x_i)\)</span> 的因子、</p>
<p>我们将等号右侧第三个矩阵记为 <span
class="math inline">\(D_n\)</span>，现在就只需证明 <span
class="math display">\[\det(D_n)=(-1)^{n(n-1)/2}\prod_{i&lt;j}(y_j-y_i).\]</span>
可以采用数学归纳法。</p>
<p>首先，在 <span class="math inline">\(n=2\)</span> 时，<span
class="math inline">\(\det(D_2)=(y_1-y_2)=(-1)^{2\times
1/2}(y_2-y_1)\)</span>。</p>
<p>假设 <span class="math inline">\(D_2,\cdots,D_{n-1}\)</span>
都满足以上结果。对于 <span
class="math inline">\(D_n\)</span>，将最后一列乘以 <span
class="math inline">\((-1)\)</span> 加到之前的每一列上。</p>
<p>不难算出： <span class="math display">\[\begin{align*}
\displaystyle\sum_{k}^{k\neq 1}y_k-\displaystyle\sum_{k}^{k\neq
n}y_k&amp;=\left(\displaystyle\sum_{k}y_k-y_1\right)-\left(\displaystyle\sum_{k}y_k-y_n\right)=y_n-y_1,
\end{align*}\]</span> 以及： <span class="math display">\[\begin{align*}
\displaystyle\sum_{k&lt;l}^{k,l\neq
1}y_ky_l-\displaystyle\sum_{k&lt;l}^{k,l\neq
n}y_ky_l&amp;=\left(\displaystyle\sum_{k&lt;l}y_ky_l-y_1\sum_{l}^{l\neq
1}y_l\right)-\left(\displaystyle\sum_{k&lt;l}y_ky_l-y_n\sum_{k}^{k\neq
n}y_k\right)\\
&amp;=y_n\sum_{k}^{k\neq n}y_k-y_1\sum_{k}^{k\neq 1}y_k\\
&amp;=y_n\sum_{k}^{k\neq 1,n}y_k+y_ny_1-y_1\sum_{k}^{k\neq
1,n}y_k-y_1y_n\\
&amp;=(y_n-y_1)\sum_{k}^{k\neq 1,n}y_k,
\end{align*}\]</span> 还有： <span class="math display">\[\begin{align*}
\displaystyle\sum_{k&lt;l&lt;m}^{k,l,m\neq
1}y_ky_ly_m-\displaystyle\sum_{k&lt;l&lt;m}^{k,l,m\neq
n}y_ky_ly_m&amp;=\left(\displaystyle\sum_{k&lt;l&lt;m}y_ky_ly_m-y_1\displaystyle\sum_{l&lt;m}^{l,m\neq
1}y_ly_m\right)-\left(\displaystyle\sum_{k&lt;l&lt;m}y_ky_ly_m-y_n\displaystyle\sum_{k&lt;l}^{k,l\neq
n}y_ky_l\right)\\
&amp;=y_n\sum_{k&lt;l}^{k,l\neq n}y_ky_l-y_1\sum_{k&lt;l}^{k,l\neq
1}y_ky_l\\
&amp;=y_n\sum_{k&lt;l}^{k,l\neq 1,n}y_ky_l+y_ny_1\sum_l^{l\neq
1,n}y_l-y_1\sum_{k&lt;l}^{k,l\neq 1,n}y_ky_l-y_ny_1\sum_{k}^{k\neq
1,n}y_k\\
&amp;=(y_n-y_1)\sum_{k&lt;l}^{k\neq 1,n}y_ky_l,
\end{align*}\]</span> 等等等等。</p>
<p>利用这些结果，就能看出： <span class="math display">\[\det(D_n)=
\begin{bmatrix}
0&amp;0&amp;\cdots&amp;0&amp;1\\
y_n-y_1&amp;y_n-y_2&amp;\cdots&amp;y_n-y_{n-1}&amp;\displaystyle\sum_{k}^{k\neq
n}y_k\\
(y_n-y_1)\displaystyle\sum_{k}^{k\neq
1,n}y_k&amp;(y_n-y_2)\displaystyle\sum_{k}^{k\neq
2,n}y_k&amp;\cdots&amp;(y_n-y_{n-1})\displaystyle\sum_{k}^{k\neq
n-1,n}y_k&amp;\displaystyle\sum_{k&lt;l}^{k,l\neq n}y_ky_l\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\[0.5em]
\displaystyle(y_n-y_1)\prod_{k}^{k\neq
1,n}y_k&amp;\displaystyle(y_n-y_2)\prod_{k}^{k\neq
2,n}y_k&amp;\cdots&amp;\displaystyle(y_n-y_{n-1})\prod_{k}^{k\neq
n-1,n}y_k&amp;\displaystyle\prod_{k}^{k\neq n}y_k
\end{bmatrix}.\]</span> 关于第一行做展开，就能发现： <span
class="math display">\[\begin{align*}
\det(D_n)&amp;=(-1)^{n-1}\left[\prod_{i=1}^{n-1}(y_n-y_{n-1})\right]\cdot\det(D_{n-1})\\
&amp;=(-1)^{n-1}\left[\prod_{i=1}^{n-1}(y_n-y_{n-1})\right]\cdot(-1)^{(n-1)(n-2)/2}\prod_{1\leqslant
i&lt;j\leqslant n-1}(y_j-y_i)\\
&amp;=(-1)^{n(n-1)/2}\prod_{1\leqslant i&lt;j\leqslant n}(y_j-y_i).
\end{align*}\]</span> 这样就完成了证明。</p>
<hr />
<p><strong>机智的证明思路</strong>：</p>
<p>另有一个证明思路。重新写下 <span
class="math inline">\(A&#39;\)</span> 的形式： <span
class="math display">\[A&#39;=\begin{bmatrix}
\dfrac{\prod_{k}(x_1-y_k)}{x_1-y_1}&amp;\cdots&amp;\dfrac{\prod_{k}(x_1-y_k)}{x_1-y_n}\\
\vdots&amp;\ddots&amp;\vdots\\
\dfrac{\prod_{k}(x_n-y_k)}{x_n-y_1}&amp;\cdots&amp;\dfrac{\prod_{k}(x_n-y_k)}{x_n-y_n}\\
\end{bmatrix}\]</span> 不难看出，<span
class="math inline">\(\det(A&#39;)\)</span> 一定是 <span
class="math inline">\(x\)</span> 或 <span
class="math inline">\(y\)</span> 的 <span
class="math inline">\(n(n-1)\)</span> 阶多项式。如果存在一对 <span
class="math inline">\(i,j\)</span> 使得 <span
class="math inline">\(x_i=x_j\)</span> 或 <span
class="math inline">\(y_i=y_j\)</span>，那么 <span
class="math inline">\(\det(A&#39;)=0\)</span>，因此 <span
class="math inline">\(\det(A&#39;)\)</span> 必然具有 <span
class="math inline">\((x_i-x_j)\)</span> 与 <span
class="math inline">\((y_i-y_j)\)</span> 的因子。注意到满足 <span
class="math inline">\(i&lt;j\)</span> 的 <span
class="math inline">\((i,j)\)</span> 对恰好有 <span
class="math inline">\(n(n-1)/2\)</span> 组，所以可以断定 <span
class="math display">\[\det(A&#39;)=c\prod_{i&lt;j}(x_i-x_j)(y_i-y_j),\]</span>
再通过一些计算确定系数 <span class="math inline">\(c\)</span> 即可。</p>

    </div>
</div>
<h2 id="分块矩阵的行列式schur-补的应用">分块矩阵的行列式（Schur
补的应用）</h2>
<p><span class="math display">\[\begin{align*}
\det\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}=\det(X)\det(W-ZX^{-1}Y)=\det(W)\det(X-YW^{-1}Z),
\end{align*}\]</span></p>
<p><span class="math inline">\((W-ZX^{-1}Y)\)</span> 称为 <span
class="math inline">\(X\)</span> 的 <strong>Schur 补</strong>，<span
class="math inline">\((X-YW^{-1}Z)\)</span> 称为 <span
class="math inline">\(W\)</span> 的 Schur 补。</p>
<p>取 <span class="math inline">\(X\)</span> 与 <span
class="math inline">\(W\)</span> 为单位矩阵 <span
class="math inline">\(I\)</span>（阶数不一定相同），令 <span
class="math inline">\(Z=A\)</span>，<span
class="math inline">\(Y=B\)</span>，就会发现： <span
class="math display">\[\det(I-AB)=\det(I-BA).\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>不难验证： <span class="math display">\[\begin{align*}
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}&amp;=\begin{bmatrix}I&amp;0\\ZX^{-1}&amp;I\end{bmatrix}\begin{bmatrix}X&amp;0\\0&amp;W-ZX^{-1}Y\end{bmatrix}\begin{bmatrix}I&amp;X^{-1}Y\\0&amp;I\end{bmatrix},\\
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}&amp;=\begin{bmatrix}I&amp;YW^{-1}\\0&amp;I\end{bmatrix}\begin{bmatrix}X-YW^{-1}Z&amp;0\\0&amp;W\end{bmatrix}\begin{bmatrix}I&amp;0\\W^{-1}Z&amp;I\end{bmatrix}.
\end{align*}\]</span></p>

    </div>
</div>
<hr />
<h1 id="一些逆矩阵公式">一些逆矩阵公式</h1>
<h2 id="逆矩阵的子式">逆矩阵的子式</h2>
<p>假设 <span class="math inline">\(A\)</span> 是一个 <span
class="math inline">\(n\times n\)</span> 的可逆矩阵，我们把它的位于第
<span class="math inline">\(I:=(i_1,i_2,\cdots,i_k)\)</span> 行与第
<span class="math inline">\(J:=(j_1,j_2\cdots,j_k)\)</span> 的 <span
class="math inline">\(k^2\)</span> 个元素构成的 <span
class="math inline">\(k\times k\)</span> 矩阵的行列式记为 <span
class="math inline">\([A]_{I,J}\)</span>，将取出这些元素之后剩下的矩阵的行列式记为
<span class="math inline">\([A]_{I&#39;,J&#39;}\)</span>。我们还假定
<span class="math inline">\(I\)</span>、<span
class="math inline">\(J\)</span>、<span
class="math inline">\(I&#39;\)</span>、<span
class="math inline">\(J&#39;\)</span>
中的指标都是按升序排列的。那么可以证明： <span
class="math display">\[\begin{align*}
[A^{-1}]_{I,J}=\dfrac{(-1)^{\sum I+\sum J}}{\det(A)}[A]_{I&#39;,J&#39;},
\end{align*}\]</span> 其中 <span class="math inline">\(\sum
I:=\sum_{r=1}^ki_{r}\)</span> 以及 <span class="math inline">\(\sum
J:=\sum_{r=1}^kj_{r}\)</span>。</p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>证明参考了<a
target="_blank" rel="noopener" href="https://mathoverflow.net/questions/87877/jacobis-equality-between-complementary-minors-of-inverse-matrices">这里</a>。</p>
<p>我们首先利用行置换 <span class="math inline">\(P_{J&#39;}^L\)</span>
与列置换 <span class="math inline">\(P_{I&#39;}^R\)</span> 将 <span
class="math inline">\(A\)</span> 的第 <span
class="math inline">\(J&#39;\)</span> 行与第 <span
class="math inline">\(I&#39;\)</span> 列构成的矩阵移动到左上角： <span
class="math display">\[\begin{align*}
P_{J&#39;}^LAP_{I&#39;}^R=\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix},\quad
\det X=[A]_{J&#39;I&#39;},\quad \det W=[A]_{JI},
\end{align*}\]</span> 其中： <span class="math display">\[\begin{align*}
P_J^L:=(k,j_k)\cdots(2,j_2)(1,j_1),\quad
P_I^R=(1,i_1)(2,i_2)\cdots(k,i_k),\end{align*}\]</span> <span
class="math inline">\((i,j)\)</span> 意为在单位矩阵 <span
class="math inline">\(I\)</span> 中将第 <span
class="math inline">\(i,j\)</span> 两行或两列交换后得到的矩阵。</p>
<p>利用如下等式： <span class="math display">\[\begin{align*}
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}=\begin{bmatrix}I&amp;0\\ZX^{-1}&amp;I\end{bmatrix}\begin{bmatrix}X&amp;0\\0&amp;W-ZX^{-1}Y\end{bmatrix}\begin{bmatrix}I&amp;X^{-1}Y\\0&amp;I\end{bmatrix},
\end{align*}\]</span> 我们发现： <span
class="math display">\[\begin{align*}
\det[(W-ZX^{-1}Y)^{-1}]=\dfrac{\det(X)}{\det(A)\det(P_{J&#39;}^LP_{I&#39;}^R)}=\dfrac{[A]_{J&#39;I&#39;}}{\det(A)\det(P_{J}^LP_{I}^R)}.
\end{align*}\]</span> 再对 <span
class="math inline">\(P_{J&#39;}^LAP_{I&#39;}^R\)</span> 求逆： <span
class="math display">\[\begin{align*}
P_{I&#39;}^LA^{-1}P_{J&#39;}^R=&amp;\;(P_{J&#39;}^LAP_{I&#39;}^R)^{-1}=\begin{bmatrix}I&amp;-X^{-1}Y\\0&amp;I\end{bmatrix}\begin{bmatrix}X^{-1}&amp;0\\0&amp;(W-ZX^{-1}Y)^{-1}\end{bmatrix}\begin{bmatrix}I&amp;0\\-ZX^{-1}&amp;I\end{bmatrix}\\
=&amp;\;\begin{bmatrix}\cdots&amp;\cdots\\0&amp;(W-ZX^{-1}Y)^{-1}\end{bmatrix}\begin{bmatrix}I&amp;0\\-ZX^{-1}&amp;I\end{bmatrix}=\begin{bmatrix}\cdots&amp;\cdots\\
\cdots&amp;(W-ZX^{-1}Y)^{-1}\end{bmatrix}.
\end{align*}\]</span> 这意味着 <span
class="math inline">\(\det[(W-ZX^{-1}Y)^{-1}]=[A^{-1}]_{IJ}\)</span>
（类比于 <span class="math inline">\(\det W=[A]_{JI}\)</span>），于是：
<span class="math display">\[\begin{align*}
[A^{-1}]_{IJ}=\dfrac{[A]_{J&#39;I&#39;}}{\det(A)\det(P_{J&#39;}^LP_{I&#39;}^R)}.
\end{align*}\]</span></p>
<p>最后，我们来计算 <span class="math inline">\(\det
P_{I}^R\)</span>，它显然不会是 <span
class="math inline">\((-1)^k\)</span>，因为 <span
class="math inline">\(i_m\)</span> 可能等于 <span
class="math inline">\(m\)</span>。在 <span
class="math inline">\((1,2,\cdots,i_1,\cdots,i_k,\cdots,n)\)</span>
中，将 <span class="math inline">\(i_{1}\)</span> 移动到最前面需要移动
<span class="math inline">\((i_1-1)\)</span> 次。在将 <span
class="math inline">\(i_1\)</span> 移动到最前面之后，将 <span
class="math inline">\(i_2\)</span> 移动到 <span
class="math inline">\(i_1\)</span> 后面需要的移动次数就是 <span
class="math inline">\((i_2-2)\)</span>，这个次数等于移动后的 <span
class="math inline">\(i_1\)</span> 与未移动的 <span
class="math inline">\(i_2\)</span> 之间的数字的个数。同理，在将 <span
class="math inline">\(i_1i_2\)</span> 移动到最前面之后，将 <span
class="math inline">\(i_3\)</span> 移动到 <span
class="math inline">\(i_2\)</span> 后面需要移动的次数为 <span
class="math inline">\((i_3-3)\)</span>。就这样，我们发现： <span
class="math display">\[\begin{align*}
\det P_I^R=\det P_{I&#39;}^R=(-1)^{\sum I+k(k+1)/2}.
\end{align*}\]</span> <span class="math inline">\(P_{J&#39;}\)</span>
同理。这样一来我们就完成了证明。</p>

    </div>
</div>
<h2 id="a-xry--1-的计算schur-补的应用"><span class="math inline">\((A +
XRY )^{-1}\)</span> 的计算（Schur 补的应用）</h2>
<p><span class="math display">\[(A + XRY )^{-1}= A^{-1}-A^{-1}X(R^{-1}+
Y A^{-1}X)^{-1}Y A^{-1}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明
    </div>
    <div class='spoiler-content'>
        <p>考虑如下等式： <span class="math display">\[\begin{align*}
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}&amp;=\begin{bmatrix}I&amp;0\\ZX^{-1}&amp;I\end{bmatrix}\begin{bmatrix}X&amp;0\\0&amp;W-ZX^{-1}Y\end{bmatrix}\begin{bmatrix}I&amp;X^{-1}Y\\0&amp;I\end{bmatrix},\\
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}&amp;=\begin{bmatrix}I&amp;YW^{-1}\\0&amp;I\end{bmatrix}\begin{bmatrix}X-YW^{-1}Z&amp;0\\0&amp;W\end{bmatrix}\begin{bmatrix}I&amp;0\\W^{-1}Z&amp;I\end{bmatrix}.
\end{align*}\]</span></p>
<p>然后对两个式子同时求逆矩阵： <span
class="math display">\[\begin{align*}
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}^{-1}&amp;=\begin{bmatrix}I&amp;-X^{-1}Y\\0&amp;I\end{bmatrix}\begin{bmatrix}X^{-1}&amp;0\\0&amp;(W-ZX^{-1}Y)^{-1}\end{bmatrix}\begin{bmatrix}I&amp;0\\-ZX^{-1}&amp;I\end{bmatrix},\\
\begin{bmatrix}X&amp;Y\\Z&amp;W\end{bmatrix}^{-1}&amp;=\begin{bmatrix}I&amp;0\\-W^{-1}Z&amp;I\end{bmatrix}\begin{bmatrix}(X-YW^{-1}Z)^{-1}&amp;0\\0&amp;W^{-1}\end{bmatrix}\begin{bmatrix}I&amp;-YW^{-1}\\0&amp;I\end{bmatrix}.
\end{align*}\]</span></p>
<p>这意味着： <span class="math display">\[\begin{align*}
\begin{bmatrix}X^{-1}&amp;0\\0&amp;(W-ZX^{-1}Y)^{-1}\end{bmatrix}=&amp;\;\begin{bmatrix}I&amp;X^{-1}Y\\0&amp;I\end{bmatrix}\begin{bmatrix}I&amp;0\\-W^{-1}Z&amp;I\end{bmatrix}\times\begin{bmatrix}(X-YW^{-1}Z)^{-1}&amp;0\\0&amp;W^{-1}\end{bmatrix}\times\begin{bmatrix}I&amp;-YW^{-1}\\0&amp;I\end{bmatrix}\begin{bmatrix}I&amp;0\\
ZX^{-1}&amp;I\end{bmatrix}\\
=&amp;\;\begin{bmatrix}\cdots&amp;\cdots\\-W^{-1}Z&amp;I\end{bmatrix}\times\begin{bmatrix}(X-YW^{-1}Z)^{-1}&amp;0\\0&amp;W^{-1}\end{bmatrix}\times\begin{bmatrix}\cdots&amp;-YW^{-1}\\
\cdots&amp;I\end{bmatrix}\\
=&amp;\;\begin{bmatrix}\cdots&amp;\cdots\\-W^{-1}Z(X-YW^{-1}Z)^{-1}&amp;W^{-1}\end{bmatrix}\times\begin{bmatrix}\cdots&amp;-YW^{-1}\\
\cdots&amp;I\end{bmatrix}\\
=&amp;\;\begin{bmatrix}\cdots&amp;\cdots\\\cdots&amp;W^{-1}Z(X-YW^{-1}Z)^{-1}YW^{-1}+W^{-1}\end{bmatrix}
\end{align*}\]</span></p>
<p>所以我们发现： <span
class="math display">\[(W-ZX^{-1}Y)^{-1}=W^{-1}Z(X-YW^{-1}Z)^{-1}YW^{-1}+W^{-1}.\]</span>
令 <span class="math inline">\(X^{-1}=-R\)</span>，<span
class="math inline">\(W=A\)</span>，就有： <span
class="math display">\[(A+ZRY)^{-1}=-A^{-1}Z(R^{-1}+YA^{-1}Z)^{-1}YA^{-1}+A^{-1}.\]</span>
这样就完成了证明。</p>

    </div>
</div>
<hr />
<h1 id="其他公式">其他公式</h1>
<h2 id="baker-hausdorff-公式">Baker-Hausdorff 公式</h2>
<p><span class="math display">\[\begin{align*}
\mathrm e^{A} B\mathrm e^{-A}=B+ [A,B]+\dfrac{1}{2!} [ A,  [A,B  ]
]+\dfrac{1}{3!}  [ A, [A,  [A,B  ] ] ] +\cdots.
\end{align*}\]</span></p>
<div class='spoiler collapsed'>
    <div class='spoiler-title'>
        证明思路
    </div>
    <div class='spoiler-content'>
        <p>将 <span class="math inline">\(A\)</span> 替换为 <span
class="math inline">\(\lambda A\)</span>，然后对 <span
class="math inline">\(\lambda\)</span> 做泰勒展开即可。</p>

    </div>
</div>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://xmq-servicecenter.github.io/2024/05/29/about_next/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="XMQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XMQ-维修中心">
      <meta itemprop="description" content="奇怪的小网站">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | XMQ-维修中心">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/05/29/about_next/" class="post-title-link" itemprop="url">关于 hexo 与 next 的配置问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-29 16:34:18" itemprop="dateCreated datePublished" datetime="2024-05-29T16:34:18+08:00">2024-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-24 11:40:06" itemprop="dateModified" datetime="2024-07-24T11:40:06+08:00">2024-07-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="自定义主页">自定义主页</h2>
<p>自定义主页可参考 <a
target="_blank" rel="noopener" href="https://blog.csdn.net/tujidi1csd/article/details/120180779">这篇文章</a>。这里的做法是：</p>
<ul>
<li><p>在根目录的 <code>source</code> 文件夹下新建 <code>index.md</code>
文件，并写入</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span>=<span class="string">15</span>&gt;</span></span>奇怪的小网站<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>等相关内容</p></li>
<li><p>在根目录的 <code>_config.yml</code> 文件中，将
<code>index_generator</code> 项的 <code>path</code> 项修改为
<code>/public/index.html</code></p></li>
<li><p>在根目录的 <code>_config.next.yml</code> 文件中，将
<code>menu</code> 项中的 <code>home</code> 项修改为
<code>/ || fa fa-home</code></p></li>
</ul>
<h2 id="使用-canvas_nest-动画背景">使用 canvas_nest 动画背景</h2>
<p>有许多讲 canvas_nest 动画背景的文章都过时了，因为 <a
target="_blank" rel="noopener" href="https://hexo-next.readthedocs.io/zh-cn/latest/next/advanced/%E5%8A%A8%E6%80%81%E8%83%8C%E6%99%AF/">NexT
8.0.0-rc.2移除了canvas-nest集成</a>。</p>
<p>为了使用 canvas_nest，可以参考 <a
target="_blank" rel="noopener" href="https://github.com/theme-next/theme-next-canvas-nest">github
上的教程</a>。具体操作为：</p>
<ul>
<li><p>在 <code>hexo/source/_data</code>
文件夹（如果不存在这一文件夹就创建一个）中创建 <code>footer.swig</code>
文件，并写入：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">color</span>=<span class="string">&quot;0,0,255&quot;</span> <span class="attr">opacity</span>=<span class="string">&quot;0.5&quot;</span> <span class="attr">zIndex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">count</span>=<span class="string">&quot;99&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js&quot;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li><p>在根目录的 <code>_config.next.yml</code> 文件中，将
<code>custom_file_path</code> 项中的 <code>footer</code> 项修改为
<code>source/_data/footer.swig</code></p></li>
</ul>
<h2 id="使用数学公式">使用数学公式</h2>
<p>为了在 hexo 与 next 中愉快地使用数学公式，我们需要参考 next 文档中的
<a
target="_blank" rel="noopener" href="https://github.com/theme-next/hexo-theme-next/blob/master/docs/MATH.md">Math
Equations</a> 部分。</p>
<p>建议使用 hexo-renderer-pandoc，而非 hexo-renderer-kramed。</p>
<p>具体操作为：</p>
<ul>
<li><p>移除 hexo-renderer-marked 并安装 hexo-renderer-pandoc：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked</span><br><span class="line">npm install hexo-renderer-pandoc</span><br></pre></td></tr></table></figure></li>
<li><p>在根目录的 <code>_config.next.yml</code> 文件中，将
<code>math</code> 项中的 <code>mathjax</code> 项中的 <code>enable</code>
修改为 <code>true</code>，并且将 <code>math</code> 项中的
<code>every_page</code> 也修改为
<code>true</code>，因为预期每一页都会有数学公式。</p></li>
<li><p>在每一个 md 文件的开头，两个<code>---</code>之间的部分，添加</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mathjax: true</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="使用折叠">使用折叠</h2>
<p>参考 <a
target="_blank" rel="noopener" href="https://github.com/fletchto99/hexo-sliding-spoiler/tree/master">github上的教程</a>。具体操作步骤为：</p>
<ul>
<li><p>直接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-sliding-spoiler --save</span><br></pre></td></tr></table></figure></li>
<li><p>然后在
<code>/node_modules/hexo-sliding-spoiler/assets/spoiler.css</code>
文件中：</p>
<ul>
<li>将 <code>.spoiler.collapsed .spoiler-title:before</code> 内的
<code>content</code> 修改为 <code>[展开]：</code></li>
<li>将 <code>.spoiler.expanded .spoiler-title:before</code> 内的
<code>content</code> 修改为 <code>[收起]：</code></li>
</ul></li>
</ul>
<h2 id="使用定理环境">使用定理环境</h2>
<p>如果需要为定理、定义等自动编号，可以参考 <a
target="_blank" rel="noopener" href="https://jp.v2ex.com/t/1036101">这篇文章</a>。</p>
<p>这里的操作为：</p>
<ul>
<li><p>移除 hexo-renderer-marked 并安装 hexo-renderer-pandoc
（同上）</p></li>
<li><p>在根目录（与 <code>_config.next.yml</code> 和
<code>_config.yml</code> 同级的目录）中，使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/dialoa/statement/</span><br></pre></td></tr></table></figure>
<p>然后就会多出来一个 <code>statement</code> 文件夹。</p></li>
<li><p>还是在根目录中，新建一个
<code>metadata.yml</code>，里面写上：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">link-citations:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">reference-section-title:</span> <span class="string">&quot;References&quot;</span></span><br><span class="line"><span class="attr">bibliography:</span> <span class="string">&quot;./ref.bib&quot;</span></span><br><span class="line"><span class="attr">statement:</span></span><br><span class="line">  <span class="attr">supply-header:</span> <span class="literal">no</span></span><br><span class="line">  <span class="attr">count-within:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">crossref-prefixes:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">statement-kinds:</span></span><br><span class="line">  <span class="attr">definition:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">定义</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">definition</span></span><br><span class="line">  <span class="attr">theorem:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">定理</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">theorem</span></span><br><span class="line">  <span class="attr">lemma:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">引理</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">theorem</span></span><br><span class="line">  <span class="attr">proposition:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">命题</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">theorem</span></span><br><span class="line">  <span class="attr">corollary:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">推论</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">theorem</span></span><br><span class="line">  <span class="attr">proof:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">证明</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">none</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">definition</span></span><br><span class="line">  <span class="attr">note:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">注记</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">none</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">definition</span></span><br><span class="line">  <span class="attr">example:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">例子</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">none</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">definition</span></span><br><span class="line">  <span class="attr">question:</span></span><br><span class="line">    <span class="attr">label:</span> <span class="string">问题</span></span><br><span class="line">    <span class="attr">counter:</span> <span class="string">theorem</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">definition</span></span><br><span class="line"><span class="attr">statement-styles:</span></span><br><span class="line">  <span class="attr">definition:</span></span><br><span class="line">    <span class="attr">punctuation:</span> <span class="string">&#x27;：&#x27;</span></span><br><span class="line">  <span class="attr">note:</span></span><br><span class="line">    <span class="attr">punctuation:</span> <span class="string">&#x27;：&#x27;</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></li>
<li><p>在 <code>_config.yml</code> 中加上：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pandoc</span></span><br><span class="line"><span class="attr">pandoc:</span></span><br><span class="line">  <span class="attr">args:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;--to&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;html5&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;-L&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;./statement/statement.lua&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;--citeproc&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;--metadata-file&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;./metadata.yml&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&#x27;--mathjax&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li><p>在 <code>/themes/next/source/css/main.styl</code>
文件中加上：</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://jp.v2ex.com/t/1036101</span></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.plain</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">175</span>, <span class="number">238</span>, <span class="number">238</span>);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.0rem</span> <span class="number">0.6rem</span> <span class="number">0.0rem</span> <span class="number">0.6rem</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="built_in">rgb</span>(<span class="number">135</span>, <span class="number">206</span>, <span class="number">235</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0em</span> <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.example</span><span class="selector-class">.definition</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">193</span>, <span class="number">255</span>, <span class="number">193</span>);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.0rem</span> <span class="number">0.6rem</span> <span class="number">0.0rem</span> <span class="number">0.6rem</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="built_in">rgb</span>(<span class="number">180</span>, <span class="number">238</span>, <span class="number">180</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0em</span> <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.definition</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">253</span>, <span class="number">245</span>, <span class="number">230</span>);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.0rem</span> <span class="number">0.6rem</span> <span class="number">0.0rem</span> <span class="number">0.6rem</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">228</span>, <span class="number">196</span>);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0em</span> <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.plain</span> <span class="selector-class">.statement-label</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.note</span><span class="selector-class">.unnumbered</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">2em</span> auto;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5em</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">85%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.definition</span> <span class="selector-class">.statement-label</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.proof</span> <span class="selector-class">.statement-label</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.plain</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span></span><br><span class="line">     <span class="attribute">text-indent</span>: <span class="number">0pt</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.statement</span><span class="selector-class">.plain</span> <span class="selector-class">.statement-info</span></span><br><span class="line">    <span class="attribute">font-style</span>: normal;</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">font-variant</span>: normal;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.csl-entry</span></span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">1px</span> solid <span class="number">#777</span>;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">1.5em</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">1.5em</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0em</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">150%</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>使用方法：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">::: &#123;.definition #label1&#125;</span><br><span class="line">$\,\!$<span class="strong">**（定义 1）**</span></span><br><span class="line">测试</span><br><span class="line">:::</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="折叠与定理环境的冲突">折叠与定理环境的冲突</h2>
<p>不知为何，被折叠起来的内容中不能通过 <code>@xxx</code>
来引用定理编号。该问题尚未解决。</p>
<h2 id="文本框背景颜色设置">文本框背景颜色设置</h2>
<p>如果只是需要一个有颜色的文本框，就可参考 <a
target="_blank" rel="noopener" href="https://ellis-wu.github.io/2018/06/13/hexo-color-quote/">这篇文章</a>。</p>
<p>这里的操作为：</p>
<ul>
<li><p>在 <code>/themes/next/scripts</code> 文件夹中新建
<code>colorquote.js</code> 文件，并写入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Color Quote Block Tag</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> Color Quote Block</span></span><br><span class="line"><span class="comment">* <span class="doctag">@example</span></span></span><br><span class="line"><span class="comment">*     &lt;% colorquote [type] %&gt;</span></span><br><span class="line"><span class="comment">*     content</span></span><br><span class="line"><span class="comment">*     &lt;% endcolorquote %&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;colorquote&#x27;</span>, <span class="keyword">function</span> (<span class="params">args, content</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> type =  args[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> mdContent = hexo.<span class="property">render</span>.<span class="title function_">renderSync</span>(&#123;<span class="attr">text</span>: content, <span class="attr">engine</span>: <span class="string">&#x27;markdown&#x27;</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;blockquote class=&quot;colorquote &#x27;</span> + type + <span class="string">&#x27;&quot;&gt;&#x27;</span> + mdContent + <span class="string">&#x27;&lt;/blockquote&gt;&#x27;</span>;</span><br><span class="line">&#125;, &#123;<span class="attr">ends</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>在
<code>/themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl</code>
文件中加上：</p>
<figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://ellis-wu.github.io/2018/06/13/hexo-color-quote/</span></span><br><span class="line"><span class="selector-class">.colorquote</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0.1em</span> <span class="number">1.5em</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#4a4a4a</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">2em</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">2em</span>;</span><br><span class="line">  &amp;<span class="selector-class">.definition</span></span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">228</span>, <span class="number">196</span>);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">253</span>, <span class="number">245</span>, <span class="number">230</span>);</span><br><span class="line">  &amp;<span class="selector-class">.theorem</span></span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">rgb</span>(<span class="number">135</span>, <span class="number">206</span>, <span class="number">235</span>);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">175</span>, <span class="number">238</span>, <span class="number">238</span>);</span><br><span class="line">  &amp;<span class="selector-class">.example</span></span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">rgb</span>(<span class="number">180</span>, <span class="number">238</span>, <span class="number">180</span>);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">193</span>, <span class="number">255</span>, <span class="number">193</span>);</span><br><span class="line">  &amp;<span class="selector-class">.warning</span></span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">hsl</span>(<span class="number">348</span>, <span class="number">100%</span>, <span class="number">61%</span>);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">hsl</span>(<span class="number">348</span>, <span class="number">100%</span>, <span class="number">85%</span>);</span><br><span class="line">  &amp;<span class="selector-class">.algorithm</span></span><br><span class="line">    <span class="attribute">border-color</span>: <span class="built_in">hsl</span>(<span class="number">0</span>, <span class="number">0%</span>, <span class="number">71%</span>);</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">hsl</span>(<span class="number">0</span>, <span class="number">0%</span>, <span class="number">94%</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>使用方法：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% colorquote theorem %&#125;</span><br><span class="line">测试</span><br><span class="line">&#123;% endcolorquote %&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="字体设置">字体设置</h2>
<p>Next 的字体设置可以参考 <a
target="_blank" rel="noopener" href="https://hexo-next.readthedocs.io/zh-cn/latest/next/advanced/%E5%AD%97%E4%BD%93%E8%AE%BE%E7%BD%AE/">这篇文章</a></p>
<p>这里的操作为：</p>
<ul>
<li><p>在根目录的 <code>_config.next.yml</code> 文件中，对
<code>font</code> 项做如下修改：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Uri of fonts host, e.g. https://fonts.googleapis.com (Default).</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">https://fonts.googleapis.com</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font options:</span></span><br><span class="line">  <span class="comment"># `external: true` will load this font family from `host` above.</span></span><br><span class="line">  <span class="comment"># `family: Times New Roman`. Without any quotes.</span></span><br><span class="line">  <span class="comment"># `size: x.x`. Use `em` as unit. Default: 1 (16px)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Global font settings used for all elements inside &lt;body&gt;.</span></span><br><span class="line">  <span class="attr">global:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># family: Lato</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Noto</span> <span class="string">Serif</span> <span class="string">Simplified</span> <span class="string">Chinese</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for site title (.site-title).</span></span><br><span class="line">  <span class="attr">title:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Microsoft</span> <span class="string">YaHei</span></span><br><span class="line">    <span class="attr">size:</span> <span class="string">2em</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for headlines (&lt;h1&gt; to &lt;h6&gt;).</span></span><br><span class="line">  <span class="attr">headings:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Microsoft</span> <span class="string">YaHei</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for posts (.post-body).</span></span><br><span class="line">  <span class="attr">posts:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Noto</span> <span class="string">Serif</span> <span class="string">SC</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for &lt;code&gt; and code blocks.</span></span><br><span class="line">  <span class="attr">codes:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span></span><br></pre></td></tr></table></figure></li>
<li><p>如果还需要进一步修改，那么：</p>
<ul>
<li><p>在 <code>/themes/next/source/css/_variables/base.styl</code>
中，找到 <code>// Font families.</code> 一项，对其进行修改</p></li>
<li><p>在 <code>/themes/next/layout/_partials/head/head.njk</code>
中，找到 <code>&#123;&#123; next_font() &#125;&#125;</code> 一项，对其进行修改</p></li>
</ul></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-ghost"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">XMQ</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
